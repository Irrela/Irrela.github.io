---
title: Rust Book
categories: Rust
tags:
- Rust
---

- [Warning and Error](#warning-and-error)
- [ShortCut](#shortcut)
- [1. Getting Started](#1-getting-started)
  - [1.1 First Program](#11-first-program)
  - [1.2 Cargo](#12-cargo)
    - [ï¼ï¼ï¼Cargo æ“ä½œæ…¢](#cargo-æ“ä½œæ…¢)
    - [ä½¿ç”¨ Cargo åˆ›å»ºé¡¹ç›®](#ä½¿ç”¨-cargo-åˆ›å»ºé¡¹ç›®)
    - [Cargo.tomlç»“æ„](#cargotomlç»“æ„)
    - [ä¸ºæ²¡æœ‰ä½¿ç”¨Cargoçš„é¡¹ç›®å¼•å…¥Cargo](#ä¸ºæ²¡æœ‰ä½¿ç”¨cargoçš„é¡¹ç›®å¼•å…¥cargo)
    - [Cargoæ„å»ºä¸è¿è¡Œ](#cargoæ„å»ºä¸è¿è¡Œ)
    - [å‘å¸ƒï¼ˆreleaseï¼‰æ„å»º](#å‘å¸ƒreleaseæ„å»º)
  - [2. Guessing Game](#2-guessing-game)
    - [ä½¿ç”¨å˜é‡å‚¨å­˜å€¼](#ä½¿ç”¨å˜é‡å‚¨å­˜å€¼)
    - [é™æ€æ–¹æ³•](#é™æ€æ–¹æ³•)
    - [è¾“å…¥è¾“å‡º(std::io)](#è¾“å…¥è¾“å‡ºstdio)
    - [ä½¿ç”¨ Result ç±»å‹æ¥å¤„ç†æ½œåœ¨çš„é”™è¯¯](#ä½¿ç”¨-result-ç±»å‹æ¥å¤„ç†æ½œåœ¨çš„é”™è¯¯)
    - [ä½¿ç”¨ println! å ä½ç¬¦æ‰“å°å€¼](#ä½¿ç”¨-println-å ä½ç¬¦æ‰“å°å€¼)
    - [ä½¿ç”¨crate](#ä½¿ç”¨crate)
    - [Cargo.lock æ–‡ä»¶ç¡®ä¿æ„å»ºæ˜¯å¯é‡ç°çš„](#cargolock-æ–‡ä»¶ç¡®ä¿æ„å»ºæ˜¯å¯é‡ç°çš„)
    - [æ›´æ–° crate åˆ°ä¸€ä¸ªæ–°ç‰ˆæœ¬](#æ›´æ–°-crate-åˆ°ä¸€ä¸ªæ–°ç‰ˆæœ¬)
    - [ä½¿ç”¨randç”Ÿæˆä¸€ä¸ªéšæœºæ•°](#ä½¿ç”¨randç”Ÿæˆä¸€ä¸ªéšæœºæ•°)
    - [æ¯”è¾ƒçŒœæµ‹çš„æ•°å­—å’Œç§˜å¯†æ•°å­—](#æ¯”è¾ƒçŒœæµ‹çš„æ•°å­—å’Œç§˜å¯†æ•°å­—)
    - [é™æ€å¼ºç±»å‹ \& ç±»å‹æ¨æ–­](#é™æ€å¼ºç±»å‹--ç±»å‹æ¨æ–­)
    - [ä½¿ç”¨å¾ªç¯æ¥å…è®¸å¤šæ¬¡çŒœæµ‹](#ä½¿ç”¨å¾ªç¯æ¥å…è®¸å¤šæ¬¡çŒœæµ‹)
    - [å¤„ç†æ— æ•ˆè¾“å…¥](#å¤„ç†æ— æ•ˆè¾“å…¥)
- [3. Common Programming Concepts](#3-common-programming-concepts)
  - [3.1 Variables and Mutability](#31-variables-and-mutability)
    - [å¯å˜æ€§](#å¯å˜æ€§)
    - [å¸¸é‡](#å¸¸é‡)
    - [éšè—](#éšè—)
  - [3.2 æ•°æ®ç±»å‹](#32-æ•°æ®ç±»å‹)
    - [æ ‡é‡ç±»å‹](#æ ‡é‡ç±»å‹)
      - [æ•°å€¼è¿ç®—](#æ•°å€¼è¿ç®—)
      - [å­—ç¬¦ç±»å‹](#å­—ç¬¦ç±»å‹)
    - [å¤åˆç±»å‹](#å¤åˆç±»å‹)
      - [å…ƒç»„ç±»å‹](#å…ƒç»„ç±»å‹)
      - [æ•°ç»„ç±»å‹](#æ•°ç»„ç±»å‹)
      - [è®¿é—®æ•°ç»„å…ƒç´ ](#è®¿é—®æ•°ç»„å…ƒç´ )
  - [3.2 å‡½æ•°](#32-å‡½æ•°)
    - [](#)
    - [å…·æœ‰è¿”å›å€¼çš„å‡½æ•°](#å…·æœ‰è¿”å›å€¼çš„å‡½æ•°)
  - [3.4 æ³¨é‡Š](#34-æ³¨é‡Š)
  - [3.5 æ§åˆ¶æµ](#35-æ§åˆ¶æµ)
    - [if](#if)
    - [else if](#else-if)
    - [loopã€while å’Œ for](#loopwhile-å’Œ-for)
      - [loop](#loop)
      - [å¾ªç¯æ ‡ç­¾ï¼šåœ¨å¤šä¸ªå¾ªç¯ä¹‹é—´æ¶ˆé™¤æ­§ä¹‰](#å¾ªç¯æ ‡ç­¾åœ¨å¤šä¸ªå¾ªç¯ä¹‹é—´æ¶ˆé™¤æ­§ä¹‰)
      - [while](#while)
      - [for](#for)
- [4. Understanding Ownership](#4-understanding-ownership)
  - [4.1 ä»€ä¹ˆæ˜¯æ‰€æœ‰æƒï¼Ÿ](#41-ä»€ä¹ˆæ˜¯æ‰€æœ‰æƒ)
    - [æ‰€æœ‰æƒè§„åˆ™](#æ‰€æœ‰æƒè§„åˆ™)
    - [å˜é‡ä½œç”¨åŸŸ](#å˜é‡ä½œç”¨åŸŸ)
    - [æ¼”ç¤ºæ‰€æœ‰æƒçš„è§„åˆ™ - String ç±»å‹](#æ¼”ç¤ºæ‰€æœ‰æƒçš„è§„åˆ™---string-ç±»å‹)
    - [å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼ˆä¸€ï¼‰ï¼šç§»åŠ¨](#å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ä¸€ç§»åŠ¨)
    - [å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼ˆäºŒï¼‰ï¼šå…‹éš†](#å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼äºŒå…‹éš†)
      - [åªåœ¨æ ˆä¸Šçš„æ•°æ®ï¼šæ‹·è´](#åªåœ¨æ ˆä¸Šçš„æ•°æ®æ‹·è´)
      - [Trait: Copy](#trait-copy)
      - [æ‰€æœ‰æƒä¸å‡½æ•°](#æ‰€æœ‰æƒä¸å‡½æ•°)
      - [è¿”å›å€¼ä¸ä½œç”¨åŸŸ](#è¿”å›å€¼ä¸ä½œç”¨åŸŸ)
  - [4.2 å¼•ç”¨ä¸å€Ÿç”¨](#42-å¼•ç”¨ä¸å€Ÿç”¨)
      - [å°è¯•ä¿®æ”¹å€Ÿç”¨çš„å˜é‡](#å°è¯•ä¿®æ”¹å€Ÿç”¨çš„å˜é‡)
    - [å¯å˜å¼•ç”¨](#å¯å˜å¼•ç”¨)
    - [æ‚¬å‚å¼•ç”¨ï¼ˆDangling Referencesï¼‰](#æ‚¬å‚å¼•ç”¨dangling-references)
  - [4.3 Slice ç±»å‹](#43-slice-ç±»å‹)
      - ['' å’Œ b''](#-å’Œ-b)
      - [\&str å’Œ String](#str-å’Œ-string)
    - [å…¶ä»–ç±»å‹çš„ slice](#å…¶ä»–ç±»å‹çš„-slice)
- [5. `Structs` to Structure Related Data](#5-structs-to-structure-related-data)
  - [5.1 ç»“æ„ä½“çš„å®šä¹‰å’Œå®ä¾‹åŒ–](#51-ç»“æ„ä½“çš„å®šä¹‰å’Œå®ä¾‹åŒ–)
      - [è®¿é—®å’Œä¿®æ”¹å±æ€§](#è®¿é—®å’Œä¿®æ”¹å±æ€§)
      - [Builder](#builder)
    - [ä½¿ç”¨`ç»“æ„ä½“æ›´æ–°`è¯­æ³•ä»å…¶ä»–å®ä¾‹åˆ›å»ºå®ä¾‹](#ä½¿ç”¨ç»“æ„ä½“æ›´æ–°è¯­æ³•ä»å…¶ä»–å®ä¾‹åˆ›å»ºå®ä¾‹)
    - [å…ƒç»„ç»“æ„ä½“ï¼ˆtuple structsï¼‰](#å…ƒç»„ç»“æ„ä½“tuple-structs)
    - [ç±»å•å…ƒç»“æ„ä½“ï¼ˆunit-like structsï¼‰](#ç±»å•å…ƒç»“æ„ä½“unit-like-structs)
  - [5.2 ç»“æ„ä½“ç¤ºä¾‹ç¨‹åº](#52-ç»“æ„ä½“ç¤ºä¾‹ç¨‹åº)
    - [é€šè¿‡æ´¾ç”Ÿ trait å¢åŠ å®ç”¨åŠŸèƒ½](#é€šè¿‡æ´¾ç”Ÿ-trait-å¢åŠ å®ç”¨åŠŸèƒ½)
    - [ä½¿ç”¨ dbg!](#ä½¿ç”¨-dbg)
  - [5.3 æ–¹æ³•è¯­æ³•](#53-æ–¹æ³•è¯­æ³•)
      - [getter](#getter)
      - [-\> è¿ç®—ç¬¦åˆ°å“ªå»äº†ï¼Ÿ](#--è¿ç®—ç¬¦åˆ°å“ªå»äº†)
    - [å¸¦æœ‰æ›´å¤šå‚æ•°çš„æ–¹æ³•](#å¸¦æœ‰æ›´å¤šå‚æ•°çš„æ–¹æ³•)
    - [å…³è”å‡½æ•°](#å…³è”å‡½æ•°)
- [6. Enums and Pattern Matching](#6-enums-and-pattern-matching)
    - [Option æšä¸¾å’Œå…¶ç›¸å¯¹äºç©ºå€¼çš„ä¼˜åŠ¿](#option-æšä¸¾å’Œå…¶ç›¸å¯¹äºç©ºå€¼çš„ä¼˜åŠ¿)
  - [6.2 match æ§åˆ¶æµç»“æ„](#62-match-æ§åˆ¶æµç»“æ„)
    - [ç»‘å®šå€¼çš„æ¨¡å¼](#ç»‘å®šå€¼çš„æ¨¡å¼)
    - [åŒ¹é… Option](#åŒ¹é…-option)
    - [åŒ¹é…æ˜¯ç©·å°½çš„(exhaustive)](#åŒ¹é…æ˜¯ç©·å°½çš„exhaustive)
    - [é€šé…æ¨¡å¼å’Œ \_ å ä½ç¬¦](#é€šé…æ¨¡å¼å’Œ-_-å ä½ç¬¦)
  - [6.3 if let ç®€æ´æ§åˆ¶æµ](#63-if-let-ç®€æ´æ§åˆ¶æµ)
- [7. Packages, Crates, and Modules](#7-packages-crates-and-modules)
  - [7.1 Package å’Œ Crate](#71-package-å’Œ-crate)
    - [Crate](#crate)
    - [Package](#package)
  - [7.2 å®šä¹‰æ¨¡å—æ¥æ§åˆ¶ä½œç”¨åŸŸä¸ç§æœ‰æ€§](#72-å®šä¹‰æ¨¡å—æ¥æ§åˆ¶ä½œç”¨åŸŸä¸ç§æœ‰æ€§)
    - [Module](#module)
    - [å¯¹ç›¸å…³ä»£ç è¿›è¡Œåˆ†ç»„](#å¯¹ç›¸å…³ä»£ç è¿›è¡Œåˆ†ç»„)
  - [7.3 å¼•ç”¨æ¨¡å—é¡¹ç›®çš„è·¯å¾„](#73-å¼•ç”¨æ¨¡å—é¡¹ç›®çš„è·¯å¾„)
    - [ä½¿ç”¨ pub å…³é”®å­—æš´éœ²è·¯å¾„](#ä½¿ç”¨-pub-å…³é”®å­—æš´éœ²è·¯å¾„)
      - [executable å’Œ library çš„æœ€ä½³å®è·µ](#executable-å’Œ-library-çš„æœ€ä½³å®è·µ)
    - [super å¼€å§‹çš„ç›¸å¯¹è·¯å¾„](#super-å¼€å§‹çš„ç›¸å¯¹è·¯å¾„)
    - [åˆ›å»ºå…¬æœ‰çš„ç»“æ„ä½“å’Œæšä¸¾](#åˆ›å»ºå…¬æœ‰çš„ç»“æ„ä½“å’Œæšä¸¾)
  - [7.4 ä½¿ç”¨ use å…³é”®å­—å°†è·¯å¾„å¼•å…¥ä½œç”¨åŸŸ](#74-ä½¿ç”¨-use-å…³é”®å­—å°†è·¯å¾„å¼•å…¥ä½œç”¨åŸŸ)
    - [ä½¿ç”¨ as å…³é”®å­—æä¾›æ–°çš„åç§°](#ä½¿ç”¨-as-å…³é”®å­—æä¾›æ–°çš„åç§°)
    - [ä½¿ç”¨ pub use é‡å¯¼å‡ºåç§°](#ä½¿ç”¨-pub-use-é‡å¯¼å‡ºåç§°)
    - [ä½¿ç”¨å¤–éƒ¨åŒ…](#ä½¿ç”¨å¤–éƒ¨åŒ…)
    - [åµŒå¥—è·¯å¾„æ¥æ¶ˆé™¤å¤§é‡çš„ use è¡Œ](#åµŒå¥—è·¯å¾„æ¥æ¶ˆé™¤å¤§é‡çš„-use-è¡Œ)
    - [é€šè¿‡ glob è¿ç®—ç¬¦(\*)å°†æ‰€æœ‰çš„å…¬æœ‰å®šä¹‰å¼•å…¥ä½œç”¨åŸŸ](#é€šè¿‡-glob-è¿ç®—ç¬¦å°†æ‰€æœ‰çš„å…¬æœ‰å®šä¹‰å¼•å…¥ä½œç”¨åŸŸ)
  - [7.5 å°†æ¨¡å—æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶](#75-å°†æ¨¡å—æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶)
- [8. å¸¸è§é›†åˆ](#8-å¸¸è§é›†åˆ)
  - [8.1 Vector](#81-vector)
    - [Create](#create)
    - [Update](#update)
    - [Access](#access)
      - [å€Ÿç”¨è§„åˆ™ä¸è¯»å–vecå…ƒç´ ](#å€Ÿç”¨è§„åˆ™ä¸è¯»å–vecå…ƒç´ )
    - [éå† vector ä¸­çš„å…ƒç´ ](#éå†-vector-ä¸­çš„å…ƒç´ )
    - [ä½¿ç”¨æšä¸¾æ¥å‚¨å­˜å¤šç§ç±»å‹](#ä½¿ç”¨æšä¸¾æ¥å‚¨å­˜å¤šç§ç±»å‹)
    - [ä¸¢å¼ƒ vector æ—¶ä¹Ÿä¼šä¸¢å¼ƒå…¶æ‰€æœ‰å…ƒç´ ](#ä¸¢å¼ƒ-vector-æ—¶ä¹Ÿä¼šä¸¢å¼ƒå…¶æ‰€æœ‰å…ƒç´ )
  - [8.2 å­—ç¬¦ä¸²(String) å’Œ UTF-8 encoded Text](#82-å­—ç¬¦ä¸²string-å’Œ-utf-8-encoded-text)
    - [æ–°å»ºå­—ç¬¦ä¸²](#æ–°å»ºå­—ç¬¦ä¸²)
    - [æ›´æ–°å­—ç¬¦ä¸²](#æ›´æ–°å­—ç¬¦ä¸²)
      - [push\_str](#push_str)
      - [+](#-1)
      - [format!](#format)
    - [ç´¢å¼•å­—ç¬¦ä¸²](#ç´¢å¼•å­—ç¬¦ä¸²)
    - [éå†å­—ç¬¦ä¸²çš„æ–¹æ³•](#éå†å­—ç¬¦ä¸²çš„æ–¹æ³•)
  - [8.3 HashMap and Key-Value entry](#83-hashmap-and-key-value-entry)
    - [æ–°å»ºä¸€ä¸ªå“ˆå¸Œ map](#æ–°å»ºä¸€ä¸ªå“ˆå¸Œ-map)
    - [è®¿é—®å“ˆå¸Œ map ä¸­çš„å€¼](#è®¿é—®å“ˆå¸Œ-map-ä¸­çš„å€¼)
    - [å“ˆå¸Œ map å’Œæ‰€æœ‰æƒ](#å“ˆå¸Œ-map-å’Œæ‰€æœ‰æƒ)
    - [æ›´æ–°å“ˆå¸Œ map](#æ›´æ–°å“ˆå¸Œ-map)
    - [å“ˆå¸Œå‡½æ•°](#å“ˆå¸Œå‡½æ•°)
- [9.é”™è¯¯å¤„ç†](#9é”™è¯¯å¤„ç†)
  - [9.1 ç”¨ panic! å¤„ç†ä¸å¯æ¢å¤çš„é”™è¯¯](#91-ç”¨-panic-å¤„ç†ä¸å¯æ¢å¤çš„é”™è¯¯)
      - [å¯¹åº” panic æ—¶çš„æ ˆå±•å¼€æˆ–ç»ˆæ­¢](#å¯¹åº”-panic-æ—¶çš„æ ˆå±•å¼€æˆ–ç»ˆæ­¢)
    - [ä½¿ç”¨ panic! çš„ backtrace](#ä½¿ç”¨-panic-çš„-backtrace)
      - [è®¾ç½® RUST\_BACKTRACE ç¯å¢ƒå˜é‡](#è®¾ç½®-rust_backtrace-ç¯å¢ƒå˜é‡)
  - [9.2 ç”¨ Result å¤„ç†å¯æ¢å¤çš„é”™è¯¯](#92-ç”¨-result-å¤„ç†å¯æ¢å¤çš„é”™è¯¯)
    - [åŒ¹é…ä¸åŒçš„é”™è¯¯](#åŒ¹é…ä¸åŒçš„é”™è¯¯)
      - [ä½¿ç”¨é—­åŒ…ä»£æ›¿matchå’ŒResult\<T, E\>](#ä½¿ç”¨é—­åŒ…ä»£æ›¿matchå’Œresultt-e)
    - [å¤±è´¥æ—¶ panic çš„ç®€å†™ï¼šunwrap å’Œ expect](#å¤±è´¥æ—¶-panic-çš„ç®€å†™unwrap-å’Œ-expect)
    - [ä¼ æ’­é”™è¯¯](#ä¼ æ’­é”™è¯¯)
    - [ä¼ æ’­é”™è¯¯çš„ç®€å†™ï¼š? è¿ç®—ç¬¦](#ä¼ æ’­é”™è¯¯çš„ç®€å†™-è¿ç®—ç¬¦)
  - [9.3 è¦ä¸è¦ panic!](#93-è¦ä¸è¦-panic)
- [10. Generic Types, Traits, and Lifetimes](#10-generic-types-traits-and-lifetimes)
    - [æ²¡æœ‰æ³›å‹æ—¶çš„å¤„ç†æ–¹å¼ï¼šæå–å‡½æ•°](#æ²¡æœ‰æ³›å‹æ—¶çš„å¤„ç†æ–¹å¼æå–å‡½æ•°)
  - [9.2 æ³›å‹æ•°æ®ç±»å‹](#92-æ³›å‹æ•°æ®ç±»å‹)
    - [åœ¨å‡½æ•°å®šä¹‰ä¸­ä½¿ç”¨æ³›å‹](#åœ¨å‡½æ•°å®šä¹‰ä¸­ä½¿ç”¨æ³›å‹)
    - [ç»“æ„ä½“å®šä¹‰ä¸­çš„æ³›å‹](#ç»“æ„ä½“å®šä¹‰ä¸­çš„æ³›å‹)
    - [æšä¸¾å®šä¹‰ä¸­çš„æ³›å‹](#æšä¸¾å®šä¹‰ä¸­çš„æ³›å‹)
    - [æ–¹æ³•å®šä¹‰ä¸­çš„æ³›å‹](#æ–¹æ³•å®šä¹‰ä¸­çš„æ³›å‹)
      - [å®šä¹‰ä¸­çš„æ³›å‹ç±»å‹ \& æ–¹æ³•ç­¾åä¸­ä½¿ç”¨çš„æ³›å‹](#å®šä¹‰ä¸­çš„æ³›å‹ç±»å‹--æ–¹æ³•ç­¾åä¸­ä½¿ç”¨çš„æ³›å‹)
    - [æ³›å‹ä»£ç çš„æ€§èƒ½](#æ³›å‹ä»£ç çš„æ€§èƒ½)
  - [10.2 Traitï¼šå®šä¹‰å…±åŒè¡Œä¸º](#102-traitå®šä¹‰å…±åŒè¡Œä¸º)
    - [å®šä¹‰ trait](#å®šä¹‰-trait)
    - [ä¸ºç±»å‹å®ç° trait](#ä¸ºç±»å‹å®ç°-trait)
    - [é»˜è®¤å®ç°](#é»˜è®¤å®ç°)
    - [trait ä½œä¸ºå‚æ•°](#trait-ä½œä¸ºå‚æ•°)
    - [é€šè¿‡ `+` æŒ‡å®šå¤šä¸ª trait bound](#é€šè¿‡--æŒ‡å®šå¤šä¸ª-trait-bound)
    - [é€šè¿‡ where ç®€åŒ– trait bound](#é€šè¿‡-where-ç®€åŒ–-trait-bound)
    - [è¿”å› å®ç°äº† trait çš„ç±»å‹](#è¿”å›-å®ç°äº†-trait-çš„ç±»å‹)
    - [ä½¿ç”¨ trait bound æœ‰æ¡ä»¶åœ°å®ç°æ–¹æ³•](#ä½¿ç”¨-trait-bound-æœ‰æ¡ä»¶åœ°å®ç°æ–¹æ³•)


# Warning and Error

- Cargoæ›´æ–°ä¸‹è½½æ…¢
    æ¢æº, `/Users/<your user name>/.cargo` ä¸‹æ–°å»ºconfigæ–‡ä»¶ï¼š
    ```xml
    [source.crates-io]
    registry = "https://github.com/rust-lang/crates.io-index"

    replace-with = 'ustc'

    [source.ustc]
    registry = "git://mirrors.ustc.edu.cn/crates.io-index"
    ```

- `No Cargo projects are found`
    
    è¿™ä¸ªé”™è¯¯é€šå¸¸æ„å‘³ç€CLionæ— æ³•æ‰¾åˆ°ä»»ä½•Cargoé¡¹ç›®ï¼Œå› æ­¤å®ƒæ— æ³•åœ¨æ‚¨çš„Rustä»£ç ä¸Šè¿è¡ŒCargoå‘½ä»¤ã€‚
    
    æ£€é”™ï¼š
    1. ç¡®ä¿æ‚¨ä½äºæ­£ç¡®çš„ç›®å½•ä¸­ï¼šå¯¼èˆªåˆ°Rusté¡¹ç›®çš„æ ¹ç›®å½•ã€‚è¿™æ˜¯åŒ…å«Cargo.tomlæ–‡ä»¶çš„ç›®å½•ã€‚æ‚¨åº”è¯¥ä»æ­¤ç›®å½•è¿è¡Œè´§ç‰©å‘½ä»¤ã€‚
    2. åˆå§‹åŒ–Rusté¡¹ç›®ï¼šå¦‚æœæ‚¨ä¸åœ¨åŒ…å«Cargo.tomlæ–‡ä»¶çš„ç›®å½•ä¸­ï¼Œåˆ™å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ–æ–°çš„Rusté¡¹ç›®ï¼š
    > `cargo new your_project_name`

    extra:
    ä½¿ç”¨rust roveræ–°å»ºé¡¹ç›®ä¹‹åç¬¬ä¸€æ¬¡cargo checkå®Œæˆä»¥å‰ä¼šæŠ¥è¿™ä¸ªé”™ã€‚ç­‰åˆå§‹åŒ–å®Œæˆå°±å¥½äº†



- `module declaration missing`

- æ£€æŸ¥æ¨¡å—å£°æ˜(Check Module Declarations)ï¼šéªŒè¯æ‚¨å·²ç»åœ¨Rustä»£ç ä¸­å£°æ˜äº†æ¨¡å—ã€‚åœ¨Rustä¸­ï¼Œä½¿ç”¨modå…³é”®å­—å£°æ˜æ¨¡å—ã€‚ä¾‹å¦‚ï¼š
    ```rust
    // In your main.rs or lib.rs file
    mod my_module;
    ```


# ShortCut

- `cmd + option + t`: åŒ…è£¹ä»£ç å—

# 1. Getting Started
## 1.1 First Program

ç¼–è¯‘ï¼š`rustc main.rs`

ç¼–è¯‘å®Œæˆä¼šç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶`main.exe`, åŒ…å«è°ƒè¯•ä¿¡æ¯æ–‡ä»¶`main.pdb`

## 1.2 Cargo
`cargo --version` æŸ¥çœ‹ç‰ˆæœ¬

### ï¼ï¼ï¼Cargo æ“ä½œæ…¢


### ä½¿ç”¨ Cargo åˆ›å»ºé¡¹ç›®

`cargo new hello_cargo` é»˜è®¤ä¼šåœ¨ hello_cargo ç›®å½•åˆå§‹åŒ–ä¸€ä¸ª git ä»“åº“, ä»¥åŠä¸€ä¸ª.gitignore æ–‡ä»¶

å¦‚æœåœ¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ git ä»“åº“ä¸­è¿è¡Œ cargo newï¼Œåˆ™è¿™äº› git ç›¸å…³æ–‡ä»¶åˆ™ä¸ä¼šç”Ÿæˆï¼›å¯ä»¥é€šè¿‡è¿è¡Œ `cargo new --vcs=git` æ¥è¦†ç›–è¿™äº›è¡Œä¸ºã€‚

### Cargo.tomlç»“æ„
```rust
[package]
name = "hello_cargo"
version = "0.1.0"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]

```

`[dependencies]`ï¼Œæ˜¯ç½—åˆ—é¡¹ç›®ä¾èµ–çš„ç‰‡æ®µçš„å¼€å§‹ã€‚åœ¨ Rust ä¸­ï¼Œä»£ç åŒ…è¢«ç§°ä¸º `crates`ã€‚

Cargo æœŸæœ›æºæ–‡ä»¶å­˜æ”¾åœ¨ src ç›®å½•ä¸­ã€‚é¡¹ç›®æ ¹ç›®å½•åªå­˜æ”¾ READMEã€license ä¿¡æ¯ã€é…ç½®æ–‡ä»¶å’Œå…¶ä»–è·Ÿä»£ç æ— å…³çš„æ–‡ä»¶ã€‚ä½¿ç”¨ Cargo å¸®åŠ©ä½ ä¿æŒé¡¹ç›®å¹²å‡€æ•´æ´ï¼Œä¸€åˆ‡äº•äº•æœ‰æ¡ã€‚

### ä¸ºæ²¡æœ‰ä½¿ç”¨Cargoçš„é¡¹ç›®å¼•å…¥Cargo
è¦åœ¨ä»»ä½•å·²å­˜åœ¨çš„é¡¹ç›®ä¸Šå·¥ä½œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤é€šè¿‡ Git æ£€å‡ºä»£ç ï¼Œç§»åŠ¨åˆ°è¯¥é¡¹ç›®ç›®å½•å¹¶æ„å»ºï¼š

```rust
$ git clone example.org/some_project
$ cd some_project
$ cargo build
```

### Cargoæ„å»ºä¸è¿è¡Œ
1. `build`: åœ¨æ ¹ç›®å½•ä¸‹è¿è¡Œ `cargo build`, ä¼šåˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ `target/debug/hello_cargo`ã€‚
   - ç”±äºé»˜è®¤çš„æ„å»ºæ–¹æ³•æ˜¯`è°ƒè¯•æ„å»ºï¼ˆdebug buildï¼‰`ï¼ŒCargo ä¼šå°†å¯æ‰§è¡Œæ–‡ä»¶æ”¾åœ¨åä¸º `debug` çš„ç›®å½•ä¸­ã€‚
   - é¦–æ¬¡è¿è¡Œ `cargo build` æ—¶ï¼Œä¹Ÿä¼šä½¿ Cargo åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼š`Cargo.lock`ã€‚è¿™ä¸ªæ–‡ä»¶è®°å½•é¡¹ç›®ä¾èµ–çš„å®é™…ç‰ˆæœ¬ã€‚è¿™ä¸ªé¡¹ç›®å¹¶æ²¡æœ‰ä¾èµ–ï¼Œæ‰€ä»¥å…¶å†…å®¹æ¯”è¾ƒå°‘ã€‚ä½ è‡ªå·±æ°¸è¿œä¹Ÿä¸éœ€è¦ç¢°è¿™ä¸ªæ–‡ä»¶ï¼Œè®© Cargo å¤„ç†å®ƒå°±è¡Œäº†ã€‚
2. `run`: åŒæ—¶ç¼–è¯‘å¹¶è¿è¡Œç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
   - Cargo ä¼šæ£€æŸ¥æºæ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹ï¼Œå¦‚æœæ²¡æœ‰å®ƒå°±ä¸ç”¨é‡æ–°ç¼–è¯‘ï¼Œè€Œæ˜¯ç›´æ¥è¿è¡Œäº†å¯æ‰§è¡Œæ–‡ä»¶ã€‚å¦‚æœä¿®æ”¹äº†æºæ–‡ä»¶çš„è¯ï¼ŒCargo ä¼šåœ¨è¿è¡Œä¹‹å‰é‡æ–°æ„å»ºé¡¹ç›®
3. `check`: å¿«é€Ÿæ£€æŸ¥ä»£ç ç¡®ä¿å…¶å¯ä»¥ç¼–è¯‘ï¼Œä½†å¹¶`ä¸äº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶`ã€‚
   - é€šå¸¸ `cargo check` è¦æ¯” `cargo build` å¿«å¾—å¤šï¼Œå› ä¸ºå®ƒçœç•¥äº†ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶çš„æ­¥éª¤ã€‚
   - å¦‚æœä½ åœ¨ç¼–å†™ä»£ç æ—¶æŒç»­çš„è¿›è¡Œæ£€æŸ¥ï¼Œ`cargo check` å¯ä»¥è®©ä½ å¿«é€Ÿäº†è§£ç°åœ¨çš„ä»£ç èƒ½ä¸èƒ½æ­£å¸¸é€šè¿‡ç¼–è¯‘ï¼å½“å‡†å¤‡å¥½ä½¿ç”¨å¯æ‰§è¡Œæ–‡ä»¶æ—¶æ‰è¿è¡Œ `cargo build`

### å‘å¸ƒï¼ˆreleaseï¼‰æ„å»º
å½“é¡¹ç›®æœ€ç»ˆå‡†å¤‡å¥½å‘å¸ƒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `cargo build --release` æ¥`ä¼˜åŒ–`ç¼–è¯‘é¡¹ç›®ã€‚è¿™ä¼šåœ¨ `target/release` è€Œä¸æ˜¯ `target/debug` ä¸‹ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚

è¿™äº›ä¼˜åŒ–å¯ä»¥è®© Rust ä»£ç è¿è¡Œçš„æ›´å¿«ï¼Œä¸è¿‡å¯ç”¨è¿™äº›ä¼˜åŒ–ä¹Ÿéœ€è¦æ¶ˆè€—æ›´é•¿çš„ç¼–è¯‘æ—¶é—´ã€‚

å¦‚æœä½ åœ¨æµ‹è¯•ä»£ç çš„è¿è¡Œæ—¶é—´ï¼Œè¯·ç¡®ä¿è¿è¡Œ `cargo build --release` å¹¶ä½¿ç”¨ target/release ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œæµ‹è¯•ã€‚


## 2. Guessing Game

é»˜è®¤æƒ…å†µä¸‹ï¼ŒRust è®¾å®šäº†è‹¥å¹²ä¸ªä¼šè‡ªåŠ¨å¯¼å…¥åˆ°æ¯ä¸ªç¨‹åºä½œç”¨åŸŸä¸­çš„æ ‡å‡†åº“å†…å®¹ï¼Œè¿™ç»„å†…å®¹è¢«ç§°ä¸º `é¢„å¯¼å…¥ï¼ˆprecludeï¼‰` å†…å®¹ã€‚

å¦‚æœä½ éœ€è¦çš„ç±»å‹ä¸åœ¨é¢„å¯¼å…¥å†…å®¹ä¸­ï¼Œå°±å¿…é¡»ä½¿ç”¨ `use` è¯­å¥æ˜¾å¼åœ°å°†å…¶å¼•å…¥ä½œç”¨åŸŸã€‚

`std::io` åº“æä¾›å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„åŠŸèƒ½ã€‚

### ä½¿ç”¨å˜é‡å‚¨å­˜å€¼
åœ¨ Rust ä¸­ï¼Œ`å˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„`ï¼Œè¿™æ„å‘³ç€ä¸€æ—¦æˆ‘ä»¬ç»™å˜é‡èµ‹å€¼ï¼Œè¿™ä¸ªå€¼å°±ä¸å†å¯ä»¥ä¿®æ”¹äº†ã€‚

åœ¨å˜é‡åå‰ä½¿ç”¨ `mut` æ¥ä½¿ä¸€ä¸ªå˜é‡å¯å˜:
```rust
let apples = 5; // ä¸å¯å˜
let mut bananas = 5; // å¯å˜
```

### é™æ€æ–¹æ³•
```rust
let mut guess = String::new();
```
`:: `è¯­æ³•è¡¨æ˜ `new` æ˜¯ `String` ç±»å‹çš„ä¸€ä¸ª `å…³è”å‡½æ•°ï¼ˆassociated functionï¼‰`ã€‚

å…³è”å‡½æ•°æ˜¯é’ˆå¯¹ç±»å‹å®ç°çš„ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ Stringï¼Œè€Œä¸æ˜¯ String çš„æŸä¸ªç‰¹å®šå®ä¾‹ã€‚ä¸€äº›è¯­è¨€ä¸­æŠŠå®ƒç§°ä¸º `é™æ€æ–¹æ³•ï¼ˆstatic methodï¼‰`ã€‚

### è¾“å…¥è¾“å‡º(std::io)
```rust
    io::stdin()
        .read_line(&mut guess)
        .`expect`("Failed to read line");
```
- å¦‚æœç¨‹åºçš„å¼€å¤´æ²¡æœ‰ä½¿ç”¨ use std::io; å¼•å…¥ io åº“ï¼Œæˆ‘ä»¬ä»å¯ä»¥é€šè¿‡æŠŠå‡½æ•°è°ƒç”¨å†™æˆ std::io::stdin æ¥ä½¿ç”¨å‡½æ•°ã€‚
- è°ƒç”¨ `read_line` æ–¹æ³•ä»æ ‡å‡†è¾“å…¥å¥æŸ„è·å–ç”¨æˆ·è¾“å…¥ã€‚å°† `&mut guess` ä½œä¸ºå‚æ•°ä¼ é€’ç»™ `read_line()` å‡½æ•°ï¼Œè®©å…¶å°†ç”¨æˆ·è¾“å…¥å‚¨å­˜åˆ°è¿™ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚
- `read_line` çš„å·¥ä½œæ˜¯ï¼Œæ— è®ºç”¨æˆ·åœ¨æ ‡å‡†è¾“å…¥ä¸­é”®å…¥ä»€ä¹ˆå†…å®¹ï¼Œéƒ½å°†å…¶`è¿½åŠ ï¼ˆä¸ä¼šè¦†ç›–å…¶åŸæœ‰å†…å®¹ï¼‰`åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œå› æ­¤å®ƒéœ€è¦å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚
- `&` è¡¨ç¤ºè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª `å¼•ç”¨ï¼ˆreferenceï¼‰`ï¼Œå®ƒå…è®¸å¤šå¤„ä»£ç è®¿é—®åŒä¸€å¤„æ•°æ®ï¼Œè€Œæ— éœ€åœ¨å†…å­˜ä¸­å¤šæ¬¡æ‹·è´ã€‚


### ä½¿ç”¨ Result ç±»å‹æ¥å¤„ç†æ½œåœ¨çš„é”™è¯¯

```rust
    io::stdin()
        .read_line(&mut guess)
        .expect("Failed to read line");
```
- `read_line` ä¼šå°†ç”¨æˆ·è¾“å…¥é™„åŠ åˆ°ä¼ é€’ç»™å®ƒçš„å­—ç¬¦ä¸²ä¸­ï¼Œè¿”å›ä¸€ä¸ªç±»å‹ä¸º `Result` çš„å€¼
- `Result` æ˜¯ä¸€ç§æšä¸¾ç±»å‹ï¼Œé€šå¸¸ä¹Ÿå†™ä½œ `enum` ã€‚æšä¸¾ç±»å‹å˜é‡çš„å€¼å¯ä»¥æ˜¯`å¤šç§å¯èƒ½çŠ¶æ€`ä¸­çš„ä¸€ä¸ªã€‚æˆ‘ä»¬æŠŠæ¯ç§å¯èƒ½çš„çŠ¶æ€ç§°ä¸ºä¸€ç§ `æšä¸¾æˆå‘˜ï¼ˆvariantï¼‰`ã€‚
- `Result` çš„æˆå‘˜æ˜¯ `Ok` å’Œ `Err`:
  - `Ok` æˆå‘˜è¡¨ç¤ºæ“ä½œæˆåŠŸï¼Œå†…éƒ¨åŒ…å«æˆåŠŸæ—¶äº§ç”Ÿçš„å€¼ã€‚ 
  - `Err` æˆå‘˜åˆ™æ„å‘³ç€æ“ä½œå¤±è´¥ï¼Œå¹¶ä¸”åŒ…å«å¤±è´¥çš„å‰å› åæœã€‚
- `Result` çš„å®ä¾‹æ‹¥æœ‰ `expect` æ–¹æ³•ã€‚
  - å¦‚æœ `io::Result` å®ä¾‹çš„å€¼æ˜¯ `Err` ï¼Œ `expect` ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œå¹¶æ˜¾ç¤ºå½“åšå‚æ•°ä¼ é€’ç»™ `expect` çš„ä¿¡æ¯ã€‚
  - å¦‚æœ `Result` å®ä¾‹çš„å€¼æ˜¯ `Ok`, `expect` ä¼šè·å– `Ok` ä¸­çš„å€¼å¹¶åŸæ ·è¿”å›ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œè¿™ä¸ªå€¼æ˜¯ç”¨æˆ·è¾“å…¥åˆ°æ ‡å‡†è¾“å…¥ä¸­çš„å­—èŠ‚æ•°ã€‚

### ä½¿ç”¨ println! å ä½ç¬¦æ‰“å°å€¼

`{} `æ˜¯é¢„ç•™åœ¨ç‰¹å®šä½ç½®çš„å ä½ç¬¦.

å½“æ‰“å°å˜é‡çš„å€¼æ—¶ï¼Œ`å˜é‡åå¯ä»¥å†™è¿›å¤§æ‹¬å·ä¸­`ã€‚å½“æ‰“å°è¡¨è¾¾å¼çš„æ‰§è¡Œç»“æœæ—¶ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆformat stringï¼‰ä¸­å¤§æ‹¬å·ä¸­ç•™ç©ºï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²åè·Ÿé€—å·åˆ†éš”çš„éœ€è¦æ‰“å°çš„è¡¨è¾¾å¼åˆ—è¡¨ï¼Œå…¶é¡ºåºä¸æ¯ä¸€ä¸ªç©ºå¤§æ‹¬å·å ä½ç¬¦çš„é¡ºåºä¸€è‡´ã€‚

```rust
let x = 5;
let y = 10;
println!("x = {x} and y + 2 = {}", y + 2);
```
è¿™è¡Œä»£ç ä¼šæ‰“å°å‡º` x = 5` and `y + 2 = 12`ã€‚

### ä½¿ç”¨crate
`crate` åˆ†ä¸º`åº“crate`å’Œ`äºŒè¿›åˆ¶crate`ï¼š
  - åº“crate å¯ä»¥åŒ…å«ä»»æ„èƒ½è¢«å…¶ä»–ç¨‹åºä½¿ç”¨çš„ä»£ç ï¼Œä½†æ˜¯ä¸èƒ½è‡ªæ‰§è¡Œ
  - äºŒè¿›åˆ¶crateï¼Œå¦‚æˆ‘ä»¬æ­£åœ¨æ„å»ºçš„é¡¹ç›®ï¼Œå®ƒç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶

Cargo å¯¹å¤–éƒ¨ crate çš„è¿ç”¨æ˜¯å…¶çœŸæ­£çš„äº®ç‚¹æ‰€åœ¨ã€‚åœ¨æˆ‘ä»¬ä½¿ç”¨ rand ç¼–å†™ä»£ç ä¹‹å‰ï¼Œéœ€è¦ä¿®æ”¹ Cargo.toml æ–‡ä»¶ï¼Œå¼•å…¥ä¸€ä¸ª rand ä¾èµ–ã€‚
```toml
[dependencies]
rand = "0.8.5"
```
> 0.8.5 äº‹å®ä¸Šæ˜¯ `^0.8.5 `çš„ç®€å†™ï¼Œå®ƒè¡¨ç¤ºä»»ä½•è‡³å°‘æ˜¯ 0.8.5 ä½†å°äº 0.9.0 çš„ç‰ˆæœ¬ã€‚


### Cargo.lock æ–‡ä»¶ç¡®ä¿æ„å»ºæ˜¯å¯é‡ç°çš„

Cargo æœ‰ä¸€ä¸ªæœºåˆ¶æ¥ç¡®ä¿ä»»ä½•äººåœ¨ä»»ä½•æ—¶å€™é‡æ–°æ„å»ºä»£ç ï¼Œéƒ½ä¼šäº§ç”Ÿç›¸åŒçš„ç»“æœï¼šCargo åªä¼šä½¿ç”¨ä½ æŒ‡å®šçš„ä¾èµ–ç‰ˆæœ¬ï¼Œé™¤éä½ åˆæ‰‹åŠ¨æŒ‡å®šäº†åˆ«çš„ã€‚

Rust åœ¨ä½ ç¬¬ä¸€æ¬¡è¿è¡Œ `cargo build` æ—¶å»ºç«‹äº† Cargo.lock æ–‡ä»¶, å½“å°†æ¥æ„å»ºé¡¹ç›®æ—¶ï¼ŒCargo ä¼šå‘ç° Cargo.lock å·²å­˜åœ¨å¹¶ä½¿ç”¨å…¶ä¸­æŒ‡å®šçš„ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯å†æ¬¡è®¡ç®—æ‰€æœ‰çš„ç‰ˆæœ¬. ä¾‹å¦‚ï¼Œå¦‚æœä¸‹å‘¨ rand crate çš„ 0.8.6 ç‰ˆæœ¬å‡ºæ¥äº†ï¼Œå®ƒä¿®å¤äº†ä¸€ä¸ªé‡è¦çš„ bugï¼ŒåŒæ—¶ä¹Ÿå«æœ‰ä¸€ä¸ªä¼šç ´åä»£ç è¿è¡Œçš„ç¼ºé™·, å¤šäºæœ‰äº† Cargo.lock æ–‡ä»¶, é¡¹ç›®ä¼šæŒç»­ä½¿ç”¨ 0.8.5 ç›´åˆ°ä½ æ˜¾å¼å‡çº§ã€‚


### æ›´æ–° crate åˆ°ä¸€ä¸ªæ–°ç‰ˆæœ¬
`cargo update` ä¼šå¿½ç•¥ Cargo.lock æ–‡ä»¶ï¼Œå¹¶è®¡ç®—å‡ºæ‰€æœ‰ç¬¦åˆ Cargo.toml å£°æ˜çš„æœ€æ–°ç‰ˆæœ¬. Cargo æ¥ä¸‹æ¥ä¼šæŠŠè¿™äº›ç‰ˆæœ¬å†™å…¥ Cargo.lock æ–‡ä»¶ã€‚

ä¸è¿‡ï¼ŒCargo é»˜è®¤åªä¼šå¯»æ‰¾å¤§äº 0.8.5 è€Œå°äº 0.9.0 çš„ç‰ˆæœ¬ã€‚å¦‚æœæƒ³è¦ä½¿ç”¨ 0.9.0 ç‰ˆæœ¬çš„ rand æˆ–æ˜¯ä»»ä½• 0.9.x ç³»åˆ—çš„ç‰ˆæœ¬ï¼Œå¿…é¡»åƒè¿™æ ·æ›´æ–° Cargo.toml æ–‡ä»¶ï¼š
```toml
[dependencies]

rand = "0.9.0"
```
ä¸‹ä¸€æ¬¡è¿è¡Œ `cargo build` æ—¶ï¼ŒCargo ä¼šä» registry æ›´æ–°å¯ç”¨çš„ crateï¼Œå¹¶æ ¹æ®ä½ æŒ‡å®šçš„æ–°ç‰ˆæœ¬é‡æ–°è®¡ç®—ã€‚


### ä½¿ç”¨randç”Ÿæˆä¸€ä¸ªéšæœºæ•°
```rust
use rand::Rng;
// ...
    let secret_number =
        rand::thread_rng()
            .gen_range(1..=100);
```
- `Rng` æ˜¯ä¸€ä¸ª `trait` ï¼Œå®ƒå®šä¹‰äº†éšæœºæ•°ç”Ÿæˆå™¨åº”å®ç°çš„æ–¹æ³•
- `rand::thread_rng` å‡½æ•°æä¾›å®é™…ä½¿ç”¨çš„éšæœºæ•°ç”Ÿæˆå™¨ï¼šå®ƒä½äºå½“å‰æ‰§è¡Œçº¿ç¨‹çš„æœ¬åœ°ç¯å¢ƒä¸­ï¼Œå¹¶ä»æ“ä½œç³»ç»Ÿè·å– seed
- æ¥ç€è°ƒç”¨éšæœºæ•°ç”Ÿæˆå™¨çš„ `gen_range` æ–¹æ³•: è·å–ä¸€ä¸ªèŒƒå›´è¡¨è¾¾å¼ï¼ˆrange expressionï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªåœ¨æ­¤èŒƒå›´ä¹‹é—´çš„éšæœºæ•°:
  - è¿™é‡Œä½¿ç”¨çš„è¿™ç±»èŒƒå›´è¡¨è¾¾å¼ä½¿ç”¨äº† `start..=end` è¿™æ ·çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯è¯´åŒ…å«äº†ä¸Šä¸‹ç«¯ç‚¹ï¼Œæ‰€ä»¥éœ€è¦æŒ‡å®š `1..=100` æ¥è¯·æ±‚ä¸€ä¸ª 1 å’Œ 100 ä¹‹é—´çš„æ•°ã€‚

> ä½ ä¸å¯èƒ½å‡­ç©ºå°±çŸ¥é“åº”è¯¥ use å“ªä¸ª trait ä»¥åŠè¯¥ä» crate ä¸­è°ƒç”¨å“ªä¸ªæ–¹æ³•ï¼Œå› æ­¤æ¯ä¸ª crate æœ‰ä½¿ç”¨è¯´æ˜æ–‡æ¡£ã€‚
> Cargo æœ‰ä¸€ä¸ªå¾ˆæ£’çš„åŠŸèƒ½æ˜¯ï¼šè¿è¡Œ `cargo doc --open` å‘½ä»¤æ¥æ„å»ºæ‰€æœ‰æœ¬åœ°ä¾èµ–æä¾›çš„æ–‡æ¡£ï¼Œå¹¶åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ã€‚
> ä¾‹å¦‚ï¼Œå‡è®¾ä½ å¯¹ rand crate ä¸­çš„å…¶ä»–åŠŸèƒ½æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥è¿è¡Œ `cargo doc --open` å¹¶ç‚¹å‡»å·¦ä¾§å¯¼èˆªæ ä¸­çš„ randã€‚


### æ¯”è¾ƒçŒœæµ‹çš„æ•°å­—å’Œç§˜å¯†æ•°å­—
```rust
use std::cmp::Ordering;

    match guess.cmp(&secret_number) {
        Ordering::Less => println!("Too small!"),
        Ordering::Greater => println!("Too big!"),
        Ordering::Equal => println!("You win!"),
    }

```
- `Ordering` ä¹Ÿæ˜¯ä¸€ä¸ªæšä¸¾ï¼Œä¸è¿‡å®ƒçš„æˆå‘˜æ˜¯ `Less` `ã€Greater` å’Œ `Equal` ã€‚è¿™æ˜¯æ¯”è¾ƒä¸¤ä¸ªå€¼æ—¶å¯èƒ½å‡ºç°çš„ä¸‰ç§ç»“æœã€‚
- `cmp` æ–¹æ³•ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå€¼, å¹¶å¯ä»¥åœ¨ä»»ä½•å¯æ¯”è¾ƒçš„å€¼ä¸Šè°ƒç”¨ã€‚å®ƒè·å–ä¸€ä¸ªè¢«æ¯”è¾ƒå€¼çš„å¼•ç”¨ï¼šè¿™é‡Œæ˜¯æŠŠ guess ä¸ secret_number åšæ¯”è¾ƒã€‚ç„¶åå®ƒä¼šè¿”å›ä¸€ä¸ª `Ordering` æšä¸¾çš„æˆå‘˜ã€‚
- `match` è¡¨è¾¾å¼ï¼Œæ ¹æ®å¯¹ guess å’Œ secret_number è°ƒç”¨ cmp è¿”å›çš„ Ordering æˆå‘˜æ¥å†³å®šæ¥ä¸‹æ¥åšä»€ä¹ˆã€‚


### é™æ€å¼ºç±»å‹ & ç±»å‹æ¨æ–­
Rust æœ‰ä¸€ä¸ª`é™æ€å¼ºç±»å‹`ç³»ç»Ÿï¼ŒåŒæ—¶ä¹Ÿæœ‰`ç±»å‹æ¨æ–­`ã€‚

å½“æˆ‘ä»¬å†™å‡º `let guess = String::new()` æ—¶ï¼ŒRust æ¨æ–­å‡º `guess` åº”è¯¥æ˜¯ `String` ç±»å‹ï¼Œå¹¶ä¸éœ€è¦æˆ‘ä»¬å†™å‡ºç±»å‹ã€‚

å¦ä¸€æ–¹é¢ï¼Œ`secret_number`ï¼Œæ˜¯æ•°å­—ç±»å‹ã€‚Rust é»˜è®¤ä½¿ç”¨ `i32` ï¼Œæ‰€ä»¥å®ƒæ˜¯ secret_number çš„ç±»å‹ï¼Œé™¤éå¢åŠ ç±»å‹ä¿¡æ¯ï¼Œæˆ–ä»»ä½•èƒ½è®© Rust æ¨æ–­å‡ºä¸åŒæ•°å€¼ç±»å‹çš„ä¿¡æ¯ã€‚
> Rustçš„ä¸€äº›æ•°å­—ç±»å‹çš„å€¼å¯ä»¥ä»‹äº1å’Œ100ä¹‹é—´ï¼ši32ä¸º 32ä½æ•°å­—ï¼›u32ä¸º æ— ç¬¦å·32ä½æ•°å­—ï¼›i64ä¸º64ä½æ•°å­—ï¼›ä»¥åŠå…¶ä»–

æ‰€ä»¥æˆ‘ä»¬å¿…é¡»æŠŠä»è¾“å…¥ä¸­è¯»å–åˆ°çš„ `String` è½¬æ¢ä¸ºä¸€ä¸ªçœŸæ­£çš„æ•°å­—ç±»å‹ï¼Œæ‰å¥½ä¸ `secret_number` è¿›è¡Œæ¯”è¾ƒã€‚

```rust
    let guess: u32 =
        guess.trim()
            .parse()
            .expect("Please type a number!");
```
è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªå«åš guess çš„å˜é‡ã€‚ä¸è¿‡ç­‰ç­‰ï¼Œä¸æ˜¯å·²ç»æœ‰äº†ä¸€ä¸ªå«åš guess çš„å˜é‡äº†å—ï¼Ÿç¡®å®å¦‚æ­¤ï¼Œä¸è¿‡ Rust å…è®¸ç”¨ä¸€ä¸ªæ–°å€¼æ¥ `éšè— ï¼ˆShadowingï¼‰` guess ä¹‹å‰çš„å€¼ã€‚è¿™ä¸ªåŠŸèƒ½å¸¸ç”¨åœ¨éœ€è¦`è½¬æ¢å€¼ç±»å‹`ä¹‹ç±»çš„åœºæ™¯ã€‚å®ƒå…è®¸æˆ‘ä»¬`å¤ç”¨ guess` å˜é‡çš„åå­—ï¼Œè€Œä¸æ˜¯è¢«è¿«åˆ›å»ºä¸¤ä¸ªä¸åŒå˜é‡ï¼Œè¯¸å¦‚ guess_str å’Œ guess ä¹‹ç±»ã€‚

- String å®ä¾‹çš„ `trim` æ–¹æ³•ä¼šå»é™¤å­—ç¬¦ä¸²å¼€å¤´å’Œç»“å°¾çš„ç©ºç™½å­—ç¬¦. 
  - ç”¨æˆ·å¿…é¡»è¾“å…¥ `enter` é”®æ‰èƒ½è®© read_line è¿”å›å¹¶è¾“å…¥ä»–ä»¬çš„çŒœæƒ³ï¼Œè¿™å°†ä¼šåœ¨å­—ç¬¦ä¸²ä¸­å¢åŠ ä¸€ä¸ª`æ¢è¡Œï¼ˆnewlineï¼‰ç¬¦`ã€‚
  - ä¾‹å¦‚ï¼Œç”¨æˆ·è¾“å…¥ 5 å¹¶æŒ‰ä¸‹ enterï¼ˆåœ¨ Windows ä¸Šï¼ŒæŒ‰ä¸‹ enter é”®ä¼šå¾—åˆ°ä¸€ä¸ªå›è½¦ç¬¦å’Œä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œ`\r\n`ï¼‰ï¼Œguess çœ‹èµ·æ¥åƒè¿™æ ·ï¼š5\n æˆ–è€… 5\r\nã€‚
  - \n ä»£è¡¨ â€œæ¢è¡Œâ€; \r ä»£è¡¨ â€œå›è½¦â€
  - trim æ–¹æ³•ä¼šæ¶ˆé™¤ \n æˆ–è€… \r\nï¼Œåªç•™ä¸‹ 5ã€‚


String å®ä¾‹çš„ `parse` æ–¹æ³• å°†å­—ç¬¦ä¸²è½¬æ¢æˆå…¶ä»–ç±»å‹ã€‚
  - è¿™é‡Œç”¨å®ƒæ¥æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å€¼ã€‚
  - æˆ‘ä»¬éœ€è¦å‘Šè¯‰ Rust å…·ä½“çš„æ•°å­—ç±»å‹ï¼Œguess åé¢çš„å†’å· `:` æŒ‡å®šäº†å˜é‡çš„ç±»å‹ `u32`
  - `parse` æ–¹æ³•åªæœ‰åœ¨ String é€»è¾‘ä¸Šå¯ä»¥è½¬æ¢ä¸ºæ•°å­—çš„æ—¶å€™æ‰èƒ½å·¥ä½œ, æ‰€ä»¥éå¸¸å®¹æ˜“å‡ºé”™ã€‚å› æ­¤ï¼Œ`parse` æ–¹æ³•è¿”å›ä¸€ä¸ª `Result` ç±»å‹ã€‚å¦‚æœ `parse` ä¸èƒ½ä»å­—ç¬¦ä¸²ç”Ÿæˆä¸€ä¸ªæ•°å­—ï¼Œè¿”å›ä¸€ä¸ª `Err` æˆå‘˜


### ä½¿ç”¨å¾ªç¯æ¥å…è®¸å¤šæ¬¡çŒœæµ‹

`loop` å…³é”®å­—åˆ›å»ºäº†ä¸€ä¸ªæ— é™å¾ªç¯ã€‚æˆ‘ä»¬ä¼šå¢åŠ å¾ªç¯æ¥ç»™ç”¨æˆ·æ›´å¤šæœºä¼šçŒœæ•°å­—ï¼š

```rust
    loop {
        print!("You guessed: {guess}");

        match guess.cmp(&secret_number) {
            Ordering::Less => println!("Too small!"),
            Ordering::Greater => println!("Too big!"),
            Ordering::Equal => println!("You win!"),
        }
    }
```

æˆ‘ä»¬æƒ³è¦å½“çŒœæµ‹æ­£ç¡®çš„æ•°å­—æ—¶æ¸¸æˆåœæ­¢, å¢åŠ ä¸€ä¸ª `break` è¯­å¥:
```rust
    loop {
        print!("You guessed: {guess}");

        match guess.cmp(&secret_number) {
            Ordering::Less => println!("Too small!"),
            Ordering::Greater => println!("Too big!"),
            Ordering::Equal => {
                println!("You win!");
                break;
            }
        }
    }
```

é€€å‡ºå¾ªç¯ä¹Ÿæ„å‘³ç€é€€å‡ºç¨‹åºï¼Œå› ä¸ºå¾ªç¯æ˜¯ main çš„æœ€åä¸€éƒ¨åˆ†ã€‚

### å¤„ç†æ— æ•ˆè¾“å…¥
```rust
        let guess: u32 = match guess.trim().parse() {
            Ok(num) => num,
            Err(_) => continue,
        };
```
- æˆ‘ä»¬å°† `expect` è°ƒç”¨æ¢æˆ `match` è¯­å¥ï¼Œä»¥ä»é‡åˆ°é”™è¯¯å°±å´©æºƒè½¬æ¢ä¸ºå¤„ç†é”™è¯¯.
- `Err(_)` æ¨¡å¼ï¼š`_` æ˜¯ä¸€ä¸ªé€šé…ç¬¦å€¼ï¼Œæœ¬ä¾‹ä¸­ç”¨æ¥åŒ¹é…æ‰€æœ‰ Err å€¼ï¼Œä¸ç®¡å…¶ä¸­æœ‰ä½•ç§ä¿¡æ¯
- break, continueå¿…é¡»å¤„äºloopä¸­


# 3. Common Programming Concepts
## 3.1 Variables and Mutability
### å¯å˜æ€§
Rustå˜é‡é»˜è®¤æ˜¯ä¸å¯æ”¹å˜çš„ï¼ˆimmutableï¼‰: å½“å˜é‡ä¸å¯å˜æ—¶ï¼Œä¸€æ—¦å€¼è¢«ç»‘å®šä¸€ä¸ªåç§°ä¸Šï¼Œä½ å°±ä¸èƒ½æ”¹å˜è¿™ä¸ªå€¼ã€‚ å¦åˆ™å°±ä¼šæŠ¥é”™
Error: `cannot assign twice to immutable variable`

ä¸è¿‡`å¯å˜æ€§`ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå°½ç®¡å˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼Œä½ ä»ç„¶å¯ä»¥åœ¨å˜é‡åå‰æ·»åŠ  `mut` æ¥ä½¿å…¶å¯å˜

```rust
fn main() {
    let mut x = 5;
    println!("The value of x is: {x}");
    x = 6;
    println!("The value of x is: {x}");
}
```
é€šè¿‡ `mut` ï¼Œå…è®¸æŠŠç»‘å®šåˆ° x çš„å€¼ä» 5 æ”¹æˆ 6ã€‚

### å¸¸é‡
ç±»ä¼¼äºä¸å¯å˜å˜é‡ï¼Œ`å¸¸é‡ (constants)` æ˜¯ç»‘å®šåˆ°ä¸€ä¸ªåç§°çš„ä¸å…è®¸æ”¹å˜çš„å€¼ï¼Œä¸è¿‡å¸¸é‡ä¸å˜é‡è¿˜æ˜¯æœ‰ä¸€äº›åŒºåˆ«ï¼š
- ä¸å…è®¸å¯¹å¸¸é‡ä½¿ç”¨ `mut`, å¸¸é‡ä¸å…‰é»˜è®¤ä¸å¯å˜ï¼Œå®ƒæ€»æ˜¯ä¸å¯å˜ã€‚
- å£°æ˜å¸¸é‡ä½¿ç”¨ `const` å…³é”®å­—è€Œä¸æ˜¯ letï¼Œå¹¶ä¸” `å¿…é¡» æ³¨æ˜å€¼çš„ç±»å‹`ã€‚
- å¸¸é‡å¯ä»¥åœ¨ä»»ä½•ä½œç”¨åŸŸä¸­å£°æ˜ï¼ŒåŒ…æ‹¬`å…¨å±€ä½œç”¨åŸŸ`ï¼Œè¿™åœ¨ä¸€ä¸ªå€¼éœ€è¦è¢«å¾ˆå¤šéƒ¨åˆ†çš„ä»£ç ç”¨åˆ°æ—¶å¾ˆæœ‰ç”¨ã€‚
- å¸¸é‡åªèƒ½è¢«è®¾ç½®ä¸º`å¸¸é‡è¡¨è¾¾å¼`ï¼Œè€Œ`ä¸å¯ä»¥æ˜¯`å…¶ä»–ä»»ä½•`åªèƒ½åœ¨è¿è¡Œæ—¶è®¡ç®—å‡ºçš„å€¼`ã€‚
- Rust å¯¹å¸¸é‡çš„`å‘½åçº¦å®š`æ˜¯åœ¨å•è¯ä¹‹é—´ä½¿ç”¨å…¨å¤§å†™åŠ ä¸‹åˆ’çº¿
  
```rust
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;
```

> åœ¨å£°æ˜å®ƒçš„ä½œç”¨åŸŸä¹‹ä¸­ï¼Œå¸¸é‡åœ¨æ•´ä¸ªç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­éƒ½æœ‰æ•ˆï¼Œæ­¤å±æ€§ä½¿å¾—å¸¸é‡å¯ä»¥ä½œä¸ºå¤šå¤„ä»£ç ä½¿ç”¨çš„å…¨å±€èŒƒå›´çš„å€¼ï¼Œä¾‹å¦‚ä¸€ä¸ªæ¸¸æˆä¸­æ‰€æœ‰ç©å®¶å¯ä»¥è·å–çš„æœ€é«˜åˆ†æˆ–è€…å…‰é€Ÿã€‚
>
> å°†éå¸ƒäºåº”ç”¨ç¨‹åºä¸­çš„ç¡¬ç¼–ç å€¼å£°æ˜ä¸ºå¸¸é‡ï¼Œèƒ½å¸®åŠ©åæ¥çš„ä»£ç ç»´æŠ¤äººå‘˜äº†è§£å€¼çš„æ„å›¾ã€‚å¦‚æœå°†æ¥éœ€è¦ä¿®æ”¹ç¡¬ç¼–ç å€¼ï¼Œä¹Ÿåªéœ€ä¿®æ”¹æ±‡èšäºä¸€å¤„çš„ç¡¬ç¼–ç å€¼ã€‚

### éšè—
æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªä¸ä¹‹å‰å˜é‡åŒåçš„æ–°å˜é‡ã€‚å®é™…ä¸Šï¼Œç¬¬äºŒä¸ªå˜é‡â€œé®è”½â€äº†ç¬¬ä¸€ä¸ªå˜é‡ï¼Œ æ­¤æ—¶ä»»ä½•ä½¿ç”¨è¯¥å˜é‡åçš„è¡Œä¸ºï¼Œç¼–è¯‘å™¨å°†å…¶è§†ä¸ºæ˜¯åœ¨ä½¿ç”¨ç¬¬äºŒä¸ªå˜é‡ï¼Œç›´åˆ°ç¬¬äºŒä¸ªå˜é‡è‡ªå·±ä¹Ÿè¢«éšè—æˆ–ç¬¬äºŒä¸ªå˜é‡çš„ä½œç”¨åŸŸç»“æŸã€‚

å¯ä»¥ç”¨ç›¸åŒå˜é‡åç§°æ¥éšè—ä¸€ä¸ªå˜é‡ï¼Œä»¥åŠ`é‡å¤ä½¿ç”¨ let å…³é”®å­—æ¥å¤šæ¬¡éšè—`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
```rust
fn main() {
    let x = 5;

    let x = x + 1;

    {
        let x = x * 2;
        println!("The value of x in the inner scope is: {x}");
    }

    println!("The value of x is: {x}");
}

// The value of x in the inner scope is: 12
// The value of x is: 6
```

`éšè—`ä¸å°†å˜é‡æ ‡è®°ä¸º `mut` æ˜¯æœ‰åŒºåˆ«çš„: 
- å½“ä¸å°å¿ƒå°è¯•å¯¹å˜é‡é‡æ–°èµ‹å€¼æ—¶ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ `let` å…³é”®å­—ï¼Œå°±ä¼šå¯¼è‡´ç¼–è¯‘æ—¶é”™è¯¯ã€‚
- é€šè¿‡ä½¿ç”¨ `let` ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªå€¼è¿›è¡Œä¸€äº›è®¡ç®—ï¼Œä¸è¿‡è®¡ç®—å®Œä¹‹åå˜é‡ä»ç„¶æ˜¯`ä¸å¯å˜`çš„ã€‚
- å½“å†æ¬¡ä½¿ç”¨ `let` æ—¶ï¼Œå®é™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ª`æ–°å˜é‡`ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜å€¼çš„`ç±»å‹`ï¼Œå¹¶ä¸”å¤ç”¨è¿™ä¸ªåå­—ã€‚
    ```rust
        let spaces = "   "; // å­—ç¬¦ä¸²ç±»å‹
        let spaces = spaces.len(); // æ•°å­—ç±»å‹
    ```


## 3.2 æ•°æ®ç±»å‹

Rust æ˜¯ `é™æ€ç±»å‹ï¼ˆstatically typedï¼‰`è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨`ç¼–è¯‘æ—¶`å°±å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚

æ ¹æ®å€¼åŠå…¶ä½¿ç”¨æ–¹å¼ï¼Œç¼–è¯‘å™¨é€šå¸¸å¯ä»¥`æ¨æ–­`å‡ºæˆ‘ä»¬æƒ³è¦ç”¨çš„ç±»å‹ã€‚
å½“å¤šç§ç±»å‹å‡æœ‰å¯èƒ½æ—¶ï¼Œå¿…é¡»å¢åŠ `ç±»å‹æ³¨è§£`:
```rust
let guess: u32 = "42".parse().expect("Not a number!"); // ç±»å‹æ³¨è§£ : u32
```
> ç¼ºä¹ç±»å‹æ³¨è§£æŠ¥é”™
> error[E0282]: type annotations needed 


### æ ‡é‡ç±»å‹

`æ ‡é‡ï¼ˆscalarï¼‰`ç±»å‹ä»£è¡¨ä¸€ä¸ªå•ç‹¬çš„å€¼ã€‚Rust æœ‰å››ç§åŸºæœ¬çš„æ ‡é‡ç±»å‹ï¼š
- æ•´å‹
- æµ®ç‚¹å‹
- å¸ƒå°”ç±»å‹
- å­—ç¬¦ç±»å‹

#### æ•°å€¼è¿ç®—
```rust
fn main() {
    // addition
    let sum = 5 + 10;

    // subtraction
    let difference = 95.5 - 4.3;

    // multiplication
    let product = 4 * 30;

    // division
    let quotient = 56.7 / 32.2;
    let truncated = -5 / 3; // ç»“æœä¸º -1

    // remainder
    let remainder = 43 % 5;
}
```
> `æ•´æ•°é™¤æ³•`ä¼šå‘`é›¶èˆå…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°`ã€‚


#### å­—ç¬¦ç±»å‹
Rust çš„ `char` ç±»å‹æ˜¯è¯­è¨€ä¸­æœ€åŸç”Ÿçš„å­—æ¯ç±»å‹
```rust
fn main() {
    let c = 'z';
    let z: char = 'â„¤'; // with explicit type annotation
    let heart_eyed_cat = 'ğŸ˜»';
}
```
- ç”¨å•å¼•å·å£°æ˜ `char` å­—é¢é‡. `char` ç±»å‹çš„å¤§å°ä¸ºå››ä¸ªå­—èŠ‚ (four bytes)
- ä½¿ç”¨åŒå¼•å·å£°æ˜ `å­—ç¬¦ä¸²å­—é¢é‡(String Literals)`ï¼Œ å…¶æ•°æ®ç±»å‹ä¸º`&str`

### å¤åˆç±»å‹
`å¤åˆç±»å‹ï¼ˆCompound typesï¼‰`å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚Rust æœ‰`ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹`ï¼š
- å…ƒç»„ï¼ˆtupleï¼‰
- æ•°ç»„ï¼ˆarrayï¼‰

#### å…ƒç»„ç±»å‹

å…ƒç»„æ˜¯ä¸€ä¸ªå°†å¤šä¸ªå…¶ä»–ç±»å‹çš„å€¼ç»„åˆè¿›ä¸€ä¸ªå¤åˆç±»å‹çš„ä¸»è¦æ–¹å¼ã€‚

å…ƒç»„`é•¿åº¦å›ºå®š`ï¼šä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦ä¸ä¼šå¢å¤§æˆ–ç¼©å°ã€‚

```rust
fn main() {
    let tup = (500, 6.4, 1);
    // let tup: (i32, f64, u8) = (500, 6.4, 1);

    let (x, y, z) = tup; // æ¨¡å¼åŒ¹é…ï¼ˆpattern matchingï¼‰æ¥è§£æ„ï¼ˆdestructureï¼‰å…ƒç»„å€¼

    println!("The value of y is: {y}");

    // æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç‚¹å·ï¼ˆ.ï¼‰åè·Ÿå€¼çš„ç´¢å¼•æ¥ç›´æ¥è®¿é—®å®ƒä»¬ã€‚
    let five_hundred = x.0;

    let six_point_four = x.1;

    let one = x.2;
}
```
è®¿é—®å…ƒç»„å…ƒç´ ï¼š
- æ¨¡å¼åŒ¹é…ï¼ˆpattern matchingï¼‰æ¥è§£æ„ï¼ˆdestructureï¼‰å…ƒç»„å€¼
- ä½¿ç”¨`ç‚¹å·ï¼ˆ.ï¼‰`åè·Ÿå€¼çš„ç´¢å¼•æ¥ç›´æ¥è®¿é—®å®ƒä»¬ã€‚

#### æ•°ç»„ç±»å‹

å¦ä¸€ä¸ªåŒ…å«å¤šä¸ªå€¼çš„æ–¹å¼æ˜¯ æ•°ç»„ï¼ˆarrayï¼‰: 
- æ•°ç»„ä¸­çš„`æ¯ä¸ªå…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒ`ã€‚
- æ•°ç»„`é•¿åº¦æ˜¯å›ºå®š`çš„ã€‚

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];

    // åœ¨æ–¹æ‹¬å·ä¸­åŒ…å«æ¯ä¸ªå…ƒç´ çš„ç±»å‹ï¼Œåè·Ÿåˆ†å·ï¼Œå†åè·Ÿæ•°ç»„å…ƒç´ çš„æ•°é‡
    let a: [i32; 5] = [1, 2, 3, 4, 5];

    // åœ¨æ–¹æ‹¬å·ä¸­æŒ‡å®šåˆå§‹å€¼åŠ åˆ†å·å†åŠ å…ƒç´ ä¸ªæ•°çš„æ–¹å¼æ¥åˆ›å»ºä¸€ä¸ªæ¯ä¸ªå…ƒç´ éƒ½ä¸ºç›¸åŒå€¼çš„æ•°ç»„
    // let a = [3, 3, 3, 3, 3]; æ•ˆæœç›¸åŒ
    let a = [3; 5];

}

```

#### è®¿é—®æ•°ç»„å…ƒç´ 
```rust
fn main() {
    let a = [1, 2, 3, 4, 5];

    // ç´¢å¼•è®¿é—®
    let first = a[0];
    let second = a[1];
}
```
> è®¿é—®è¶Šç•Œ: å¦‚æœæˆ‘ä»¬è®¿é—®æ•°ç»„ç»“å°¾ä¹‹åçš„å…ƒç´ æ—¶ï¼Œå¯¼è‡´ `è¿è¡Œæ—¶ é”™è¯¯(panic)`ã€‚ç¨‹åºå¸¦ç€é”™è¯¯ä¿¡æ¯é€€å‡º


## 3.2 å‡½æ•°

å‡½æ•°æ‹¥æœ‰ `å‚æ•°ï¼ˆparametersï¼‰ï¼ˆå½¢å‚ï¼‰`çš„å‡½æ•°ï¼Œå‚æ•°æ˜¯ç‰¹æ®Šå˜é‡ï¼Œæ˜¯å‡½æ•°ç­¾åçš„ä¸€éƒ¨åˆ†
ä¸ºè¿™äº›å‚æ•°æä¾›å…·ä½“çš„`å€¼ï¼ˆå®å‚ï¼‰`ã€‚æŠ€æœ¯ä¸Šè®²ï¼Œè¿™äº›å…·ä½“å€¼è¢«ç§°ä¸ºå‚æ•°ï¼ˆargumentsï¼‰ï¼Œ


åœ¨å‡½æ•°ç­¾åä¸­ï¼Œ`å¿…é¡»å£°æ˜æ¯ä¸ªå‚æ•°çš„ç±»å‹`ã€‚è¿™æ˜¯ Rust è®¾è®¡ä¸­ä¸€ä¸ªç»è¿‡æ…é‡è€ƒè™‘çš„å†³å®šï¼šè¦æ±‚åœ¨å‡½æ•°å®šä¹‰ä¸­æä¾›ç±»å‹æ³¨è§£ï¼Œæ„å‘³ç€ç¼–è¯‘å™¨å†ä¹Ÿä¸éœ€è¦ä½ åœ¨ä»£ç çš„å…¶ä»–åœ°æ–¹æ³¨æ˜ç±»å‹æ¥æŒ‡å‡ºä½ çš„æ„å›¾ã€‚

### 

`è¯­å¥ï¼ˆStatementsï¼‰`æ˜¯æ‰§è¡Œä¸€äº›æ“ä½œä½†ä¸è¿”å›å€¼çš„æŒ‡ä»¤:
- `let y = 6;` æ˜¯ä¸€ä¸ªè¯­å¥ã€‚
- `è¯­å¥`ä¸è¿”å›å€¼ã€‚å› æ­¤ï¼Œä¸èƒ½æŠŠ let è¯­å¥èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡

`è¡¨è¾¾å¼ï¼ˆExpressionsï¼‰`è®¡ç®—å¹¶äº§ç”Ÿä¸€ä¸ªå€¼:
- è¯­å¥ `let y = 6; `ä¸­çš„ `6` æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼
- ç”¨å¤§æ‹¬å·åˆ›å»ºçš„ä¸€ä¸ªæ–°çš„å—ä½œç”¨åŸŸä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š
   ```rust
   let y = {
        let x = 3;

        // æ³¨æ„ x+1 è¿™ä¸€è¡Œåœ¨ç»“å°¾æ²¡æœ‰åˆ†å·ï¼Œä¸ä½ è§è¿‡çš„å¤§éƒ¨åˆ†ä»£ç è¡Œä¸åŒã€‚
        // å¦‚æœåœ¨è¡¨è¾¾å¼çš„ç»“å°¾åŠ ä¸Šåˆ†å·ï¼Œå®ƒå°±å˜æˆäº†è¯­å¥ï¼Œè€Œè¯­å¥ä¸ä¼šè¿”å›å€¼
        x + 1 
    };
   ```
   yçš„å€¼æ˜¯ 4



### å…·æœ‰è¿”å›å€¼çš„å‡½æ•°

åœ¨ Rust ä¸­ï¼Œå‡½æ•°çš„è¿”å›å€¼ç­‰åŒäºå‡½æ•°ä½“`æœ€åä¸€ä¸ªè¡¨è¾¾å¼`çš„å€¼ã€‚
```rust
fn five() -> i32 {
    5
}
```

ä½¿ç”¨ `return` å…³é”®å­—å’ŒæŒ‡å®šå€¼ï¼Œå¯ä»å‡½æ•°ä¸­æå‰è¿”å›

> ç”¨æœ€åä¸€ä¸ªè¡¨è¾¾å¼è¿”å›å€¼æ—¶ä¸è¦åŠ `åˆ†å·`


## 3.4 æ³¨é‡Š

ç”¨åŒæ–œæ ` // `æ³¨é‡Š Rust ä»£ç 

æ–‡æ¡£æ³¨é‡Šä½¿ç”¨ä¸‰æ–œæ  `///` è€Œä»¥æ”¯æŒ Markdown æ³¨è§£æ¥æ ¼å¼åŒ–æ–‡æœ¬ã€‚
```rust 
/// Adds one to the number given.
///
/// # Examples
///
/// ```
/// let arg = 5;
/// let answer = my_crate::add_one(arg);
///
/// assert_eq!(6, answer);
/// ```
pub fn add_one(x: i32) -> i32 {
    x + 1
}
```


## 3.5 æ§åˆ¶æµ

### if

```rust
fn main() {
    let number = 3;

    if number < 5 {
        println!("condition was true");
    } else {
        println!("condition was false");
    }
}
```
> ä¸åƒ Ruby æˆ– JavaScript è¿™æ ·çš„è¯­è¨€ï¼ŒRust å¹¶ä¸ä¼šå°è¯•è‡ªåŠ¨åœ°å°†éå¸ƒå°”å€¼è½¬æ¢ä¸ºå¸ƒå°”å€¼ã€‚å¿…é¡»æ€»æ˜¯`æ˜¾å¼åœ°ä½¿ç”¨å¸ƒå°”å€¼`ä½œä¸º if çš„æ¡ä»¶ã€‚


### else if
```rust
fn main() {
    let number = 6;

    if number % 4 == 0 {
        println!("number is divisible by 4");
    } else if number % 3 == 0 {
        println!("number is divisible by 3");
    } else if number % 2 == 0 {
        println!("number is divisible by 2");
    } else {
        println!("number is not divisible by 4, 3, or 2");
    }

    // åœ¨ let è¯­å¥ä¸­ä½¿ç”¨ if
    let number = if condition { 5 } else { 6 };
}
```
> ä½¿ç”¨è¿‡å¤šçš„ else if è¡¨è¾¾å¼ä¼šä½¿ä»£ç æ˜¾å¾—æ‚ä¹±æ— ç« ï¼Œæ‰€ä»¥å¦‚æœæœ‰å¤šäºä¸€ä¸ª else if è¡¨è¾¾å¼ï¼Œæœ€å¥½é‡æ„ä»£ç ã€‚ä¸ºæ­¤ï¼Œç¬¬å…­ç« ä¼šä»‹ç»ä¸€ä¸ªå¼ºå¤§çš„ Rust åˆ†æ”¯ç»“æ„ï¼ˆbranching constructï¼‰ï¼Œå«åš `match`ã€‚


### loopã€while å’Œ for
#### loop
```rust
// loop
fn main() {
    let mut counter = 0;
    
    // èµ‹å€¼ç»™ result 
    let result = loop {
        counter += 1;

        if counter == 10 {
            // ä½¿ç”¨ break å…³é”®å­—è¿”å›å€¼ counter * 2
            break counter * 2;
        }
    };

    println!("The result is {result}");
}
```
#### å¾ªç¯æ ‡ç­¾ï¼šåœ¨å¤šä¸ªå¾ªç¯ä¹‹é—´æ¶ˆé™¤æ­§ä¹‰
å¦‚æœå­˜åœ¨åµŒå¥—å¾ªç¯ï¼Œbreak å’Œ continue åº”ç”¨äºæ­¤æ—¶`æœ€å†…å±‚çš„å¾ªç¯`ã€‚
ä½ å¯ä»¥é€‰æ‹©åœ¨ä¸€ä¸ªå¾ªç¯ä¸ŠæŒ‡å®šä¸€ä¸ª `å¾ªç¯æ ‡ç­¾ï¼ˆloop labelï¼‰`ï¼Œç„¶åå°†æ ‡ç­¾ä¸ break æˆ– continue ä¸€èµ·ä½¿ç”¨ï¼Œä½¿è¿™äº›å…³é”®å­—åº”ç”¨äºå·²æ ‡è®°çš„å¾ªç¯è€Œä¸æ˜¯æœ€å†…å±‚çš„å¾ªç¯ã€‚

```rust
// loop
fn main() {
    let mut count = 0;

    // æ ‡ç­¾ counting_up
    'counting_up: loop {
        println!("count = {count}");
        let mut remaining = 10;

        loop {
            println!("remaining = {remaining}");
            if remaining == 9 {
                break;
            }
            if count == 2 {
                break 'counting_up;
            }
            remaining -= 1;
        }

        count += 1;
    }
    println!("End count = {count}");
}
```


#### while
```rust
fn main() {
    let mut number = 3;

    while number != 0 {
        println!("{number}!");

        number -= 1;
    }

    println!("LIFTOFF!!!");
}
```


#### for
```rust
fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a {
        println!("the value is: {element}");
    }

    // ä½¿ç”¨ for å¾ªç¯æ¥å€’è®¡æ—¶
    // revï¼Œç”¨æ¥åè½¬ range
    for number in (1..4).rev() {
        println!("{number}!");
    }
    println!("LIFTOFF!!!");
}
```

# 4. Understanding Ownership
æ‰€æœ‰æƒï¼ˆç³»ç»Ÿï¼‰æ˜¯ Rust æœ€ä¸ºä¸ä¼—ä¸åŒçš„ç‰¹æ€§ï¼Œå¯¹è¯­è¨€çš„å…¶ä»–éƒ¨åˆ†æœ‰ç€æ·±åˆ»å«ä¹‰ã€‚å®ƒè®© Rust æ— éœ€åƒåœ¾å›æ”¶ï¼ˆgarbage collectorï¼‰å³å¯ä¿éšœå†…å­˜å®‰å…¨.

## 4.1 ä»€ä¹ˆæ˜¯æ‰€æœ‰æƒï¼Ÿ
> Rust åˆ™é€‰æ‹©äº†ç¬¬ä¸‰ç§æ–¹å¼ï¼šé€šè¿‡æ‰€æœ‰æƒç³»ç»Ÿç®¡ç†å†…å­˜ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ä¼šæ ¹æ®ä¸€ç³»åˆ—çš„è§„åˆ™è¿›è¡Œæ£€æŸ¥ã€‚å¦‚æœè¿åäº†ä»»ä½•è¿™äº›è§„åˆ™ï¼Œç¨‹åºéƒ½ä¸èƒ½ç¼–è¯‘ã€‚åœ¨è¿è¡Œæ—¶ï¼Œæ‰€æœ‰æƒç³»ç»Ÿçš„ä»»ä½•åŠŸèƒ½éƒ½ä¸ä¼šå‡æ…¢ç¨‹åºã€‚

åœ¨åƒ Rust è¿™æ ·çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ä¸­ï¼Œ`å€¼æ˜¯ä½äºæ ˆä¸Šè¿˜æ˜¯å †ä¸Š`åœ¨æ›´å¤§ç¨‹åº¦ä¸Šå½±å“äº†è¯­è¨€çš„è¡Œä¸ºä»¥åŠä¸ºä½•å¿…é¡»åšå‡ºè¿™æ ·çš„æŠ‰æ‹©ã€‚

æ ˆä¸­çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»å ç”¨å·²çŸ¥ä¸”å›ºå®šçš„å¤§å°ã€‚

å¤§å°æœªçŸ¥æˆ–å¤§å°å¯èƒ½å˜åŒ–çš„æ•°æ®ï¼Œè¦æ”¹ä¸ºå­˜å‚¨åœ¨å †ä¸Šã€‚ å †æ˜¯ç¼ºä¹ç»„ç»‡çš„ï¼šå½“å‘å †æ”¾å…¥æ•°æ®æ—¶ï¼Œä½ è¦è¯·æ±‚ä¸€å®šå¤§å°çš„ç©ºé—´ã€‚

å…¥æ ˆæ¯”åœ¨å †ä¸Šåˆ†é…å†…å­˜è¦å¿«ï¼Œå› ä¸ºï¼ˆå…¥æ ˆæ—¶ï¼‰åˆ†é…å™¨æ— éœ€ä¸ºå­˜å‚¨æ–°æ•°æ®å»æœç´¢å†…å­˜ç©ºé—´. å…¶ä½ç½®æ€»æ˜¯åœ¨æ ˆé¡¶

è®¿é—®å †ä¸Šçš„æ•°æ®æ¯”è®¿é—®æ ˆä¸Šçš„æ•°æ®æ…¢ï¼Œå› ä¸ºå¿…é¡»é€šè¿‡æŒ‡é’ˆæ¥è®¿é—®ã€‚ç°ä»£å¤„ç†å™¨åœ¨å†…å­˜ä¸­è·³è½¬è¶Šå°‘å°±è¶Šå¿«ï¼ˆç¼“å­˜ï¼‰ã€‚

> è·Ÿè¸ªå“ªéƒ¨åˆ†ä»£ç æ­£åœ¨ä½¿ç”¨å †ä¸Šçš„å“ªäº›æ•°æ®ï¼Œæœ€å¤§é™åº¦çš„å‡å°‘å †ä¸Šçš„é‡å¤æ•°æ®çš„æ•°é‡ï¼Œä»¥åŠæ¸…ç†å †ä¸Šä¸å†ä½¿ç”¨çš„æ•°æ®ç¡®ä¿ä¸ä¼šè€—å°½ç©ºé—´ï¼Œè¿™äº›é—®é¢˜æ­£æ˜¯æ‰€æœ‰æƒç³»ç»Ÿè¦å¤„ç†çš„ã€‚


### æ‰€æœ‰æƒè§„åˆ™
- Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ª æ‰€æœ‰è€…ï¼ˆownerï¼‰ã€‚
- å€¼åœ¨ä»»ä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚
- å½“æ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒã€‚


### å˜é‡ä½œç”¨åŸŸ
```rust
    {                      // s åœ¨è¿™é‡Œæ— æ•ˆï¼Œå®ƒå°šæœªå£°æ˜
        let s = "hello";   // ä»æ­¤å¤„èµ·ï¼Œs æ˜¯æœ‰æ•ˆçš„

        // ä½¿ç”¨ s
    }                      // æ­¤ä½œç”¨åŸŸå·²ç»“æŸï¼Œs ä¸å†æœ‰æ•ˆ
```


### æ¼”ç¤ºæ‰€æœ‰æƒçš„è§„åˆ™ - String ç±»å‹

æˆ‘ä»¬å·²ç»è§è¿‡`å­—ç¬¦ä¸²å­—é¢å€¼(String literals)`ï¼Œå³è¢«ç¡¬ç¼–ç è¿›ç¨‹åºé‡Œçš„å­—ç¬¦ä¸²å€¼ã€‚ å­—ç¬¦ä¸²å­—é¢å€¼æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œä¸è¿‡å®ƒä»¬å¹¶ä¸é€‚åˆä½¿ç”¨æ–‡æœ¬çš„æ¯ä¸€ç§åœºæ™¯ã€‚
- åŸå› ä¹‹ä¸€å°±æ˜¯`å®ƒä»¬æ˜¯ä¸å¯å˜çš„`ã€‚
- å¦ä¸€ä¸ªåŸå› æ˜¯å¹¶éæ‰€æœ‰å­—ç¬¦ä¸²çš„å€¼éƒ½èƒ½åœ¨ç¼–å†™ä»£ç æ—¶å°±çŸ¥é“ï¼šä¾‹å¦‚ï¼Œè¦æ˜¯æƒ³è·å–ç”¨æˆ·è¾“å…¥å¹¶å­˜å‚¨è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ

> ä¸ºæ­¤ï¼ŒRust æœ‰ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ç±»å‹ï¼Œ`String`ã€‚è¿™ä¸ªç±»å‹ç®¡ç†è¢«åˆ†é…åˆ°å †ä¸Šçš„æ•°æ®ï¼Œæ‰€ä»¥èƒ½å¤Ÿå­˜å‚¨åœ¨ç¼–è¯‘æ—¶æœªçŸ¥å¤§å°çš„æ–‡æœ¬ã€‚

```rust
    // ä½¿ç”¨ from å‡½æ•°åŸºäºå­—ç¬¦ä¸²å­—é¢å€¼æ¥åˆ›å»º String
    let mut s = String::from("hello");

    // String å¯ä»¥ä¿®æ”¹
    s.push_str(", world!"); // push_str() åœ¨å­—ç¬¦ä¸²åè¿½åŠ å­—é¢å€¼

    println!("{}", s); // å°†æ‰“å° `hello, world!`
```

å¯¹äº `String` ç±»å‹ï¼Œä¸ºäº†æ”¯æŒä¸€ä¸ª`å¯å˜ï¼Œå¯å¢é•¿`çš„æ–‡æœ¬ç‰‡æ®µï¼Œéœ€è¦åœ¨å †ä¸Šåˆ†é…ä¸€å—åœ¨ç¼–è¯‘æ—¶æœªçŸ¥å¤§å°çš„å†…å­˜æ¥å­˜æ”¾å†…å®¹ã€‚è¿™æ„å‘³ç€ï¼š
- å¿…é¡»åœ¨`è¿è¡Œæ—¶`å‘å†…å­˜åˆ†é…å™¨ï¼ˆmemory allocatorï¼‰è¯·æ±‚å†…å­˜ã€‚
- éœ€è¦ä¸€ä¸ªå½“æˆ‘ä»¬å¤„ç†å®Œ `String` æ—¶å°†ä¸å†ä½¿ç”¨çš„å†…å­˜è¿”è¿˜ç»™åˆ†é…å™¨çš„æ–¹æ³•ã€‚

> Rust é‡‡å–äº†ä¸€ä¸ªä¸åŒçš„ç­–ç•¥ï¼šå†…å­˜åœ¨`æ‹¥æœ‰å®ƒçš„å˜é‡ç¦»å¼€ä½œç”¨åŸŸå`å°±è¢«è‡ªåŠ¨é‡Šæ”¾ã€‚

å½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸï¼ŒRust ä¸ºæˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å«åš `drop` ï¼Œåœ¨è¿™é‡Œ String çš„ä½œè€…å¯ä»¥æ”¾ç½®é‡Šæ”¾å†…å­˜çš„ä»£ç ã€‚Rust åœ¨ç»“å°¾çš„` } `å¤„è‡ªåŠ¨è°ƒç”¨ `drop` ã€‚


### å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼ˆä¸€ï¼‰ï¼šç§»åŠ¨

```rust
    let s1 = String::from("hello");
    let s2 = s1;
```
æŒ‡é’ˆs1å’Œs2åŒæ—¶æŒ‡å‘åŒä¸€å—å†…å­˜ï¼Œæ˜¯ `æµ…æ‹·è´`ã€‚
è¿™å°±æœ‰äº†ä¸€ä¸ªé—®é¢˜ï¼šå½“ s2 å’Œ s1 ç¦»å¼€ä½œç”¨åŸŸï¼Œå®ƒä»¬éƒ½ä¼šå°è¯•é‡Šæ”¾ç›¸åŒçš„å†…å­˜ã€‚è¿™æ˜¯ä¸€ä¸ªå«åš `äºŒæ¬¡é‡Šæ”¾ï¼ˆdouble freeï¼‰`çš„é”™è¯¯ï¼Œä¹Ÿæ˜¯ä¹‹å‰æåˆ°è¿‡çš„å†…å­˜å®‰å…¨æ€§ bug ä¹‹ä¸€ã€‚ä¸¤æ¬¡é‡Šæ”¾ï¼ˆç›¸åŒï¼‰å†…å­˜ä¼šå¯¼è‡´å†…å­˜æ±¡æŸ“ï¼Œå®ƒå¯èƒ½ä¼šå¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚

ä¸ºäº†ç¡®ä¿å†…å­˜å®‰å…¨ï¼Œåœ¨ let s2 = s1; ä¹‹åï¼ŒRust `è®¤ä¸º s1 ä¸å†æœ‰æ•ˆ`ï¼Œå› æ­¤ Rust ä¸éœ€è¦åœ¨ s1 ç¦»å¼€ä½œç”¨åŸŸåæ¸…ç†ä»»ä½•ä¸œè¥¿ã€‚

å› è€Œåœ¨ s2 è¢«åˆ›å»ºä¹‹åå°è¯•ä½¿ç”¨ s1 ä¼šå‘ç”Ÿï¼š`error[E0382]: borrow of moved value: s1`

> å¦‚æœä½ åœ¨å…¶ä»–è¯­è¨€ä¸­å¬è¯´è¿‡æœ¯è¯­ `æµ…æ‹·è´ï¼ˆshallow copyï¼‰`å’Œ `æ·±æ‹·è´ï¼ˆdeep copyï¼‰`ï¼Œé‚£ä¹ˆæ‹·è´æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡è€Œä¸æ‹·è´æ•°æ®å¯èƒ½å¬èµ·æ¥åƒæµ…æ‹·è´ã€‚`ä¸è¿‡å› ä¸º Rust åŒæ—¶ä½¿ç¬¬ä¸€ä¸ªå˜é‡æ— æ•ˆäº†`ï¼Œè¿™ä¸ªæ“ä½œè¢«ç§°ä¸º `ç§»åŠ¨ï¼ˆmoveï¼‰`ï¼Œè€Œä¸æ˜¯å«åšæµ…æ‹·è´ã€‚

> è¿™é‡Œè¿˜éšå«äº†ä¸€ä¸ªè®¾è®¡é€‰æ‹©ï¼š`Rust æ°¸è¿œä¹Ÿä¸ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®çš„ â€œæ·±æ‹·è´â€`ã€‚å› æ­¤ï¼Œå¯ä»¥å‡å®šä»»ä½•è‡ªåŠ¨å¤åˆ¶åœ¨è¿è¡Œæ—¶æ€§èƒ½æ–¹é¢éƒ½æ˜¯å»‰ä»·çš„ã€‚


### å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼ˆäºŒï¼‰ï¼šå…‹éš†
å¦‚æœæˆ‘ä»¬ç¡®å®éœ€è¦ `æ·±åº¦å¤åˆ¶` String ä¸­å †ä¸Šçš„æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯æ ˆä¸Šçš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå«åš `clone` çš„é€šç”¨å‡½æ•°ã€‚
```rust
    let s1 = String::from("hello");
    let s2 = s1.clone();

    println!("s1 = {}, s2 = {}", s1, s2);
```

#### åªåœ¨æ ˆä¸Šçš„æ•°æ®ï¼šæ‹·è´
```rust
    let x = 5;
    let y = x;

    println!("x = {}, y = {}", x, y);
```

åƒ`æ•´å‹`è¿™æ ·çš„åœ¨ç¼–è¯‘æ—¶å·²çŸ¥å¤§å°çš„ç±»å‹è¢«æ•´ä¸ªå­˜å‚¨åœ¨æ ˆä¸Šï¼Œæ‰€ä»¥æ‹·è´å…¶å®é™…çš„å€¼æ˜¯å¿«é€Ÿçš„ã€‚è¿™æ„å‘³ç€æ²¡æœ‰ç†ç”±åœ¨åˆ›å»ºå˜é‡ y åä½¿ x æ— æ•ˆã€‚


#### Trait: Copy
Rust æœ‰ä¸€ä¸ªå«åš `Copy` trait çš„ç‰¹æ®Šæ³¨è§£ï¼Œå¯ä»¥ç”¨åœ¨ç±»ä¼¼æ•´å‹è¿™æ ·çš„`å­˜å‚¨åœ¨æ ˆä¸Šçš„ç±»å‹`ä¸Š.
å¦‚æœä¸€ä¸ªç±»å‹å®ç°äº† `Copy` traitï¼Œé‚£ä¹ˆä¸€ä¸ªæ—§çš„å˜é‡åœ¨å°†å…¶èµ‹å€¼ç»™å…¶ä»–å˜é‡åä»ç„¶å¯ç”¨ã€‚
Rust ä¸å…è®¸è‡ªèº«æˆ–å…¶ä»»ä½•éƒ¨åˆ†å®ç°äº† `Drop` trait çš„ç±»å‹ä½¿ç”¨ `Copy` traitã€‚

ä½œä¸ºä¸€ä¸ªé€šç”¨çš„è§„åˆ™ï¼Œä»»ä½•ä¸€ç»„`ç®€å•æ ‡é‡å€¼çš„ç»„åˆ`éƒ½å¯ä»¥å®ç° `Copy` ï¼Œ
ä»»ä½•`ä¸éœ€è¦åˆ†é…å†…å­˜æˆ–æŸç§å½¢å¼èµ„æºçš„ç±»å‹`éƒ½å¯ä»¥å®ç° `Copy` ã€‚


#### æ‰€æœ‰æƒä¸å‡½æ•°

å°†å€¼ä¼ é€’ç»™å‡½æ•°ä¸ç»™å˜é‡èµ‹å€¼çš„åŸç†ç›¸ä¼¼ã€‚
```rust
fn main() {
    let s = String::from("hello");  // s è¿›å…¥ä½œç”¨åŸŸ

    takes_ownership(s);             // s çš„å€¼ç§»åŠ¨åˆ°å‡½æ•°é‡Œ ...
                                    // ... æ‰€ä»¥åˆ°è¿™é‡Œä¸å†æœ‰æ•ˆ

    let x = 5;                      // x è¿›å…¥ä½œç”¨åŸŸ

    makes_copy(x);                  // x åº”è¯¥ç§»åŠ¨å‡½æ•°é‡Œï¼Œ
                                    // ä½† i32 æ˜¯ Copy çš„ï¼Œ
                                    // æ‰€ä»¥åœ¨åé¢å¯ç»§ç»­ä½¿ç”¨ x

} // è¿™é‡Œï¼Œx å…ˆç§»å‡ºäº†ä½œç”¨åŸŸï¼Œç„¶åæ˜¯ sã€‚ä½†å› ä¸º s çš„å€¼å·²è¢«ç§»èµ°ï¼Œ
  // æ²¡æœ‰ç‰¹æ®Šä¹‹å¤„

fn takes_ownership(some_string: String) { // some_string è¿›å…¥ä½œç”¨åŸŸ
    println!("{}", some_string);
} // è¿™é‡Œï¼Œsome_string ç§»å‡ºä½œç”¨åŸŸå¹¶è°ƒç”¨ `drop` æ–¹æ³•ã€‚
  // å ç”¨çš„å†…å­˜è¢«é‡Šæ”¾

fn makes_copy(some_integer: i32) { // some_integer è¿›å…¥ä½œç”¨åŸŸ
    println!("{}", some_integer);
} // è¿™é‡Œï¼Œsome_integer ç§»å‡ºä½œç”¨åŸŸã€‚æ²¡æœ‰ç‰¹æ®Šä¹‹å¤„
```

å½“å°è¯•åœ¨è°ƒç”¨ `takes_ownership` åä½¿ç”¨ `s` æ—¶ï¼ŒRust ä¼šæŠ›å‡ºä¸€ä¸ªç¼–è¯‘æ—¶é”™è¯¯ã€‚


#### è¿”å›å€¼ä¸ä½œç”¨åŸŸ

> è¿”å›å€¼ä¹Ÿå¯ä»¥è½¬ç§»æ‰€æœ‰æƒã€‚å˜é‡çš„æ‰€æœ‰æƒæ€»æ˜¯éµå¾ªç›¸åŒçš„æ¨¡å¼ï¼šå°†å€¼èµ‹ç»™å¦ä¸€ä¸ªå˜é‡æ—¶ç§»åŠ¨å®ƒã€‚å½“æŒæœ‰å †ä¸­æ•°æ®å€¼çš„å˜é‡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œå…¶å€¼å°†é€šè¿‡ drop è¢«æ¸…ç†æ‰ï¼Œé™¤éæ•°æ®è¢«ç§»åŠ¨ä¸ºå¦ä¸€ä¸ªå˜é‡æ‰€æœ‰ã€‚

```rust
fn main() {
    let s1 = gives_ownership();         // gives_ownership å°†è¿”å›å€¼
                                        // è½¬ç§»ç»™ s1

    let s2 = String::from("hello");     // s2 è¿›å…¥ä½œç”¨åŸŸ

    let s3 = takes_and_gives_back(s2);  // s2 è¢«ç§»åŠ¨åˆ°takes_and_gives_back ä¸­, å®ƒä¹Ÿå°†è¿”å›å€¼ç§»ç»™ s3                                 
    // takes_and_gives_backè¿”å›ås2å³è¢«drop


} // è¿™é‡Œï¼Œs3ï¼Œs1ç§»å‡ºä½œç”¨åŸŸå¹¶è¢«ä¸¢å¼ƒã€‚

fn gives_ownership() -> String {

    let some_string = String::from("yours");
    some_string
}

fn takes_and_gives_back(a_string: String) -> String {
    a_string
}
```

åœ¨æ¯ä¸€ä¸ªå‡½æ•°ä¸­éƒ½è·å–æ‰€æœ‰æƒå¹¶æ¥ç€è¿”å›æ‰€æœ‰æƒæœ‰äº›å•°å—¦ã€‚
å¦‚æœæˆ‘ä»¬æƒ³è¦å‡½æ•°ä½¿ç”¨ä¸€ä¸ªå€¼ä½†ä¸è·å–æ‰€æœ‰æƒè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬è¿˜è¦æ¥ç€ä½¿ç”¨å®ƒçš„è¯ï¼Œæ¯æ¬¡éƒ½ä¼ è¿›å»å†è¿”å›æ¥å°±æœ‰ç‚¹çƒ¦äººäº†.
-> Rust å¯¹æ­¤æä¾›äº†ä¸€ä¸ªä¸ç”¨è·å–æ‰€æœ‰æƒå°±å¯ä»¥ä½¿ç”¨å€¼çš„åŠŸèƒ½ï¼Œå«åš `å¼•ç”¨ï¼ˆreferencesï¼‰`

é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯èƒ½æƒ³è¿”å›å‡½æ•°ä½“ä¸­äº§ç”Ÿçš„ä¸€äº›æ•°æ®ã€‚
-> æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`å…ƒç»„`æ¥è¿”å›å¤šä¸ªå€¼


## 4.2 å¼•ç”¨ä¸å€Ÿç”¨
```rust
fn main() {
    let s1 = String::from("hello");

    let len = calculate_length(&s1);

    // calculate_lengthå®Œæˆåå¹¶ä¸ä¼šdrop s1
    println!("The length of '{}' is {}.", s1, len);
}

// s æ˜¯ String çš„å¼•ç”¨
fn calculate_length(s: &String) -> usize {
    s.len()
}
// å½“ s åœæ­¢ä½¿ç”¨æ—¶å¹¶ä¸ä¸¢å¼ƒå¼•ç”¨æŒ‡å‘çš„æ•°æ®ï¼Œå› ä¸º s å¹¶æ²¡æœ‰æ‰€æœ‰æƒã€‚
```

`&s1 `è¯­æ³•è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª `æŒ‡å‘ å€¼ s1 `çš„å¼•ç”¨ï¼Œä½†æ˜¯å¹¶ä¸æ‹¥æœ‰å®ƒã€‚
å› ä¸ºå¹¶ä¸æ‹¥æœ‰è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥å½“å¼•ç”¨åœæ­¢ä½¿ç”¨æ—¶ï¼Œå®ƒæ‰€æŒ‡å‘çš„å€¼ä¹Ÿä¸ä¼šè¢«ä¸¢å¼ƒã€‚

#### å°è¯•ä¿®æ”¹å€Ÿç”¨çš„å˜é‡
```rust
fn main() {
    let s = String::from("hello");

    change(&s);
}

fn change(some_string: &String) {
    some_string.push_str(", world");
}
```
> è¯•å›¾ä¿®æ”¹å¼•ç”¨çš„å‚æ•°ä¼šæŠ¥é”™ï¼šerror[E0596]: cannot borrow `*some_string` as mutable, as it is behind a `&` reference

### å¯å˜å¼•ç”¨
é€šè¿‡ä¸€ä¸ªå°è°ƒæ•´å°±èƒ½å…è®¸æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸ªå€Ÿç”¨çš„å€¼,`å¯å˜å¼•ç”¨ï¼ˆmutable referenceï¼‰`ï¼š
- æˆ‘ä»¬å¿…é¡»å°† `s` æ”¹ä¸º `mut`ã€‚
- ç„¶ååœ¨è°ƒç”¨ change å‡½æ•°çš„åœ°æ–¹åˆ›å»ºä¸€ä¸ªå¯å˜å¼•ç”¨ `&mut s`
- å¹¶æ›´æ–°å‡½æ•°ç­¾åä»¥æ¥å—ä¸€ä¸ªå¯å˜å¼•ç”¨ `some_string: &mut String`

```rust
fn main() {
    let mut s = String::from("hello");

    change(&mut s);
}

fn change(some_string: &mut String) {
    some_string.push_str(", world");
}
```
å¯å˜å¼•ç”¨æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é™åˆ¶ï¼š
- å¦‚æœä½ æœ‰ä¸€ä¸ªå¯¹è¯¥å˜é‡çš„å¯å˜å¼•ç”¨ï¼Œåœ¨è¿™ä¸ªå¯å˜å¼•ç”¨ä¸å†ä½¿ç”¨å‰ï¼Œä½ ä¸èƒ½å†åˆ›å»ºå¦ä¸€ä¸ªå¯å˜å¼•ç”¨ã€‚
- æˆ‘ä»¬ ä¹Ÿ ä¸èƒ½åœ¨æ‹¥æœ‰ä¸å¯å˜å¼•ç”¨çš„åŒæ—¶æ‹¥æœ‰å¯å˜å¼•ç”¨ã€‚
> å°è¯•åˆ›å»ºä¸¤ä¸ª s çš„å¯å˜å¼•ç”¨çš„ä»£ç ä¼šå¤±è´¥: error[E0499]: cannot borrow `s` as mutable more than once at a time

è¿™ä¸€é™åˆ¶ä»¥ä¸€ç§éå¸¸å°å¿ƒè°¨æ…çš„æ–¹å¼å…è®¸å¯å˜æ€§ï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¯¹åŒä¸€æ•°æ®å­˜åœ¨å¤šä¸ªå¯å˜å¼•ç”¨ã€‚
è¿™ä¸ªé™åˆ¶çš„å¥½å¤„æ˜¯ Rust å¯ä»¥åœ¨ç¼–è¯‘æ—¶å°±é¿å…`æ•°æ®ç«äº‰`ã€‚

> æ³¨æ„ä¸€ä¸ªå¼•ç”¨çš„ä½œç”¨åŸŸä»å£°æ˜çš„åœ°æ–¹å¼€å§‹ä¸€ç›´`æŒç»­åˆ°æœ€åä¸€æ¬¡ä½¿ç”¨ä¸ºæ­¢`ã€‚



### æ‚¬å‚å¼•ç”¨ï¼ˆDangling Referencesï¼‰
åœ¨å…·æœ‰æŒ‡é’ˆçš„è¯­è¨€ä¸­ï¼Œå¾ˆå®¹æ˜“é€šè¿‡é‡Šæ”¾å†…å­˜æ—¶ä¿ç•™æŒ‡å‘å®ƒçš„æŒ‡é’ˆè€Œé”™è¯¯åœ°ç”Ÿæˆä¸€ä¸ª `æ‚¬å‚æŒ‡é’ˆï¼ˆdangling pointerï¼‰`ï¼Œæ‰€è°“æ‚¬å‚æŒ‡é’ˆæ˜¯`å…¶æŒ‡å‘çš„å†…å­˜å¯èƒ½å·²ç»è¢«åˆ†é…ç»™å…¶å®ƒæŒæœ‰è€…`ã€‚

> ä¸‹è¿°ä»£ç ä¼šæŠ¥é”™ï¼šerror[E0106]: missing lifetime specifier

```rust
fn main() {
    let reference_to_nothing = dangle();
}


// è¿”å›ä¸€ä¸ªStringçš„å¼•ç”¨
fn dangle() -> &String {
    let s = String::from("hello");

    &s
    // é¢„æœŸè¿”å›sçš„å¼•ç”¨ï¼Œä½†æ³¨æ„æ­¤å‡½æ•°å®Œæˆåsæœ¬èº«ä¼šè¢«dropï¼Œå› è€Œè¿”å›çš„å¼•ç”¨æŒ‡å‘null
}
```


## 4.3 Slice ç±»å‹

`slice` å…è®¸ä½ å¼•ç”¨é›†åˆä¸­ä¸€æ®µè¿ç»­çš„å…ƒç´ åºåˆ—ï¼Œè€Œä¸ç”¨å¼•ç”¨æ•´ä¸ªé›†åˆã€‚
`slice` æ˜¯å¼•ç”¨ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰æ‰€æœ‰æƒã€‚

> usize æ˜¯ Rust ç¼–ç¨‹è¯­è¨€ä¸­çš„ä¸€ç§æ•´æ•°ç±»å‹ï¼Œå®ƒä»£è¡¨æ— ç¬¦å·æ•´æ•°ã€‚
> å®ƒçš„å¤§å°å–å†³äºè¿è¡Œ Rust ä»£ç çš„è®¡ç®—æœºæ¶æ„ï¼Œé€šå¸¸æ˜¯ä¸è®¡ç®—æœºçš„æŒ‡é’ˆå¤§å°ç›¸åŒã€‚åœ¨ 32 ä½è®¡ç®—æœºä¸Šï¼Œusize æ˜¯ 32 ä½æ— ç¬¦å·æ•´æ•°ï¼Œè€Œåœ¨ 64 ä½è®¡ç®—æœºä¸Šï¼Œusize æ˜¯ 64 ä½æ— ç¬¦å·æ•´æ•°ã€‚


#### '' å’Œ b''
æ³¨æ„ï¼š' ' æ˜¯ Rust ä¸­çš„ char å­—é¢å€¼ï¼Œå®ƒå¯ä»¥åŒ…å«å•ä¸ªå­—ç¬¦ï¼Œ
è€Œ b' ' æ˜¯å­—èŠ‚å­—é¢å€¼ï¼ŒåªåŒ…å«ä¸€ä¸ªå­—èŠ‚ã€‚
åœ¨ Rust ä¸­ï¼Œå­—ç¬¦å­—é¢å€¼é€šå¸¸ç”¨äºè¡¨ç¤ºæ–‡æœ¬å­—ç¬¦ï¼Œè€Œå­—èŠ‚å­—é¢å€¼ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚


#### &str å’Œ String 
`&strï¼š` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œå®ƒæ˜¯ä¸€ä¸ª`ä¸å¯å˜å¼•ç”¨ï¼ˆimmutable referenceï¼‰`ï¼Œé€šå¸¸ç”¨äºå¼•ç”¨å­—ç¬¦ä¸²æ–‡æœ¬çš„ä¸€éƒ¨åˆ†ï¼Œä¾‹å¦‚ä»ä¸€ä¸ª String æˆ–å­—ç¬¦ä¸²å­—é¢å€¼ä¸­æå–çš„å­ä¸²ã€‚ç”±äº str æ˜¯ä¸å¯å˜çš„ï¼Œä½ ä¸èƒ½å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚str ç±»å‹é€šå¸¸ç”¨äºå‚æ•°ä¼ é€’å’Œå­—ç¬¦ä¸²å¤„ç†çš„å¼•ç”¨å½¢å¼ã€‚

`Stringï¼š`æ˜¯ Rust çš„æ ‡å‡†åº“ä¸­æä¾›çš„å¯å˜çš„ã€æ‹¥æœ‰ï¼ˆownedï¼‰çš„å­—ç¬¦ä¸²ç±»å‹ã€‚å®ƒæ˜¯ä¸€ä¸ªå †åˆ†é…çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥éšæ—¶è¿›è¡Œå¢åŠ ã€åˆ é™¤å’Œä¿®æ”¹æ“ä½œã€‚String é€šå¸¸ç”¨äºéœ€è¦åŠ¨æ€åˆ†é…å’Œä¿®æ”¹å­—ç¬¦ä¸²å†…å®¹çš„æƒ…å†µã€‚

> å½“ç¼–å†™å‡½æ•°çš„å…¥å‚ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œæœ€å¥½è®©å…¶ç±»å‹ä¸º`&str`ï¼Œå¦‚æœæœ‰ä¸€ä¸ª Stringï¼Œåˆ™å¯ä»¥ä¼ é€’æ•´ä¸ª String çš„ slice æˆ–å¯¹ String çš„å¼•ç”¨ã€‚
> å®šä¹‰ä¸€ä¸ªè·å– `&str` è€Œä¸æ˜¯ String å¼•ç”¨çš„å‡½æ•°ä½¿å¾—æˆ‘ä»¬çš„ API æ›´åŠ é€šç”¨å¹¶ä¸”ä¸ä¼šä¸¢å¤±ä»»ä½•åŠŸèƒ½ï¼š


### å…¶ä»–ç±»å‹çš„ slice
```rust
let a = [1, 2, 3, 4, 5];

let slice = &a[1..3]; // data type of slice: &[i32]

assert_eq!(slice, &[2, 3]);
```


# 5. `Structs` to Structure Related Data
structæˆ–structureæ˜¯ä¸€ç§è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œå…è®¸æ‚¨å°†å¤šä¸ªç›¸å…³çš„å€¼æ‰“åŒ…åœ¨ä¸€èµ·å¹¶å‘½åï¼Œè¿™äº›å€¼ç»„æˆä¸€ä¸ªæœ‰æ„ä¹‰çš„ç»„ã€‚
å¦‚æœæ‚¨ç†Ÿæ‚‰é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œ `struct` å°±åƒå¯¹è±¡çš„æ•°æ®å±æ€§ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¯”è¾ƒå’Œå¯¹æ¯” `tuple` å’Œ `struct` ï¼Œä»¥å»ºç«‹åœ¨æ‚¨å·²ç»çŸ¥é“çš„åŸºç¡€ä¸Šï¼Œå¹¶æ¼”ç¤º `struct` æ˜¯åˆ†ç»„æ•°æ®çš„æ›´å¥½æ–¹æ³•ã€‚

æˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•å®šä¹‰å’Œå®ä¾‹åŒ– `struct` ã€‚æˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•å®šä¹‰å…³è”å‡½æ•°ï¼Œç‰¹åˆ«æ˜¯ç§°ä¸ºæ–¹æ³•çš„å…³è”å‡½æ•°ï¼Œä»¥æŒ‡å®šä¸ `struct` ç±»å‹å…³è”çš„è¡Œä¸ºã€‚ `Structs` å’Œ `Enum` (åœ¨ç¬¬6ç« ä¸­è®¨è®º)æ˜¯åœ¨ç¨‹åºåŸŸä¸­åˆ›å»ºæ–°ç±»å‹ä»¥å……åˆ†åˆ©ç”¨Rustçš„ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥çš„æ„å»ºå—ã€‚

## 5.1 ç»“æ„ä½“çš„å®šä¹‰å’Œå®ä¾‹åŒ–

```rust
// Def
struct User {
    active: bool,
    username: String,
    email: String,
    sign_in_count: u64,
}
```
> ç»“æ„ä½“æ•°æ®çš„æ‰€æœ‰æƒ: æˆ‘ä»¬ä½¿ç”¨äº†è‡ªèº«æ‹¥æœ‰æ‰€æœ‰æƒçš„ String ç±»å‹è€Œä¸æ˜¯ &str å­—ç¬¦ä¸² slice ç±»å‹ã€‚
> è¿™æ˜¯ä¸€ä¸ªæœ‰æ„è€Œä¸ºä¹‹çš„é€‰æ‹©ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è¦è¿™ä¸ªç»“æ„ä½“`æ‹¥æœ‰å®ƒæ‰€æœ‰çš„æ•°æ®`ï¼Œä¸ºæ­¤åªè¦æ•´ä¸ªç»“æ„ä½“æ˜¯æœ‰æ•ˆçš„è¯å…¶æ•°æ®ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚
> è¦ä½¿ç»“æ„ä½“å­˜å‚¨`è¢«å…¶ä»–å¯¹è±¡æ‹¥æœ‰çš„æ•°æ®çš„å¼•ç”¨`, éœ€è¦ç”¨ä¸Š `ç”Ÿå‘½å‘¨æœŸï¼ˆlifetimesï¼‰`

#### è®¿é—®å’Œä¿®æ”¹å±æ€§
æ³¨æ„æ•´ä¸ªå®ä¾‹å¿…é¡»æ˜¯å¯å˜çš„ï¼›Rust å¹¶ä¸å…è®¸åªå°†æŸä¸ªå­—æ®µæ ‡è®°ä¸ºå¯å˜

```rust
fn main() {
    // Initialize an instance
    let mut user1 = User {
        active: true,
        username: String::from("someusername123"),
        email: String::from("someone@example.com"),
        sign_in_count: 1,
    };

    // Access attribute with `.`
    // Modify attribute requires struct to be mutable
    user1.email = String::from("anotheremail@example.com");
}
```

#### Builder
```rust
fn build_user(email: String, username: String) -> User {
    User {
        active: true,
        username: username,
        email: email,
        sign_in_count: 1,
    }
}

// ä¸ºå‡½æ•°å‚æ•°èµ·ä¸ç»“æ„ä½“å­—æ®µç›¸åŒçš„åå­—æ˜¯å¯ä»¥ç†è§£çš„ï¼Œä½†æ˜¯ä¸å¾—ä¸é‡å¤ email å’Œ username å­—æ®µåç§°ä¸å˜é‡æœ‰äº›å•°å—¦ã€‚
// å¦‚æœç»“æ„ä½“æœ‰æ›´å¤šå­—æ®µï¼Œé‡å¤æ¯ä¸ªåç§°å°±æ›´åŠ çƒ¦äººäº†ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªæ–¹ä¾¿çš„ç®€å†™è¯­æ³•ï¼
fn build_user_compact(email: String, username: String) -> User {
    User {
        active: true,
        // ä½¿ç”¨äº†å­—æ®µåˆå§‹åŒ–ç®€å†™è¯­æ³•ï¼Œå› ä¸º username å’Œ email å‚æ•°ä¸ç»“æ„ä½“å­—æ®µåŒå
        username,
        email,
        sign_in_count: 1,
    }
}
```

### ä½¿ç”¨`ç»“æ„ä½“æ›´æ–°`è¯­æ³•ä»å…¶ä»–å®ä¾‹åˆ›å»ºå®ä¾‹

`ä½¿ç”¨æ—§å®ä¾‹çš„å¤§éƒ¨åˆ†å€¼`ä½†`æ”¹å˜å…¶éƒ¨åˆ†å€¼`æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç»“æ„ä½“å®ä¾‹é€šå¸¸æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚è¿™å¯ä»¥é€šè¿‡ `ç»“æ„ä½“æ›´æ–°è¯­æ³•ï¼ˆstruct update syntaxï¼‰`å®ç°ã€‚

é€šè¿‡ `..` è¯­æ³•æŒ‡å®šäº†å‰©ä½™æœªæ˜¾å¼è®¾ç½®å€¼çš„å­—æ®µåº”æœ‰ä¸ç»™å®šå®ä¾‹å¯¹åº”å­—æ®µç›¸åŒçš„å€¼ã€‚

```rust
fn main() {
    let user2 = User {
        // ä½¿ç”¨user1å®ä¾‹çš„å±æ€§
        active: user1.active,
        username: user1.username,
        email: String::from("another@example.com"),
        sign_in_count: user1.sign_in_count,    
    };
}

// `..` è¯­æ³•è¿›ä¸€æ­¥å‡çœ
    let user2 = User {
        email: String::from("another@example.com"),
        ..user1
        // ..user1 å¿…é¡»æ”¾åœ¨æœ€å
    };

```
> è¯·æ³¨æ„ï¼Œ`ç»“æ„æ›´æ–°è¯­æ³•`å°±åƒå¸¦æœ‰ = çš„èµ‹å€¼ï¼Œå› ä¸ºå®ƒ`ç§»åŠ¨`äº†æ•°æ®
> æ€»ä½“ä¸Šè¯´æˆ‘ä»¬åœ¨åˆ›å»º user2 åä¸èƒ½å°±å†ä½¿ç”¨ user1 äº†ï¼Œå› ä¸º user1 çš„ username å­—æ®µä¸­çš„ String è¢«ç§»åˆ° user2 ä¸­.
> ä½†å¦‚æœ`æ›´æ–°çš„å­—æ®µéƒ½æ˜¯åŸºç¡€ç±»å‹`å¦‚boolå’Œi32ï¼Œæ˜¯`å®ç° Copy trait çš„ç±»å‹`ã€‚é‚£ä¹ˆ user1 åœ¨åˆ›å»º user2 åä»ç„¶æœ‰æ•ˆ


### å…ƒç»„ç»“æ„ä½“ï¼ˆtuple structsï¼‰

å…ƒç»„ç»“æ„ä½“`æœ‰ç€ç»“æ„ä½“åç§°`æä¾›çš„å«ä¹‰ï¼Œä½†`æ²¡æœ‰å…·ä½“çš„å­—æ®µå`ï¼Œåªæœ‰å­—æ®µçš„ç±»å‹ã€‚

è™½ç„¶Colorï¼ŒPointä¸¤ä¸ªç±»å‹éƒ½ç”±ä¸‰ä¸ª i32 å€¼ç»„æˆï¼Œä½†blackï¼Œoriginæ˜¯ä¸åŒçš„å…ƒç»„ç»“æ„ä½“çš„å®ä¾‹

å…ƒç»„ç»“æ„ä½“å®ä¾‹ç±»ä¼¼äºå…ƒç»„ï¼Œä½ å¯ä»¥å°†å®ƒä»¬`è§£æ„ä¸ºå•ç‹¬çš„éƒ¨åˆ†`ï¼Œä¹Ÿ`å¯ä»¥ä½¿ç”¨ . åè·Ÿç´¢å¼•æ¥è®¿é—®å•ç‹¬çš„å€¼`ï¼Œç­‰ç­‰ã€‚

```rust
struct Color(i32, i32, i32);
struct Point(i32, i32, i32);

fn main() {
    let black = Color(0, 0, 0);
    let origin = Point(0, 0, 0);
}
```
### ç±»å•å…ƒç»“æ„ä½“ï¼ˆunit-like structsï¼‰

æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªæ²¡æœ‰ä»»ä½•å­—æ®µçš„ç»“æ„ä½“ï¼å®ƒä»¬è¢«ç§°ä¸º ç±»å•å…ƒç»“æ„ä½“ï¼ˆunit-like structsï¼‰

ç±»å•å…ƒç»“æ„ä½“å¸¸å¸¸åœ¨ä½ æƒ³è¦`åœ¨æŸä¸ªç±»å‹ä¸Šå®ç° trait ä½†ä¸éœ€è¦åœ¨ç±»å‹ä¸­å­˜å‚¨æ•°æ®çš„æ—¶å€™`å‘æŒ¥ä½œç”¨

```rust
struct AlwaysEqual;

fn main() {
    let subject = AlwaysEqual;
}
```


## 5.2 ç»“æ„ä½“ç¤ºä¾‹ç¨‹åº
```rust
struct Rectangle {
    width: u32,
    height: u32,
}

fn area(rectangle: Rectangle) -> u32 {
    rectangle.height * rectangle.width
}

pub(crate) fn main() {

    let rectangle = Rectangle {
        width: 30,
        height: 50,
    };

    println!(
        "The area of the rectangle is {} square pixels.",
        area(rectangle)
    );
}
```

### é€šè¿‡æ´¾ç”Ÿ trait å¢åŠ å®ç”¨åŠŸèƒ½
`println! `å®èƒ½å¤„ç†å¾ˆå¤šç±»å‹çš„æ ¼å¼ï¼Œä¸è¿‡ï¼Œ`{}` é»˜è®¤å‘Šè¯‰ `println! `ä½¿ç”¨è¢«ç§°ä¸º Display çš„æ ¼å¼ï¼šæ„åœ¨æä¾›ç»™ç›´æ¥ç»ˆç«¯ç”¨æˆ·æŸ¥çœ‹çš„è¾“å‡ºã€‚

ç›®å‰ä¸ºæ­¢è§è¿‡çš„åŸºæœ¬ç±»å‹éƒ½é»˜è®¤å®ç°äº† `Display` ï¼Œå› ä¸ºå®ƒå°±æ˜¯å‘ç”¨æˆ·å±•ç¤º 1 æˆ–å…¶ä»–ä»»ä½•åŸºæœ¬ç±»å‹çš„å”¯ä¸€æ–¹å¼ã€‚

å¯¹äºç»“æ„ä½“ï¼Œ`println!` åº”è¯¥ç”¨æ¥è¾“å‡ºçš„æ ¼å¼æ˜¯ä¸æ˜ç¡®çš„ï¼Œå› ä¸ºè¿™æœ‰æ›´å¤šæ˜¾ç¤ºçš„å¯èƒ½æ€§ï¼šæ˜¯å¦éœ€è¦é€—å·ï¼Ÿéœ€è¦æ‰“å°å‡ºå¤§æ‹¬å·å—ï¼Ÿæ‰€æœ‰å­—æ®µéƒ½åº”è¯¥æ˜¾ç¤ºå—ï¼Ÿç”±äºè¿™ç§ä¸ç¡®å®šæ€§ï¼ŒRust ä¸ä¼šå°è¯•çŒœæµ‹æˆ‘ä»¬çš„æ„å›¾ï¼Œæ‰€ä»¥`ç»“æ„ä½“å¹¶æ²¡æœ‰æä¾›ä¸€ä¸ª Display å®ç°`æ¥ä½¿ç”¨ `println!` ä¸ `{}` å ä½ç¬¦ã€‚

æ‰“å°ç»“æ„ä½“æ—¶:
- åœ¨ `{} `ä¸­åŠ å…¥ `:? `æŒ‡ç¤ºç¬¦å‘Šè¯‰ `println!` æˆ‘ä»¬æƒ³è¦ä½¿ç”¨å«åš `Debug` çš„è¾“å‡ºæ ¼å¼ã€‚
- ç»“æ„ä½“å®šä¹‰ä¹‹å‰åŠ ä¸Šå¤–éƒ¨å±æ€§ #[derive(Debug)]

> å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªæ›´å¤§çš„ç»“æ„ä½“æ—¶ï¼Œèƒ½æœ‰æ›´æ˜“è¯»ä¸€ç‚¹çš„è¾“å‡ºå°±å¥½äº†ï¼Œä¸ºæ­¤å¯ä»¥ä½¿ç”¨` {:#?}` æ›¿æ¢ println! å­—ç¬¦ä¸²ä¸­çš„ `{:?}`

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    // Use {:?}
    println!("rect1 is {:?}", rect1);
}
```

### ä½¿ç”¨ dbg!
```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let scale = 2;
    let rect1 = Rectangle {
        // dbg! è¿”å›è¡¨è¾¾å¼çš„å€¼çš„æ‰€æœ‰æƒï¼Œæ‰€ä»¥ width å­—æ®µå°†è·å¾—ç›¸åŒçš„å€¼ï¼Œå°±åƒæˆ‘ä»¬åœ¨é‚£é‡Œæ²¡æœ‰ dbg! è°ƒç”¨ä¸€æ ·
        width: dbg!(30 * scale),
        height: 50,
    };
    // æˆ‘ä»¬ä¸å¸Œæœ› dbg! æ‹¥æœ‰ rect1 çš„æ‰€æœ‰æƒï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä¸‹ä¸€æ¬¡è°ƒç”¨ dbg! æ—¶ä¼ é€’ä¸€ä¸ªå¼•ç”¨
    dbg!(&rect1);
}
```

## 5.3 æ–¹æ³•è¯­æ³•

`æ–¹æ³•ï¼ˆmethodï¼‰`ä¸å‡½æ•°ç±»ä¼¼ï¼šå®ƒä»¬ä½¿ç”¨ fn å…³é”®å­—å’Œåç§°å£°æ˜ï¼Œå¯ä»¥æ‹¥æœ‰å‚æ•°å’Œè¿”å›å€¼ï¼ŒåŒæ—¶åŒ…å«åœ¨æŸå¤„è°ƒç”¨è¯¥æ–¹æ³•æ—¶ä¼šæ‰§è¡Œçš„ä»£ç ã€‚

ä¸å‡½æ•°æ˜¯ä¸åŒçš„ï¼Œå› ä¸ºå®ƒä»¬åœ¨ç»“æ„ä½“çš„ä¸Šä¸‹æ–‡`impl`ä¸­è¢«å®šä¹‰ï¼ˆæˆ–è€…æ˜¯æšä¸¾æˆ– trait å¯¹è±¡çš„ä¸Šä¸‹æ–‡ï¼Œå°†åˆ†åˆ«åœ¨ç¬¬å…­ç« å’Œç¬¬åä¸ƒç« è®²è§£ï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬ç¬¬ä¸€ä¸ªå‚æ•°æ€»æ˜¯ `self` ï¼Œå®ƒä»£è¡¨è°ƒç”¨è¯¥æ–¹æ³•çš„ç»“æ„ä½“å®ä¾‹ã€‚

> `method` æ˜¯ ç»“æ„ä½“ `å®ç°impl` ä¸­å®šä¹‰çš„

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}
 
impl Rectangle {
    fn area(&self) -> u32 {
        self.width * self.height
    }
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    println!(
        "The area of the rectangle is {} square pixels.",
        rect1.area()
    );
}
```

#### getter
```rust
impl Rectangle {

    fn width(&self) -> u32 {
        self.width
    }
}

pub(crate) fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };
    
    println!(
        "The width of the rectangle is {} square pixels.",
        rect1.width()
    );
}
```

åœ¨ area çš„ç­¾åä¸­ï¼Œä½¿ç”¨ &self æ¥æ›¿ä»£ rectangle: &Rectangleï¼Œ`&self å®é™…ä¸Šæ˜¯ self: &Self çš„ç¼©å†™ã€‚`, æœ‰4ç§ç¼©å†™ï¼š
- self è·å–æ‰€æœ‰æƒ
- &self ä»…ä»…è¯»å–
- mut self è·å–æ‰€æœ‰æƒ
- &mut self åšå‡ºä¿®æ”¹

è¿™é‡Œé€‰æ‹© `&self `çš„ç†ç”±è·Ÿåœ¨å‡½æ•°ç‰ˆæœ¬ä¸­ä½¿ç”¨ &Rectangle æ˜¯ç›¸åŒçš„ï¼šæˆ‘ä»¬å¹¶ä¸æƒ³è·å–æ‰€æœ‰æƒï¼Œåªå¸Œæœ›èƒ½å¤Ÿè¯»å–ç»“æ„ä½“ä¸­çš„æ•°æ®ï¼Œè€Œä¸æ˜¯å†™å…¥ã€‚

å¦‚æœæƒ³è¦åœ¨æ–¹æ³•ä¸­æ”¹å˜è°ƒç”¨æ–¹æ³•çš„å®ä¾‹ï¼Œéœ€è¦å°†ç¬¬ä¸€ä¸ªå‚æ•°æ”¹ä¸º `&mut self`

> ä½¿ç”¨æ–¹æ³•æ›¿ä»£å‡½æ•°çš„ç›®çš„ï¼š
> ä¸éœ€è¦åœ¨æ¯ä¸ªå‡½æ•°ç­¾åä¸­é‡å¤ self çš„ç±»å‹ä¹‹å¤–ï¼Œ
> å…¶ä¸»è¦å¥½å¤„åœ¨äºç»„ç»‡æ€§ã€‚æˆ‘ä»¬å°†æŸä¸ªç±»å‹å®ä¾‹èƒ½åšçš„æ‰€æœ‰äº‹æƒ…éƒ½ä¸€èµ·æ”¾å…¥ impl å—ä¸­ï¼Œè€Œä¸æ˜¯è®©å°†æ¥çš„ç”¨æˆ·åœ¨æˆ‘ä»¬çš„åº“ä¸­åˆ°å¤„å¯»æ‰¾ Rectangle çš„åŠŸèƒ½ã€‚


Getters å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºä½ `å¯ä»¥æŠŠå­—æ®µå˜æˆç§æœ‰çš„ï¼Œä½†æ–¹æ³•æ˜¯å…¬å…±çš„`ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠå¯¹å­—æ®µçš„åªè¯»è®¿é—®ä½œä¸ºè¯¥ç±»å‹å…¬å…± API çš„ä¸€éƒ¨åˆ†ã€‚

#### -> è¿ç®—ç¬¦åˆ°å“ªå»äº†ï¼Ÿ
åœ¨ C/C++ è¯­è¨€ä¸­ï¼Œæœ‰ä¸¤ä¸ªä¸åŒçš„è¿ç®—ç¬¦æ¥è°ƒç”¨æ–¹æ³•ï¼š`.` ç›´æ¥åœ¨å¯¹è±¡ä¸Šè°ƒç”¨æ–¹æ³•ï¼Œè€Œ `->` åœ¨ä¸€ä¸ªå¯¹è±¡çš„æŒ‡é’ˆä¸Šè°ƒç”¨æ–¹æ³•, è¿™æ—¶éœ€è¦å…ˆ`è§£å¼•ç”¨ï¼ˆdereferenceï¼‰æŒ‡é’ˆ`ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœ object æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œé‚£ä¹ˆ `object->something()` å°±åƒ `(*object).something()` ä¸€æ ·ã€‚

Rust å¹¶æ²¡æœ‰ä¸€ä¸ªä¸ -> ç­‰æ•ˆçš„è¿ç®—ç¬¦ï¼›ç›¸åï¼ŒRust æœ‰ä¸€ä¸ªå« `è‡ªåŠ¨å¼•ç”¨å’Œè§£å¼•ç”¨ï¼ˆautomatic referencing and dereferencingï¼‰`çš„åŠŸèƒ½ã€‚`æ–¹æ³•è°ƒç”¨`æ˜¯ Rust ä¸­å°‘æ•°å‡ ä¸ªæ‹¥æœ‰è¿™ç§è¡Œä¸ºçš„åœ°æ–¹ã€‚


### å¸¦æœ‰æ›´å¤šå‚æ•°çš„æ–¹æ³•
```rust
impl Rectangle {
    fn can_hold(&self, another_rectangle: &Rectangle) -> bool {
        self.width >= another_rectangle.width
            && self.height >= another_rectangle.height
    }
}
```

### å…³è”å‡½æ•°
æ‰€æœ‰åœ¨ `impl` å—ä¸­å®šä¹‰çš„å‡½æ•°è¢«ç§°ä¸º `å…³è”å‡½æ•°ï¼ˆassociated functionsï¼‰`ï¼Œå› ä¸ºå®ƒä»¬ä¸ `impl` åé¢å‘½åçš„ç±»å‹ç›¸å…³ã€‚

å¯ä»¥å®šä¹‰`ä¸ä»¥ self ä¸ºç¬¬ä¸€å‚æ•°çš„å…³è”å‡½æ•°ï¼ˆå› æ­¤ä¸æ˜¯æ–¹æ³•ï¼‰`ï¼Œå› ä¸ºå®ƒä»¬å¹¶`ä¸ä½œç”¨äºä¸€ä¸ªç»“æ„ä½“çš„å®ä¾‹`ã€‚æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†ä¸€ä¸ªè¿™æ ·çš„å‡½æ•°ï¼šåœ¨ String ç±»å‹ä¸Šå®šä¹‰çš„ `String::from` å‡½æ•°ã€‚

ä¸æ˜¯æ–¹æ³•çš„å…³è”å‡½æ•°`ç»å¸¸è¢«ç”¨ä½œè¿”å›ä¸€ä¸ªç»“æ„ä½“æ–°å®ä¾‹çš„æ„é€ å‡½æ•°`ã€‚

> ä½¿ç”¨ç»“æ„ä½“åå’Œ `::` è¯­æ³•æ¥è°ƒç”¨è¿™ä¸ªå…³è”å‡½æ•°

```rust
impl Rectangle {
    fn square(size: u32) -> Self { // Self å³æ˜¯ Rectangle
        Self {
            width: size,
            height: size,
        }
    }
}
```

# 6. Enums and Pattern Matching

enums æä¾›äº†ä¸€ç§è¯´æ˜ä¸€ä¸ª value æ˜¯ä¸€ç»„å¯èƒ½çš„ value ä¹‹ä¸€çš„æ–¹æ³•

å‡è®¾æˆ‘ä»¬è¦å¤„ç† IP åœ°å€ã€‚ç›®å‰è¢«å¹¿æ³›ä½¿ç”¨çš„ä¸¤ä¸ªä¸»è¦ IP æ ‡å‡†ï¼šIPv4ï¼ˆversion fourï¼‰å’Œ IPv6ï¼ˆversion sixï¼‰ã€‚è¿™æ˜¯æˆ‘ä»¬çš„ç¨‹åºå¯èƒ½ä¼šé‡åˆ°çš„æ‰€æœ‰å¯èƒ½çš„ IP åœ°å€ç±»å‹ï¼šæ‰€ä»¥å¯ä»¥ `æšä¸¾` å‡ºæ‰€æœ‰å¯èƒ½çš„å€¼. 

ä»»ä½•ä¸€ä¸ª IP åœ°å€è¦ä¹ˆæ˜¯ IPv4 çš„è¦ä¹ˆæ˜¯ IPv6 çš„ï¼Œè€Œä¸”ä¸èƒ½ä¸¤è€…éƒ½æ˜¯ã€‚IP åœ°å€çš„è¿™ä¸ªç‰¹æ€§ä½¿å¾—æšä¸¾æ•°æ®ç»“æ„éå¸¸é€‚åˆè¿™ä¸ªåœºæ™¯ï¼Œå› ä¸ºæšä¸¾å€¼åªå¯èƒ½æ˜¯å…¶ä¸­ä¸€ä¸ªæˆå‘˜ã€‚

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

// ç±»ä¼¼äºå®šä¹‰å¤šä¸ªä¸åŒç±»å‹çš„ç»“æ„ä½“ï¼Œå¦‚ä¸‹
struct QuitMessage; // ç±»å•å…ƒç»“æ„ä½“
struct MoveMessage {
    x: i32,
    y: i32,
}
struct WriteMessage(String); // å…ƒç»„ç»“æ„ä½“
struct ChangeColorMessage(i32, i32, i32); // å…ƒç»„ç»“æ„ä½“
```

æšä¸¾è¿˜æœ‰å¦ä¸€ä¸ªç›¸ä¼¼ç‚¹ï¼šå°±åƒå¯ä»¥ä½¿ç”¨ `impl` æ¥ä¸ºç»“æ„ä½“å®šä¹‰æ–¹æ³•é‚£æ ·
```rust
    impl Message {
        fn call(&self) {
            // åœ¨è¿™é‡Œå®šä¹‰æ–¹æ³•ä½“
        }
    }

    let m = Message::Write(String::from("hello"));
    m.call();
```

### Option æšä¸¾å’Œå…¶ç›¸å¯¹äºç©ºå€¼çš„ä¼˜åŠ¿

`Option` æ˜¯æ ‡å‡†åº“å®šä¹‰çš„ä¸€ä¸ªæšä¸¾. `Option` ç±»å‹åº”ç”¨å¹¿æ³›å› ä¸ºå®ƒç¼–ç äº†ä¸€ä¸ªéå¸¸æ™®éçš„åœºæ™¯ï¼Œ`å³ä¸€ä¸ªå€¼è¦ä¹ˆæœ‰å€¼è¦ä¹ˆæ²¡å€¼ã€‚`

Rust å¹¶`æ²¡æœ‰`å¾ˆå¤šå…¶ä»–è¯­è¨€ä¸­æœ‰çš„`ç©ºå€¼åŠŸèƒ½`ã€‚ç©ºå€¼ï¼ˆNull ï¼‰æ˜¯ä¸€ä¸ªå€¼ï¼Œå®ƒä»£è¡¨æ²¡æœ‰å€¼ã€‚ç©ºå€¼æ˜¯ä¸€ä¸ªå› ä¸ºæŸç§åŸå› ç›®å‰æ— æ•ˆæˆ–ç¼ºå¤±çš„å€¼ã€‚
åœ¨æœ‰ç©ºå€¼çš„è¯­è¨€ä¸­ï¼Œå˜é‡æ€»æ˜¯è¿™ä¸¤ç§çŠ¶æ€ä¹‹ä¸€ï¼šç©ºå€¼å’Œéç©ºå€¼ã€‚

`Rust å¹¶æ²¡æœ‰ç©ºå€¼`ï¼Œä¸è¿‡å®ƒç¡®å®æ‹¥æœ‰ä¸€ä¸ªå¯ä»¥ç¼–ç å­˜åœ¨æˆ–ä¸å­˜åœ¨æ¦‚å¿µçš„æšä¸¾ã€‚è¿™ä¸ªæšä¸¾æ˜¯ `Option<T>`, å®ƒå®šä¹‰äºæ ‡å‡†åº“ä¸­:
```rust
enum Option<T> {
    None,
    Some(T),
}
```

`Option<T> `æšä¸¾æ˜¯å¦‚æ­¤æœ‰ç”¨ä»¥è‡³äºå®ƒç”šè‡³è¢«åŒ…å«åœ¨äº† `prelude` ä¹‹ä¸­, å¯ä»¥ä¸éœ€è¦ Option:: å‰ç¼€æ¥`ç›´æ¥ä½¿ç”¨ Some å’Œ None`

> <T> è¯­æ³•æ˜¯ä¸€ä¸ªæˆ‘ä»¬è¿˜æœªè®²åˆ°çš„ Rust åŠŸèƒ½ã€‚å®ƒæ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹å‚æ•°ï¼Œç¬¬åç« ä¼šæ›´è¯¦ç»†çš„è®²è§£æ³›å‹ã€‚

æˆ‘ä»¬åœ¨ Some æˆå‘˜ä¸­æŒ‡å®šäº†å€¼ï¼Œ`Rust å¯ä»¥æ¨æ–­å…¶ç±»å‹ã€‚`
```rust
    // some_number çš„ç±»å‹æ˜¯ Option<i32>
    let some_number = Some(5);
    // some_char çš„ç±»å‹æ˜¯ Option<char>
    let some_char = Some('e');
    // éœ€è¦æŒ‡å®š Option æ•´ä½“çš„ç±»å‹ï¼Œå› ä¸ºç¼–è¯‘å™¨åªé€šè¿‡ None å€¼æ— æ³•æ¨æ–­å‡º Some æˆå‘˜ä¿å­˜çš„å€¼çš„ç±»å‹
    // æˆ‘ä»¬å‘Šè¯‰ Rust å¸Œæœ› absent_number æ˜¯ Option<i32> ç±»å‹çš„ã€‚
    let absent_number: Option<i32> = None;
```

`Option<T>` ä¸ºä»€ä¹ˆå°±æ¯”ç©ºå€¼è¦å¥½å‘¢ï¼Ÿ
-> å› ä¸º `Option<T>` å’Œ `T`ï¼ˆè¿™é‡Œ `T` å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼‰æ˜¯ä¸åŒçš„ç±»å‹ï¼Œç¼–è¯‘å™¨ä¸å…è®¸åƒä¸€ä¸ª`è‚¯å®šæœ‰æ•ˆçš„å€¼`é‚£æ ·ä½¿ç”¨ `Option<T>`
```rust
    let x: i8 = 5;
    let y: Option<i8> = Some(5);

    let sum = x + y;
```
ä¸Šè¿°ä»£ç ä¼šæŠ¥é”™ï¼šerror[E0277]: cannot add `Option<i8>` to `i8`ã€‚å› ä¸ºå®ƒå°è¯•å°† `Option<i8>` ä¸ `i8` ç›¸åŠ .
æ¢å¥è¯è¯´ï¼Œåœ¨å¯¹ `Option<T>` è¿›è¡Œè¿ç®—ä¹‹å‰å¿…é¡»å°†å…¶è½¬æ¢ä¸º` T`.

å¦‚ä½•ä» `Some` æˆå‘˜ä¸­å–å‡º `T` çš„å€¼æ¥ä½¿ç”¨å®ƒå‘¢?
-> ä¸ºäº†ä½¿ç”¨` Option<T>` å€¼ï¼Œéœ€è¦ç¼–å†™å¤„ç†æ¯ä¸ªæˆå‘˜çš„ä»£ç ã€‚ä½ æƒ³è¦ä¸€äº›ä»£ç åªå½“æ‹¥æœ‰ `Some(T)` å€¼æ—¶è¿è¡Œï¼Œå…è®¸è¿™äº›ä»£ç ä½¿ç”¨å…¶ä¸­çš„ `T`ã€‚ä¹Ÿå¸Œæœ›ä¸€äº›ä»£ç åªåœ¨å€¼ä¸º `None` æ—¶è¿è¡Œï¼Œè¿™äº›ä»£ç å¹¶æ²¡æœ‰ä¸€ä¸ªå¯ç”¨çš„ `T` `å€¼ã€‚match` è¡¨è¾¾å¼å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªå¤„ç†æšä¸¾çš„æ§åˆ¶æµç»“æ„


## 6.2 match æ§åˆ¶æµç»“æ„
```rust
enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter,
}

fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => {
            println!("Lucky penny!");
            1
        }, // åˆ†æ”¯åçš„é€—å·æ˜¯å¯é€‰çš„
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter => 25,
    }
}
```

### ç»‘å®šå€¼çš„æ¨¡å¼
```rust
#[derive(Debug)] // è¿™æ ·å¯ä»¥ç«‹åˆ»çœ‹åˆ°å·çš„åç§°
enum UsState {
    Alabama,
    Alaska,
    // --snip--
}

enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter(UsState),
}

fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => 1,
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter(state) => {
            println!("State quarter from {:?}!", state);
            25
        }
    }
}
```
è°ƒç”¨ `value_in_cents(Coin::Quarter(UsState::Alaska))` ä¼šæ‰“å° `State quarter from Alaska`, ä¸”è¿”å›å€¼ä¸º`25`

### åŒ¹é… Option<T>
æ¯”å¦‚æˆ‘ä»¬æƒ³è¦ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè·å–ä¸€ä¸ª `Option<i32>` ï¼Œå¦‚æœå…¶ä¸­å«æœ‰ä¸€ä¸ªå€¼ï¼Œå°†å…¶åŠ ä¸€ã€‚
å¦‚æœå…¶ä¸­æ²¡æœ‰å€¼ï¼Œå‡½æ•°åº”è¯¥è¿”å› None å€¼ï¼Œè€Œä¸å°è¯•æ‰§è¡Œä»»ä½•æ“ä½œã€‚

```rust
fn plus_one(x: Option<i32>) -> Option<i32> {
    match x {
        Some(i) => {
            Some(i + 1)
        },
        None => None,
    }
}

let five = Some(5);
let six = plus_one(five);
let none = plus_one(None);
```

### åŒ¹é…æ˜¯ç©·å°½çš„(exhaustive)
match è¿˜æœ‰å¦ä¸€æ–¹é¢éœ€è¦è®¨è®ºï¼šè¿™äº›åˆ†æ”¯å¿…é¡»è¦†ç›–äº†æ‰€æœ‰çš„å¯èƒ½æ€§ã€‚å¦åˆ™ä¼šæŠ¥é”™ï¼š`error[E0004]: non-exhaustive patterns: `None` not covered`

### é€šé…æ¨¡å¼å’Œ _ å ä½ç¬¦
```rust
    let dice_roll = 9;
    match dice_roll {
        3 => add_fancy_hat(),
        7 => remove_fancy_hat(),
        other => move_player(other), // otherå˜é‡åä¸matter, å¯ä»¥ç”¨å…¶ä»–åç§°
    }

    fn add_fancy_hat() {}
    fn remove_fancy_hat() {}
    fn move_player(num_spaces: u8) {}
```
å³ä½¿æˆ‘ä»¬æ²¡æœ‰åˆ—å‡º `u8` æ‰€æœ‰å¯èƒ½çš„å€¼ï¼Œè¿™æ®µä»£ç ä¾ç„¶èƒ½å¤Ÿç¼–è¯‘ï¼Œå› ä¸ºæœ€åä¸€ä¸ªæ¨¡å¼å°†åŒ¹é…æ‰€æœ‰æœªè¢«ç‰¹æ®Šåˆ—å‡ºçš„å€¼ã€‚
è¿™ç§é€šé…æ¨¡å¼æ»¡è¶³äº† `match` å¿…é¡»è¢«ç©·å°½çš„è¦æ±‚ã€‚
> è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¿…é¡»å°†`é€šé…åˆ†æ”¯æ”¾åœ¨æœ€å`ï¼Œå› ä¸ºæ¨¡å¼æ˜¯æŒ‰é¡ºåºåŒ¹é…çš„ã€‚

Rust è¿˜æä¾›äº†ä¸€ä¸ªæ¨¡å¼ï¼Œå½“æˆ‘ä»¬`ä¸æƒ³ä½¿ç”¨é€šé…æ¨¡å¼è·å–çš„å€¼`æ—¶ï¼Œè¯·ä½¿ç”¨ `_` ï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ¨¡å¼ï¼Œå¯ä»¥åŒ¹é…ä»»æ„å€¼è€Œä¸ç»‘å®šåˆ°è¯¥å€¼ã€‚
è¿™å‘Šè¯‰ Rust æˆ‘ä»¬ä¸ä¼šä½¿ç”¨è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥ Rust ä¹Ÿä¸ä¼šè­¦å‘Šæˆ‘ä»¬å­˜åœ¨æœªä½¿ç”¨çš„å˜é‡ã€‚
> ä½¿ç”¨ _ æ—¶ï¼Œ=>å³è¾¹ä¸èƒ½æœ‰ä½¿ç”¨ _ çš„åœºæ™¯
```rust
    let dice_roll = 9;
    match dice_roll {
        3 => add_fancy_hat(),
        7 => remove_fancy_hat(),
        _ => reroll(), // rerollå‡½æ•°ä¸å…³å¿ƒä¹Ÿä¸ä½¿ç”¨ _
    }

    fn add_fancy_hat() {}
    fn remove_fancy_hat() {}
    fn reroll() {}
```

## 6.3 if let ç®€æ´æ§åˆ¶æµ
`if let `è¯­æ³•è®©æˆ‘ä»¬ä»¥ä¸€ç§ä¸é‚£ä¹ˆå†—é•¿çš„æ–¹å¼ç»“åˆ `if` å’Œ `let` ï¼Œæ¥å¤„ç†`åªåŒ¹é…ä¸€ä¸ªæ¨¡å¼çš„å€¼`è€Œå¿½ç•¥å…¶ä»–æ¨¡å¼çš„æƒ…å†µã€‚

```rust
    let config_max = Some(3u8); // ç­‰ä»·äº let config_max: Option<u8> = Some(3);
    match config_max {
        Some(max) => println!("The maximum is configured to be {}", max),
        _ => (),
    }
```
ä¸Šè¿°ä»£ç ä¸ºäº†æ»¡è¶³ match è¡¨è¾¾å¼ï¼ˆç©·å°½æ€§ï¼‰çš„è¦æ±‚ï¼Œå¿…é¡»åœ¨å¤„ç†å®Œè¿™å”¯ä¸€çš„æˆå‘˜ååŠ ä¸Š `_ => ()`ï¼Œè¿™æ ·ä¹Ÿè¦å¢åŠ å¾ˆå¤šçƒ¦äººçš„æ ·æ¿ä»£ç ã€‚
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ if let è¿™ç§æ›´çŸ­çš„æ–¹å¼ç¼–å†™:

```rust
    let config_max = Some(3u8);
    if let Some(max) = config_max {
        println!("The maximum is configured to be {}", max);
    }
```

å¯ä»¥åœ¨ if let ä¸­åŒ…å«ä¸€ä¸ª elseã€‚else å—ä¸­çš„ä»£ç ä¸ match è¡¨è¾¾å¼ä¸­çš„ _ åˆ†æ”¯å—ä¸­çš„ä»£ç ç›¸åŒï¼Œè¿™æ ·çš„ match è¡¨è¾¾å¼å°±ç­‰åŒäº if let å’Œ elseã€‚

```rust
    let mut count = 0;
    match coin {
        Coin::Quarter(state) => println!("State quarter from {:?}!", state),
        _ => count += 1,
    }

    // ä¸Šè¿°ä»£ç ç­‰ä»·äºä¸‹ï¼š
    if let coin = Coin::Quarter(state) { // = å·¦å³é¡ºåºä¸é‡è¦
        println!("State quarter from {:?}!", state);
    } else {
        count += 1;
    }

```

æ¢å¥è¯è¯´ï¼Œå¯ä»¥è®¤ä¸º `if let` æ˜¯ match çš„ä¸€ä¸ª`è¯­æ³•ç³–`ï¼Œå®ƒå½“å€¼åŒ¹é…æŸä¸€æ¨¡å¼æ—¶æ‰§è¡Œä»£ç è€Œå¿½ç•¥æ‰€æœ‰å…¶ä»–å€¼ã€‚

# 7. Packages, Crates, and Modules

- åŒ…ï¼ˆPackagesï¼‰ï¼šCargo çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ æ„å»ºã€æµ‹è¯•å’Œåˆ†äº« crateã€‚
- Crates ï¼šä¸€ä¸ªæ¨¡å—çš„æ ‘å½¢ç»“æ„ï¼Œå®ƒå½¢æˆäº†åº“(library)æˆ–äºŒè¿›åˆ¶é¡¹ç›®(executable)ã€‚
- æ¨¡å—ï¼ˆModulesï¼‰å’Œ useï¼šå…è®¸ä½ æ§åˆ¶ä½œç”¨åŸŸå’Œè·¯å¾„çš„ç§æœ‰æ€§ã€‚
- è·¯å¾„ï¼ˆpathï¼‰ï¼šä¸€ä¸ªå‘½åä¾‹å¦‚ç»“æ„ä½“ã€å‡½æ•°æˆ–æ¨¡å—ç­‰é¡¹çš„æ–¹å¼

## 7.1 Package å’Œ Crate

### Crate
crate æ˜¯ Rust åœ¨ç¼–è¯‘æ—¶æœ€å°çš„ä»£ç å•ä½ã€‚

crate å¯ä»¥åŒ…å«æ¨¡å—ï¼Œæ¨¡å—å¯ä»¥å®šä¹‰åœ¨å…¶ä»–æ–‡ä»¶ï¼Œç„¶åå’Œ crate ä¸€èµ·ç¼–è¯‘ï¼Œæˆ‘ä»¬ä¼šåœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­é‡åˆ°ã€‚

crate æœ‰ä¸¤ç§å½¢å¼ï¼š
- library: `æ²¡æœ‰ main å‡½æ•°`ï¼Œå®ƒä»¬ä¹Ÿä¸ä¼šç¼–è¯‘ä¸ºå¯æ‰§è¡Œç¨‹åºï¼Œå®ƒä»¬æä¾›ä¸€äº›è¯¸å¦‚å‡½æ•°ä¹‹ç±»çš„ä¸œè¥¿ï¼Œä½¿å…¶ä»–é¡¹ç›®ä¹Ÿèƒ½ä½¿ç”¨è¿™äº›ä¸œè¥¿
- executable: è¢«ç¼–è¯‘ä¸ºå¯æ‰§è¡Œç¨‹åºï¼Œæ¯”å¦‚ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºæˆ–è€…ä¸€ä¸ªæœåŠ¡å™¨ã€‚å®ƒä»¬å¿…é¡»æœ‰ä¸€ä¸ª main å‡½æ•°æ¥å®šä¹‰å½“ç¨‹åºè¢«æ‰§è¡Œçš„æ—¶å€™æ‰€éœ€è¦åšçš„äº‹æƒ…ã€‚

> `crate root` æ˜¯ä¸€ä¸ªæºæ–‡ä»¶ï¼ŒRust ç¼–è¯‘å™¨ä»¥å®ƒä¸ºèµ·å§‹ç‚¹ï¼Œå¹¶æ„æˆä½ çš„ crate çš„æ ¹æ¨¡å—
> å¯¹äºä¸€ä¸ª executable , crate root = src/main.rs 
> å¯¹äºä¸€ä¸ª library, crate root = src/lib.rs

### Package
package æ˜¯æä¾›ä¸€ç³»åˆ—åŠŸèƒ½çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ª crateã€‚ä¸€ä¸ªpackageä¼šåŒ…å«ä¸€ä¸ª `Cargo.toml` æ–‡ä»¶ï¼Œé˜è¿°å¦‚ä½•å»æ„å»ºè¿™äº› crateã€‚

package å¿…é¡»è‡³å°‘åŒ…å«ä¸€ä¸ª crate:
- å¯ä»¥åŒ…å«è‡³å¤šä¸€ä¸ª library
- å¯ä»¥åŒ…å«ä»»æ„å¤šä¸ª executable

> é€šè¿‡å°†æ–‡ä»¶æ”¾åœ¨ `src/bin` ç›®å½•ä¸‹ï¼Œä¸€ä¸ªåŒ…å¯ä»¥æ‹¥æœ‰å¤šä¸ª executable ï¼šæ¯ä¸ª` src/bin `ä¸‹çš„æ–‡ä»¶éƒ½ä¼šè¢«ç¼–è¯‘æˆä¸€ä¸ªç‹¬ç«‹çš„ executable ã€‚


## 7.2 å®šä¹‰æ¨¡å—æ¥æ§åˆ¶ä½œç”¨åŸŸä¸ç§æœ‰æ€§
### Module

å£°æ˜æ¨¡å—
```rust
// in main.rs or lib.rs

// normal declaration
mod normal_module;
// inline declaration
mod inline_module {
    fn some_function() {
        println!("This is a function inside the my_module.");
    }

    pub fn public_function() {
        println!("This is a public function inside the my_module.");
    }
}

fn main() {
    normal_module::some_function();
    inline_module::public_function();
}
```

- ä¸€ä¸ªæ¨¡å—é‡Œçš„ä»£ç é»˜è®¤å¯¹å…¶çˆ¶æ¨¡å—ç§æœ‰ã€‚
- ä¸ºäº†ä½¿ä¸€ä¸ªæ¨¡å—å…¬ç”¨ï¼Œåº”å½“åœ¨å£°æ˜æ—¶ä½¿ç”¨`pub mod`æ›¿ä»£modã€‚
- ä¸ºäº†ä½¿ä¸€ä¸ªå…¬ç”¨æ¨¡å—å†…éƒ¨çš„æˆå‘˜å…¬ç”¨ï¼Œåº”å½“åœ¨å£°æ˜å‰ä½¿ç”¨`pub`ã€‚


`use `å…³é”®å­—: åœ¨ä¸€ä¸ªä½œç”¨åŸŸå†…ï¼Œuseå…³é”®å­—åˆ›å»ºäº†ä¸€ä¸ªæˆå‘˜çš„å¿«æ·æ–¹å¼ï¼Œç”¨æ¥å‡å°‘é•¿è·¯å¾„çš„é‡å¤ã€‚
```rust
use crate::garden::vegetables::Asparagus;

pub mod garden; // æ„å‘³ç€åœ¨src/garden/vegetables.rsä¸­çš„ä»£ç ä¹Ÿåº”è¯¥è¢«åŒ…æ‹¬

fn main() {
    let plant = Asparagus {};
    println!("I'm growing {:?}!", plant);
}
```

### å¯¹ç›¸å…³ä»£ç è¿›è¡Œåˆ†ç»„
æ¨¡å— è®©æˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ª crate ä¸­çš„ä»£ç è¿›è¡Œåˆ†ç»„ï¼Œä»¥æé«˜å¯è¯»æ€§ä¸é‡ç”¨æ€§ã€‚

ä¸€ä¸ªæ¨¡å—ä¸­çš„ä»£ç é»˜è®¤æ˜¯`ç§æœ‰çš„`ï¼Œæ‰€ä»¥è¿˜å¯ä»¥åˆ©ç”¨æ¨¡å—æ§åˆ¶é¡¹çš„ ç§æœ‰æ€§ã€‚

```rust
mod front_of_house {
    mod hosting { // child mod
        fn add_to_waitlist() {}

        fn seat_at_table() {}
    }

    mod serving { // child mod
        fn take_order() {}

        fn serve_order() {}

        fn take_payment() {}
    }
}
```

## 7.3 å¼•ç”¨æ¨¡å—é¡¹ç›®çš„è·¯å¾„

æˆ‘ä»¬ä½¿ç”¨`è·¯å¾„`çš„æ–¹å¼åœ¨æ¨¡å—æ ‘ä¸­æ‰¾åˆ°ä¸€ä¸ªé¡¹çš„ä½ç½®

è·¯å¾„æœ‰ä¸¤ç§å½¢å¼ï¼š
- ç»å¯¹è·¯å¾„ï¼ˆabsolute pathï¼‰æ˜¯ä»¥ crate rootå¼€å¤´çš„å…¨è·¯å¾„ï¼›å¯¹äºå¤–éƒ¨ crate çš„ä»£ç ï¼Œæ˜¯ä»¥ crate åå¼€å¤´çš„ç»å¯¹è·¯å¾„ï¼Œå¯¹äºå½“å‰ crate çš„ä»£ç ï¼Œåˆ™ä»¥å­—é¢å€¼ crate å¼€å¤´ã€‚
- ç›¸å¯¹è·¯å¾„ï¼ˆrelative pathï¼‰ä»å½“å‰æ¨¡å—å¼€å§‹ï¼Œä»¥ selfã€super æˆ–å½“å‰æ¨¡å—çš„æ ‡è¯†ç¬¦å¼€å¤´ã€‚

```rust
mod front_of_house {
    mod hosting {
        fn add_to_waitlist() {}
    }
}

pub fn eat_at_restaurant() {
    // ç»å¯¹è·¯å¾„
    crate::front_of_house::hosting::add_to_waitlist();

    // ç›¸å¯¹è·¯å¾„
    // front_of_house æ¨¡å—ä¸ eat_at_restaurant å®šä¹‰äºåŒä¸€æ¨¡å—ï¼Œ
    // æ‰€ä»¥ä» eat_at_restaurant ä¸­å¼€å§‹å®šä¹‰çš„è¯¥æ¨¡å—ç›¸å¯¹è·¯å¾„æ˜¯æœ‰æ•ˆçš„ã€‚
    front_of_house::hosting::add_to_waitlist();
}
```

ä¸Šè¿°ä»£ç ä¼šæŠ¥é”™ï¼š`error[E0603]: module `hosting` is private`ã€‚è™½ç„¶è°ƒç”¨è·¯å¾„æ˜¯åˆæ³•çš„ï¼Œä½†åœ¨ Rust ä¸­ï¼Œé»˜è®¤æ‰€æœ‰é¡¹ï¼ˆå‡½æ•°ã€æ–¹æ³•ã€ç»“æ„ä½“ã€æšä¸¾ã€æ¨¡å—å’Œå¸¸é‡ï¼‰`å¯¹çˆ¶æ¨¡å—éƒ½æ˜¯ç§æœ‰çš„`ã€‚

çˆ¶æ¨¡å—ä¸­çš„é¡¹ä¸èƒ½ä½¿ç”¨å­æ¨¡å—ä¸­çš„ç§æœ‰é¡¹ï¼Œä½†æ˜¯å­æ¨¡å—ä¸­çš„é¡¹å¯ä»¥ä½¿ç”¨å®ƒä»¬çˆ¶æ¨¡å—ä¸­çš„é¡¹

ä¸è¿‡ Rust ä¹Ÿç¡®å®æä¾›äº†é€šè¿‡ä½¿ç”¨ `pub` å…³é”®å­—æ¥åˆ›å»ºå…¬å…±é¡¹ï¼Œä½¿å­æ¨¡å—çš„å†…éƒ¨éƒ¨åˆ†æš´éœ²ç»™ä¸Šçº§æ¨¡å—ã€‚

### ä½¿ç”¨ pub å…³é”®å­—æš´éœ²è·¯å¾„
```rust
mod front_of_house {
    // è®©çˆ¶æ¨¡å—ä¸­çš„ eat_at_restaurant å‡½æ•°å¯ä»¥è®¿é—®å­æ¨¡å— hosting
    pub mod hosting {
        //  è®©çˆ¶æ¨¡å—ä¸­çš„ eat_at_restaurant å‡½æ•°å¯ä»¥è®¿é—®å­æ¨¡å—å†…éƒ¨ä»£ç add_to_waitlist
        pub fn add_to_waitlist() {}
    }
}

pub fn eat_at_restaurant() {
    // ç»å¯¹è·¯å¾„
    crate::front_of_house::hosting::add_to_waitlist();

    // ç›¸å¯¹è·¯å¾„
    front_of_house::hosting::add_to_waitlist();
}
```

#### executable å’Œ library çš„æœ€ä½³å®è·µ
- åœ¨ executable ä¸­åªæœ‰è¶³å¤Ÿçš„ä»£ç æ¥å¯åŠ¨ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯æ‰§è¡Œæ–‡ä»¶è°ƒç”¨ library çš„ä»£ç ã€‚
- æ¨¡å—æ ‘åº”è¯¥å®šä¹‰åœ¨ src/lib.rs ä¸­ã€‚è¿™æ ·é€šè¿‡ä»¥åŒ…åå¼€å¤´çš„è·¯å¾„ï¼Œå…¬æœ‰é¡¹å°±å¯ä»¥åœ¨ executable ä¸­ä½¿ç”¨ã€‚
-  executable å°±å®Œå…¨å˜æˆäº†åŒå…¶å®ƒ å¤–éƒ¨ crate ä¸€æ ·çš„ library çš„ç”¨æˆ·ï¼šå®ƒåªèƒ½ä½¿ç”¨å…¬æœ‰ API
- è¿™æœ‰åŠ©äºä½ è®¾è®¡ä¸€ä¸ªå¥½çš„ APIï¼›ä½ ä¸ä»…ä»…æ˜¯ä½œè€…ï¼Œä¹Ÿæ˜¯ç”¨æˆ·ï¼ 


### super å¼€å§‹çš„ç›¸å¯¹è·¯å¾„
```rust
fn deliver_order() {}

mod back_of_house {
    fn fix_incorrect_order() {
        cook_order();
        // é€šè¿‡åœ¨è·¯å¾„çš„å¼€å¤´ä½¿ç”¨ super ï¼Œä»çˆ¶æ¨¡å—å¼€å§‹æ„å»ºç›¸å¯¹è·¯å¾„
        super::deliver_order();
    }

    fn cook_order() {}
}
```

superå¯ä»¥`å¤šé‡ä½¿ç”¨`
```rust
mod a {
    pub fn hello() {
        println!("Hello from module a");
    }

    pub(crate) mod b {
        pub fn hello() {
            println!("Greetings from module b");
        }

        pub(crate) mod c {
            pub fn greet() {
                // b::hello()
                super::hello();
                // a::hello()
                super::super::hello();
            }
        }
    }
}

pub(crate) fn main() {
    a::b::c::greet();
}
```

### åˆ›å»ºå…¬æœ‰çš„ç»“æ„ä½“å’Œæšä¸¾

- åœ¨ä¸€ä¸ªç»“æ„ä½“å®šä¹‰çš„å‰é¢ä½¿ç”¨äº† pub ï¼Œè¿™ä¸ªç»“æ„ä½“ä¼šå˜æˆå…¬æœ‰çš„ï¼Œä½†æ˜¯è¿™ä¸ªç»“æ„ä½“çš„å­—æ®µä»ç„¶æ˜¯ç§æœ‰çš„ã€‚
- å°†æšä¸¾è®¾ä¸ºå…¬æœ‰ï¼Œåˆ™å®ƒçš„æ‰€æœ‰æˆå‘˜éƒ½å°†å˜ä¸ºå…¬æœ‰ã€‚

> å¦‚æœæšä¸¾æˆå‘˜ä¸æ˜¯å…¬æœ‰çš„ï¼Œé‚£ä¹ˆæšä¸¾ä¼šæ˜¾å¾—ç”¨å¤„ä¸å¤§ï¼›ç»™æšä¸¾çš„æ‰€æœ‰æˆå‘˜æŒ¨ä¸ªæ·»åŠ  pub æ˜¯å¾ˆä»¤äººæ¼ç«çš„ï¼Œå› æ­¤æšä¸¾æˆå‘˜é»˜è®¤å°±æ˜¯å…¬æœ‰çš„ã€‚
> ç»“æ„ä½“é€šå¸¸ä½¿ç”¨æ—¶ï¼Œä¸å¿…å°†å®ƒä»¬çš„å­—æ®µå…¬æœ‰åŒ–ï¼Œå› æ­¤ç»“æ„ä½“éµå¾ªå¸¸è§„

```rust
mod back_of_house {
    pub struct Breakfast {
        pub toast: String, // toastå…¬æœ‰
        seasonal_fruit: String, // seasonal_fruitä»ç„¶æ˜¯ç§æœ‰
    }

    impl Breakfast {
        pub fn summer(toast: &str) -> Breakfast {
            Breakfast {
                toast: String::from(toast),
                seasonal_fruit: String::from("peaches"),
            }
        }
    }

    // Soup, Saladéƒ½ä¸ºå…¬æœ‰
    pub enum Appetizer {
        Soup,
        Salad,
    }
}
```

## 7.4 ä½¿ç”¨ use å…³é”®å­—å°†è·¯å¾„å¼•å…¥ä½œç”¨åŸŸ

ä¸å¾—ä¸ç¼–å†™è·¯å¾„æ¥è°ƒç”¨å‡½æ•°æ˜¾å¾—ä¸ä¾¿ä¸”é‡å¤ã€‚
-> ä»¬å¯ä»¥ä½¿ç”¨ `use` å…³é”®å­—åˆ›å»ºä¸€ä¸ªçŸ­è·¯å¾„ï¼Œç„¶åå°±å¯ä»¥åœ¨`ä½œç”¨åŸŸä¸­`çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨è¿™ä¸ªæ›´çŸ­çš„åå­—ã€‚

åœ¨ä½œç”¨åŸŸä¸­å¢åŠ  `use` å’Œè·¯å¾„ç±»ä¼¼äºåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»º`è½¯è¿æ¥ï¼ˆç¬¦å·è¿æ¥ï¼Œsymbolic linkï¼‰`ã€‚

```rust
mod front_of_house {
    pub mod hosting {
        pub fn add_to_waitlist() {}
    }
}

use crate::front_of_house::hosting;

pub fn eat_at_restaurant() {
    hosting::add_to_waitlist();
}
```

### ä½¿ç”¨ as å…³é”®å­—æä¾›æ–°çš„åç§°
è€ƒè™‘ä»¥ä¸‹åœºæ™¯, fmtå’Œioéƒ½æœ‰å„è‡ªçš„Result, é€šè¿‡useæ¥åŒºåˆ†
```rust
use std::fmt;
use std::io;

fn function1() -> fmt::Result {
    // --snip--
}

fn function2() -> io::Result<()> {
    // --snip--
}
```

ä½¿ç”¨ use å°†ä¸¤ä¸ªåŒåç±»å‹å¼•å…¥åŒä¸€ä½œç”¨åŸŸè¿™ä¸ªé—®é¢˜è¿˜æœ‰å¦ä¸€ä¸ªè§£å†³åŠæ³•ï¼šåœ¨è¿™ä¸ªç±»å‹çš„è·¯å¾„åé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ as æŒ‡å®šä¸€ä¸ªæ–°çš„æœ¬åœ°åç§°æˆ–è€…åˆ«åã€‚

```rust
use std::fmt::Result;
use std::io::Result as IoResult;

fn function1() -> Result {
    // --snip--
}

fn function2() -> IoResult<()> {
    // --snip--
}
```


### ä½¿ç”¨ pub use é‡å¯¼å‡ºåç§°
```rust
mod front_of_house {
    pub mod hosting {
        pub fn add_to_waitlist() {}
    }
}

// é‡å¯¼å‡ºï¼ˆre-exporting)
pub use crate::front_of_house::hosting;

pub fn eat_at_restaurant() {
    hosting::add_to_waitlist();
}
```
ä¿®æ”¹ä¹‹å‰ï¼Œå¤–éƒ¨ä»£ç éœ€è¦ä½¿ç”¨è·¯å¾„ `restaurant::front_of_house::hosting::add_to_waitlist()`

ç°åœ¨, å¤–éƒ¨ä»£ç ç°åœ¨å¯ä»¥ä½¿ç”¨è·¯å¾„ `restaurant::hosting::add_to_waitlist`

> å½“ä½ ä»£ç çš„å†…éƒ¨ç»“æ„ä¸è°ƒç”¨ä½ ä»£ç çš„ç¨‹åºå‘˜æ‰€æƒ³è±¡çš„ç»“æ„ä¸åŒæ—¶ï¼Œé‡å¯¼å‡ºä¼šå¾ˆæœ‰ç”¨ã€‚

### ä½¿ç”¨å¤–éƒ¨åŒ…

crates.io ä¸Šæœ‰å¾ˆå¤š Rust ç¤¾åŒºæˆå‘˜å‘å¸ƒçš„åŒ…ï¼Œå°†å…¶å¼•å…¥ä½ è‡ªå·±çš„é¡¹ç›®éƒ½éœ€è¦ä¸€é“ç›¸åŒçš„æ­¥éª¤ï¼š
- åœ¨ Cargo.toml åˆ—å‡ºå®ƒä»¬
- å¹¶é€šè¿‡ use å°†å…¶ä¸­å®šä¹‰çš„é¡¹å¼•å…¥é¡¹ç›®åŒ…çš„ä½œç”¨åŸŸä¸­ã€‚

```rust
// in Cargo.toml
rand = "0.8.5"

// in your rs code
use rand::Rng;

fn main() {
    let secret_number = rand::thread_rng().gen_range(1..=100);
}
```

æ³¨æ„ `std` æ ‡å‡†åº“å¯¹äºä½ çš„åŒ…æ¥è¯´ä¹Ÿæ˜¯å¤–éƒ¨ crateã€‚
- æ— éœ€ä¿®æ”¹ Cargo.toml æ¥å¼•å…¥ std
- ä¸è¿‡éœ€è¦é€šè¿‡ use å°†æ ‡å‡†åº“ä¸­å®šä¹‰çš„é¡¹å¼•å…¥é¡¹ç›®åŒ…çš„ä½œç”¨åŸŸä¸­æ¥å¼•ç”¨å®ƒä»¬

```rust
use std::collections::HashMap;
```

### åµŒå¥—è·¯å¾„æ¥æ¶ˆé™¤å¤§é‡çš„ use è¡Œ

å½“éœ€è¦å¼•å…¥å¾ˆå¤š`å®šä¹‰äºç›¸åŒåŒ…æˆ–ç›¸åŒæ¨¡å—çš„é¡¹`æ—¶ï¼Œä¸ºæ¯ä¸€é¡¹å•ç‹¬åˆ—å‡ºä¸€è¡Œä¼šå ç”¨æºç å¾ˆå¤§çš„ç©ºé—´ã€‚

```rust
// --snip--
use std::cmp::Ordering;
use std::io;
// --snip--

// ç­‰ä»·äº
use std::{cmp::Ordering, io};


use std::io;
use std::io::Write;

// ç­‰ä»·äº
use std::io::{self, Write};

```

### é€šè¿‡ glob è¿ç®—ç¬¦(*)å°†æ‰€æœ‰çš„å…¬æœ‰å®šä¹‰å¼•å…¥ä½œç”¨åŸŸ
å¦‚æœå¸Œæœ›å°†ä¸€ä¸ªè·¯å¾„ä¸‹` æ‰€æœ‰ å…¬æœ‰é¡¹`å¼•å…¥ä½œç”¨åŸŸï¼Œå¯ä»¥æŒ‡å®šè·¯å¾„åè·Ÿ glob è¿ç®—ç¬¦(`*`)ï¼š
```rust
use std::collections::*;
```
> ä½¿ç”¨ glob è¿ç®—ç¬¦æ—¶è¯·å¤šåŠ å°å¿ƒï¼Glob ä¼šä½¿å¾—æˆ‘ä»¬éš¾ä»¥æ¨å¯¼ä½œç”¨åŸŸä¸­æœ‰ä»€ä¹ˆåç§°å’Œå®ƒä»¬æ˜¯åœ¨ä½•å¤„å®šä¹‰çš„ã€‚
> glob è¿ç®—ç¬¦ç»å¸¸ç”¨äºæµ‹è¯•æ¨¡å— tests ä¸­ï¼Œè¿™æ—¶ä¼šå°†æ‰€æœ‰å†…å®¹å¼•å…¥ä½œç”¨åŸŸ

## 7.5 å°†æ¨¡å—æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶

æ³¨æ„ä½ åªéœ€åœ¨æ¨¡å—æ ‘ä¸­çš„æŸå¤„ä½¿ç”¨ä¸€æ¬¡ mod å£°æ˜å°±å¯ä»¥åŠ è½½è¿™ä¸ªæ–‡ä»¶ã€‚

æ¢å¥è¯è¯´ï¼Œmod ä¸æ˜¯ ä½ å¯èƒ½ä¼šåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­çœ‹åˆ°çš„ "include" æ“ä½œã€‚

# 8. å¸¸è§é›†åˆ
## 8.1 Vector

ç±»å‹ `Vec<T>` å…è®¸æˆ‘ä»¬åœ¨ä¸€ä¸ªå•ç‹¬çš„æ•°æ®ç»“æ„ä¸­å‚¨å­˜å¤šäºä¸€ä¸ªçš„å€¼ï¼Œå®ƒåœ¨`å†…å­˜ä¸­å½¼æ­¤ç›¸é‚»åœ°æ’`åˆ—æ‰€æœ‰çš„å€¼ã€‚


### Create
```rust 
    // create a empty vector
    let v: Vec<i32> = Vec::new();
    // create an initialized vector with macro 'vec!'
    let v = vec![1, 2, 3];
```

### Update
```rust
    // æ”¾å…¥å…¶ä¸­çš„æ‰€æœ‰å€¼éƒ½æ˜¯ i32 ç±»å‹çš„ï¼Œè€Œä¸” Rust ä¹Ÿæ ¹æ®æ•°æ®åšå‡ºå¦‚æ­¤åˆ¤æ–­ï¼Œæ‰€ä»¥ä¸éœ€è¦ Vec<i32> æ³¨è§£ã€‚
    let mut v = Vec::new();

    v.push(5);
    v.push(6);
    v.push(7);
    v.push(8);
```

### Access
```rust
    let v = vec![1, 2, 3, 4, 5];

    // style-1: read with index
    let third: &i32 = &v[2];

    // style-2: read with .get()
    let third: Option<&i32> = v.get(2)
    match third {
        Some(third) => println!("The third element is {third}"),
        None => println!("There is no third element."),
    }
```

> ç´¢å¼•è¯­æ³•, å½“å¼•ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å…ƒç´ æ—¶ Rust ä¼šé€ æˆ panic

#### å€Ÿç”¨è§„åˆ™ä¸è¯»å–vecå…ƒç´ 
```rust
    let mut v = vec![1, 2, 3, 4, 5];

    // è·å–äº†ä¸€ä¸ªæœ‰æ•ˆçš„å¼•ç”¨
    // immutable borrow occurs here
    let first = &v[0];

    // åœ¨ vector çš„ç»“å°¾å¢åŠ æ–°å…ƒç´ æ—¶ï¼Œåœ¨æ²¡æœ‰è¶³å¤Ÿç©ºé—´å°†æ‰€æœ‰å…ƒç´ ä¾æ¬¡ç›¸é‚»å­˜æ”¾çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šè¦æ±‚åˆ†é…æ–°å†…å­˜å¹¶å°†è€çš„å…ƒç´ æ‹·è´åˆ°æ–°çš„ç©ºé—´ä¸­ã€‚
    // è¿™æ—¶ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨å°±æŒ‡å‘äº†è¢«é‡Šæ”¾çš„å†…å­˜ã€‚
    // mutable borrow occurs here
    v.push(6);

    // immutable borrow later used here
    println!("The first element is: {first}");
```
ä¸Šè¿°ä»£ç ä¼šæŠ¥é”™ï¼š`error[E0502]: cannot borrow `v` as mutable because it is also borrowed as immutable`

> å¦‚æœæ²¡æœ‰ `println!("The first element is: {first}");` æˆ–è€…è¿™è¡Œåœ¨ `v.push(6);` ä¹‹å‰åˆ™ä¸ä¼šæœ‰é—®é¢˜

### éå† vector ä¸­çš„å…ƒç´ 
```rust
    let v = vec![100, 32, 57];
    
    // è·å– v ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ çš„ä¸å¯å˜å¼•ç”¨å¹¶å°†å…¶æ‰“å°
    for i in &v {
        println!("{i}");
    }

    // éå†å¯å˜ vector çš„æ¯ä¸€ä¸ªå…ƒç´ çš„å¯å˜å¼•ç”¨ä»¥ä¾¿èƒ½æ”¹å˜å®ƒä»¬
    let mut v = vec![100, 32, 57];
    for i in &mut v {
        // è§£å¼•ç”¨è¿ç®—ç¬¦ï¼ˆ*ï¼‰è·å– i ä¸­çš„å€¼
        *i += 50;
    }
```

> å› ä¸ºå€Ÿç”¨æ£€æŸ¥å™¨çš„è§„åˆ™ï¼Œæ— è®ºå¯å˜è¿˜æ˜¯ä¸å¯å˜åœ°éå†ä¸€ä¸ª vector éƒ½æ˜¯å®‰å…¨çš„ã€‚
> å¦‚æœå°è¯•åœ¨ for å¾ªç¯ä½“å†…`æ’å…¥æˆ–åˆ é™¤é¡¹`ï¼Œéƒ½ä¼šå¾—åˆ°`error[E0502]: cannot borrow `v` as mutable because it is also borrowed as immutable`ã€‚
> for å¾ªç¯ä¸­è·å–çš„ vector å¼•ç”¨é˜»æ­¢äº†åŒæ—¶å¯¹ `vector æ•´ä½“`çš„ä¿®æ”¹ã€‚

### ä½¿ç”¨æšä¸¾æ¥å‚¨å­˜å¤šç§ç±»å‹

vector `åªèƒ½å‚¨å­˜ç›¸åŒç±»å‹çš„å€¼`ã€‚è¿™æ˜¯å¾ˆä¸æ–¹ä¾¿çš„

ä¼šæœ‰éœ€è¦å‚¨å­˜ä¸€ç³»åˆ—ä¸åŒç±»å‹çš„å€¼çš„ç”¨ä¾‹ã€‚å¹¸è¿çš„æ˜¯ï¼Œæšä¸¾çš„æˆå‘˜éƒ½è¢«å®šä¹‰ä¸ºç›¸åŒçš„æšä¸¾ç±»å‹ï¼Œæ‰€ä»¥å½“éœ€è¦åœ¨ vector ä¸­å‚¨å­˜ä¸åŒç±»å‹å€¼æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¹¶ä½¿ç”¨ä¸€ä¸ªæšä¸¾ï¼

```rust
    enum SpreadsheetCell {
        Int(i32),
        Float(f64),
        Text(String),
    }

    let row = vec![
        SpreadsheetCell::Int(3),
        SpreadsheetCell::Float(10.12),
        SpreadsheetCell::Text(String::from("blue")),
    ];
```

Rust åœ¨ç¼–è¯‘æ—¶å°±å¿…é¡»å‡†ç¡®çš„çŸ¥é“ vector ä¸­ç±»å‹:
- å®ƒéœ€è¦çŸ¥é“å‚¨å­˜æ¯ä¸ªå…ƒç´ åˆ°åº•éœ€è¦å¤šå°‘å†…å­˜
- å¦‚æœ Rust å…è®¸ vector å­˜æ”¾ä»»æ„ç±»å‹ï¼Œé‚£ä¹ˆå½“å¯¹ vector å…ƒç´ æ‰§è¡Œæ“ä½œæ—¶ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹çš„å€¼å°±æœ‰å¯èƒ½ä¼šé€ æˆé”™è¯¯ã€‚

### ä¸¢å¼ƒ vector æ—¶ä¹Ÿä¼šä¸¢å¼ƒå…¶æ‰€æœ‰å…ƒç´ 
```rust
    {
        let v = vec![1, 2, 3, 4];

        // do stuff with v

    } // <- v goes out of scope and is freed here
      // å€Ÿç”¨æ£€æŸ¥å™¨ç¡®ä¿äº†ä»»ä½• vector ä¸­å†…å®¹çš„å¼•ç”¨ä»…åœ¨ vector æœ¬èº«æœ‰æ•ˆæ—¶æ‰å¯ç”¨ã€‚
```

## 8.2 å­—ç¬¦ä¸²(String) å’Œ UTF-8 encoded Text

Rust çš„æ ¸å¿ƒè¯­è¨€ä¸­åªæœ‰ä¸€ç§å­—ç¬¦ä¸²ç±»å‹ï¼šå­—ç¬¦ä¸² `slice str`ï¼Œå®ƒé€šå¸¸ä»¥è¢«å€Ÿç”¨çš„å½¢å¼å‡ºç°ï¼Œ&str

### æ–°å»ºå­—ç¬¦ä¸²

å¾ˆå¤š Vec å¯ç”¨çš„æ“ä½œåœ¨ String ä¸­åŒæ ·å¯ç”¨ï¼Œäº‹å®ä¸Š String è¢«å®ç°ä¸ºä¸€ä¸ªå¸¦æœ‰ä¸€äº›é¢å¤–ä¿è¯ã€é™åˆ¶å’ŒåŠŸèƒ½çš„`å­—èŠ‚ vector çš„å°è£…`ã€‚

```rust
    // new å‡½æ•°æ–°å»ºäº†ä¸€ä¸ªå«åš s çš„ç©ºçš„å­—ç¬¦ä¸²
    let mut s = String::new();

    // to_string æ–¹æ³•ï¼Œå®ƒèƒ½ç”¨äºä»»ä½•å®ç°äº† Display trait çš„ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²å­—é¢å€¼
    let data = "initial contents";
    let s = data.to_string();
    // è¯¥æ–¹æ³•ä¹Ÿå¯ç›´æ¥ç”¨äºå­—ç¬¦ä¸²å­—é¢å€¼ï¼š
    let s = "initial contents".to_string();

    // ä½¿ç”¨ String::from å‡½æ•°æ¥ä»string slice åˆ›å»º String
    let s = String::from("initial contents");

```

### æ›´æ–°å­—ç¬¦ä¸²

String çš„å¤§å°å¯ä»¥å¢åŠ ï¼Œå…¶å†…å®¹ä¹Ÿå¯ä»¥æ”¹å˜ï¼Œå°±åƒå¯ä»¥æ”¾å…¥æ›´å¤šæ•°æ®æ¥æ”¹å˜ Vec çš„å†…å®¹ä¸€æ ·ã€‚

#### push_str
```rust
    // é€šè¿‡ push_str æ–¹æ³•æ¥é™„åŠ å­—ç¬¦ä¸² sliceï¼Œä»è€Œä½¿ String å˜é•¿
    // -> foobar
    let mut s = String::from("foo");
    // "bar" æ˜¯ &str, æˆ‘ä»¬å¹¶ä¸éœ€è¦è·å–å‚æ•°çš„æ‰€æœ‰æƒ
    // å¦åˆ™ä¸‹é¢çš„println! s2å°±ä¼šå‡ºé”™
    s.push_str("bar"); 
    println!("s2 is {s2}"); 
```
#### + 
```rust
    // ä½¿ç”¨ + è¿ç®—ç¬¦ æ‹¼æ¥å­—ç¬¦ä¸²
    let s1 = String::from("Hello, ");
    let s2 = String::from("world!");
    let s3 = s1 + &s2; // æ³¨æ„ s1 è¢«ç§»åŠ¨äº†ï¼Œä¸èƒ½ç»§ç»­ä½¿ç”¨
```

+ è¿ç®—ç¬¦ä½¿ç”¨äº† add å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ç­¾åçœ‹èµ·æ¥åƒè¿™æ ·ï¼š
`fn add(self, s: &str) -> String {`

æ‰€ä»¥ `let s3 = &s1 + &s2;` ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼Œä¼šæŠ¥é”™ `Cannot add &String to &String [E0369]`

ä¹‹æ‰€ä»¥èƒ½å¤Ÿåœ¨ add è°ƒç”¨ä¸­ä½¿ç”¨ &s2 æ˜¯å› ä¸º &String å¯ä»¥è¢« å¼ºè½¬ï¼ˆcoercedï¼‰æˆ &strã€‚å½“addå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼ŒRust ä½¿ç”¨äº†ä¸€ä¸ªè¢«ç§°ä¸º `Deref å¼ºåˆ¶è½¬æ¢ï¼ˆderef coercionï¼‰`çš„æŠ€æœ¯ï¼Œä½ å¯ä»¥å°†å…¶ç†è§£ä¸ºå®ƒæŠŠ &s2 å˜æˆäº† &s2[..]

> a + b ä¼šè·å–açš„æ‰€æœ‰æƒï¼Œ å¦‚æœæƒ³è¦çº§è”å¤šä¸ªå­—ç¬¦ä¸²ï¼Œ+ çš„è¡Œä¸ºå°±æ˜¾å¾—ç¬¨é‡äº†ï¼Œå¾ˆéš¾ç†è§£å…·ä½“å‘ç”Ÿäº†ä»€ä¹ˆã€‚

#### format!
format! ä¸ println! çš„å·¥ä½œåŸç†ç›¸åŒï¼Œä¸è¿‡ä¸åŒäºå°†è¾“å‡ºæ‰“å°åˆ°å±å¹•ä¸Šï¼Œå®ƒè¿”å›ä¸€ä¸ªå¸¦æœ‰ç»“æœå†…å®¹çš„ Stringã€‚

å® format! ç”Ÿæˆçš„ä»£ç ä½¿ç”¨å¼•ç”¨æ‰€ä»¥`ä¸ä¼šè·å–ä»»ä½•å‚æ•°çš„æ‰€æœ‰æƒ`ã€‚

```rust
    let s1 = String::from("tic");
    let s2 = String::from("tac");
    let s3 = String::from("toe");

    let s = format!("{s1}-{s2}-{s3}");
```


### ç´¢å¼•å­—ç¬¦ä¸²

Rust çš„å­—ç¬¦ä¸²ä¸æ”¯æŒç´¢å¼•ï¼Œå¦‚`let h = s[0]`, ç´¢å¼•å­—ç¬¦ä¸²é€šå¸¸æ˜¯ä¸€ä¸ªåç‚¹å­ï¼Œå› ä¸ºå­—ç¬¦ä¸²ç´¢å¼•åº”è¯¥è¿”å›çš„ç±»å‹æ˜¯ä¸æ˜ç¡®çš„ï¼šå­—èŠ‚å€¼ã€å­—ç¬¦ã€å­—å½¢ç°‡æˆ–è€…å­—ç¬¦ä¸² sliceã€‚

å¦‚æœä½ çœŸçš„å¸Œæœ›ä½¿ç”¨ç´¢å¼•åˆ›å»ºå­—ç¬¦ä¸² slice æ—¶ï¼ŒRust ä¼šè¦æ±‚ä½ æ›´æ˜ç¡®ä¸€äº›ã€‚ä¸ºäº†æ›´æ˜ç¡®ç´¢å¼•å¹¶è¡¨æ˜ä½ éœ€è¦ä¸€ä¸ªå­—ç¬¦ä¸² sliceï¼Œå¯ä»¥ä½¿ç”¨ [] å’Œä¸€ä¸ª range æ¥åˆ›å»ºå«ç‰¹å®šå­—èŠ‚çš„å­—ç¬¦ä¸² sliceï¼š

```rust
let hello = "Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ";

let s = &hello[0..4];
```
è¿™é‡Œï¼Œs ä¼šæ˜¯ä¸€ä¸ª &strï¼Œå®ƒåŒ…å«å­—ç¬¦ä¸²çš„å¤´å››ä¸ªå­—èŠ‚ã€‚æ—©äº›æ—¶å€™ï¼Œæˆ‘ä»¬æåˆ°äº†è¿™äº›å­—æ¯éƒ½æ˜¯ä¸¤ä¸ªå­—èŠ‚é•¿çš„ï¼Œæ‰€ä»¥è¿™æ„å‘³ç€ s å°†ä¼šæ˜¯ â€œĞ—Ğ´â€ã€‚

å¦‚æœè·å– &hello[0..1] ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼šRust åœ¨è¿è¡Œæ—¶ä¼š panicï¼Œå°±è·Ÿè®¿é—® vector ä¸­çš„æ— æ•ˆç´¢å¼•æ—¶ä¸€æ ·ï¼š`thread 'main' panicked at 'byte index 1 is not a char boundary; it is inside 'Ğ—'`

### éå†å­—ç¬¦ä¸²çš„æ–¹æ³•
æ“ä½œå­—ç¬¦ä¸²æ¯ä¸€éƒ¨åˆ†çš„æœ€å¥½çš„æ–¹æ³•æ˜¯æ˜ç¡®è¡¨ç¤ºéœ€è¦å­—ç¬¦è¿˜æ˜¯å­—èŠ‚ã€‚

```rust
// Ğ—
// Ğ´
for c in "Ğ—Ğ´".chars() {
    println!("{c}");
}

// 208
// 151
// 208
// 180
for b in "Ğ—Ğ´".bytes() {
    println!("{b}");
}

```

## 8.3 HashMap and Key-Value entry

HashMap<K, V> ç±»å‹å‚¨å­˜äº†ä¸€ä¸ªé”®ç±»å‹ K å¯¹åº”ä¸€ä¸ªå€¼ç±»å‹ V çš„æ˜ å°„ã€‚å®ƒé€šè¿‡ä¸€ä¸ª å“ˆå¸Œå‡½æ•°ï¼ˆhashing functionï¼‰æ¥å®ç°æ˜ å°„ï¼Œå†³å®šå¦‚ä½•å°†é”®å’Œå€¼æ”¾å…¥å†…å­˜ä¸­ã€‚

### æ–°å»ºä¸€ä¸ªå“ˆå¸Œ map
```rust
    use std::collection::HashMap;

    let mut scores = HashMap::new();

    // push an entry
    scores.insert(String::from("Blue"), 10);
    scores.insert(String::from("Yellow"), 50);
```

> æ³¨æ„å¿…é¡»é¦–å…ˆ use æ ‡å‡†åº“ä¸­é›†åˆéƒ¨åˆ†çš„ HashMapã€‚åœ¨è¿™ä¸‰ä¸ªå¸¸ç”¨é›†åˆä¸­ï¼ŒHashMap æ˜¯æœ€ä¸å¸¸ç”¨çš„ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰è¢« prelude è‡ªåŠ¨å¼•ç”¨ã€‚
> æ ‡å‡†åº“ä¸­å¯¹ HashMap çš„æ”¯æŒä¹Ÿç›¸å¯¹è¾ƒå°‘ï¼Œä¾‹å¦‚ï¼Œå¹¶æ²¡æœ‰å†…å»ºçš„æ„å»ºå®ã€‚

### è®¿é—®å“ˆå¸Œ map ä¸­çš„å€¼
```rust
    use std::collections::HashMap;

    let mut scores = HashMap::new();

    scores.insert(String::from("Blue"), 10);
    scores.insert(String::from("Yellow"), 50);

    let score = scores.get(&String::from("Blue"))
                      .copied()
                      .unwrap_or(0);
```
- get æ–¹æ³•è¿”å› Option<&V>, å¦‚æœæŸä¸ªé”®åœ¨å“ˆå¸Œ map ä¸­æ²¡æœ‰å¯¹åº”çš„å€¼ï¼Œget ä¼šè¿”å› None
- copied æ–¹æ³•æ¥è·å–ä¸€ä¸ª Option<i32> è€Œä¸æ˜¯ Option<&i32>
- unwrap_oråœ¨ scores ä¸­æ²¡æœ‰è¯¥é”®æ‰€å¯¹åº”çš„é¡¹æ—¶å°†å…¶è®¾ç½®ä¸ºé›¶ã€‚

å¯ä»¥ä½¿ç”¨ä¸ vector ç±»ä¼¼çš„æ–¹å¼æ¥`éå†`å“ˆå¸Œ map ä¸­çš„æ¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œä¹Ÿå°±æ˜¯ for å¾ªç¯ï¼š
```rust
    for (key, value) in &scores {
        println!("{key}: {value}");
    }
```

### å“ˆå¸Œ map å’Œæ‰€æœ‰æƒ
å¯¹äºåƒ i32 è¿™æ ·çš„å®ç°äº† Copy trait çš„ç±»å‹ï¼Œå…¶å€¼å¯ä»¥æ‹·è´è¿›å“ˆå¸Œ mapã€‚
å¯¹äºåƒ String è¿™æ ·æ‹¥æœ‰æ‰€æœ‰æƒçš„å€¼ï¼Œå…¶å€¼å°†è¢«ç§»åŠ¨è€Œ`å“ˆå¸Œ map ä¼šæˆä¸ºè¿™äº›å€¼çš„æ‰€æœ‰è€…`ï¼Œ

```rust
    use std::collections::HashMap;

    let field_name = String::from("Favorite color");
    let field_value = String::from("Blue");

    let mut map = HashMap::new();
    map.insert(field_name, field_value);
    // è¿™é‡Œ field_name å’Œ field_value ä¸å†æœ‰æ•ˆï¼Œ
```

> å¦‚æœå°†å€¼çš„å¼•ç”¨æ’å…¥å“ˆå¸Œ mapï¼Œè¿™äº›å€¼æœ¬èº«å°†ä¸ä¼šè¢«ç§»åŠ¨è¿›å“ˆå¸Œ mapã€‚
> ä½†æ˜¯è¿™äº›å¼•ç”¨æŒ‡å‘çš„å€¼å¿…é¡»è‡³å°‘åœ¨å“ˆå¸Œ map æœ‰æ•ˆæ—¶ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚

### æ›´æ–°å“ˆå¸Œ map

å½“æˆ‘ä»¬æƒ³è¦æ”¹å˜å“ˆå¸Œ map ä¸­çš„æ•°æ®æ—¶ï¼Œå¿…é¡»å†³å®šå¦‚ä½•å¤„ç†ä¸€ä¸ªé”®å·²ç»æœ‰å€¼äº†çš„æƒ…å†µ:
- å¯ä»¥é€‰æ‹©å®Œå…¨æ— è§†æ—§å€¼å¹¶ç”¨æ–°å€¼ä»£æ›¿æ—§å€¼ã€‚-> insert
- å¯ä»¥é€‰æ‹©ä¿ç•™æ—§å€¼è€Œå¿½ç•¥æ–°å€¼ï¼Œå¹¶åªåœ¨é”® æ²¡æœ‰ å¯¹åº”å€¼æ—¶å¢åŠ æ–°å€¼ã€‚ -> entry().or_insert()
- å¯ä»¥ç»“åˆæ–°æ—§ä¸¤å€¼ã€‚-> 

```rust
    use std::collection::HashMap;

    let mut scores = HashMap::new();

    // å®Œå…¨æ— è§†æ—§å€¼å¹¶ç”¨æ–°å€¼ä»£æ›¿æ—§å€¼
    scores.insert(String::from("Blue"), 10);
    scores.insert(String::from("Blue"), 25);
    
    // ä¿ç•™æ—§å€¼è€Œå¿½ç•¥æ–°å€¼
    // å¯¹åº”çš„å€¼å­˜åœ¨æ—¶å°±è¿”å›è¿™ä¸ªå€¼çš„å¯å˜å¼•ç”¨, æ²¡æœ‰ å¯¹åº”å€¼æ—¶å¢åŠ æ–°å€¼
    scores.entry(String::from("Blue")).or_insert(50);
    
    // æ‰¾åˆ°ä¸€ä¸ªé”®å¯¹åº”çš„å€¼å¹¶æ ¹æ®æ—§çš„å€¼æ›´æ–°å®ƒ
    // è®¡æ•°ä¸€äº›æ–‡æœ¬ä¸­æ¯ä¸€ä¸ªå•è¯åˆ†åˆ«å‡ºç°äº†å¤šå°‘æ¬¡
    let text = "hello world wonderful world";
    let mut map = HashMap::new();
    for word in text.split_whitespace() {
        let count = map.entry(word).or_insert(0);
        // ä¸ºäº†èµ‹å€¼å¿…é¡»é¦–å…ˆä½¿ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰è§£å¼•ç”¨ count
        *count += 1;
    }

```

### å“ˆå¸Œå‡½æ•°
HashMap é»˜è®¤ä½¿ç”¨ä¸€ç§å«åš `SipHash` çš„å“ˆå¸Œå‡½æ•°ï¼Œå®ƒå¯ä»¥æŠµå¾¡æ¶‰åŠå“ˆå¸Œè¡¨ï¼ˆhash tableï¼‰1 çš„æ‹’ç»æœåŠ¡ï¼ˆDenial of Service, DoSï¼‰æ”»å‡»

> æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆDenial of Serviceï¼Œç¼©å†™ä¸ºDoSï¼‰æ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»ï¼Œæ—¨åœ¨ä½¿ç›®æ ‡ç³»ç»Ÿã€ç½‘ç»œæˆ–æœåŠ¡ä¸å¯ç”¨ï¼Œä»è€Œé˜»æ­¢åˆæ³•ç”¨æˆ·è®¿é—®æˆ–ä½¿ç”¨è¿™äº›èµ„æºã€‚è¿™ç±»æ”»å‡»çš„ç›®æ ‡æ˜¯ç ´åç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€å‰Šå¼±æ€§èƒ½ã€æˆ–å®Œå…¨ä½¿å…¶åœæ­¢å“åº”è¯·æ±‚ã€‚æ‹’ç»æœåŠ¡æ”»å‡»é€šå¸¸ä¸æ¶‰åŠå¯¹ç³»ç»Ÿçš„æœªç»æˆæƒè®¿é—®æˆ–æ•°æ®ç›—çªƒï¼Œè€Œæ˜¯ä¸“æ³¨äºç˜«ç—ªæˆ–å¹²æ‰°ç›®æ ‡ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚
> åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆDDoSï¼ŒDistributed Denial of Serviceï¼‰æ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»ï¼Œå®ƒæ—¨åœ¨é€šè¿‡åŒæ—¶ä»å¤šä¸ªæ¥æºå‘é€å¤§é‡è¯·æ±‚æˆ–æ•°æ®æµé‡ï¼Œä½¿ç›®æ ‡ç³»ç»Ÿã€ç½‘ç»œæˆ–æœåŠ¡ä¸å¯ç”¨ã€‚

# 9.é”™è¯¯å¤„ç†
Rust å°†é”™è¯¯åˆ†ä¸ºä¸¤å¤§ç±»ï¼š
- å¯æ¢å¤çš„ï¼ˆrecoverableï¼‰: å¯¹äºä¸€ä¸ªå¯æ¢å¤çš„é”™è¯¯ï¼Œæ¯”å¦‚æ–‡ä»¶æœªæ‰¾åˆ°çš„é”™è¯¯ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½åªæƒ³å‘ç”¨æˆ·æŠ¥å‘Šé—®é¢˜å¹¶é‡è¯•æ“ä½œã€‚
- ä¸å¯æ¢å¤çš„ï¼ˆunrecoverableï¼‰: é”™è¯¯ä¸å¯æ¢å¤çš„é”™è¯¯æ€»æ˜¯ bug å‡ºç°çš„å¾å…†ï¼Œæ¯”å¦‚è¯•å›¾è®¿é—®ä¸€ä¸ªè¶…è¿‡æ•°ç»„æœ«ç«¯çš„ä½ç½®ï¼Œå› æ­¤æˆ‘ä»¬è¦ç«‹å³åœæ­¢ç¨‹åºã€‚


`Rust æ²¡æœ‰å¼‚å¸¸`ã€‚
ç›¸åï¼Œå®ƒæœ‰ `Result<T, E>` ç±»å‹ï¼Œç”¨äºå¤„ç†å¯æ¢å¤çš„é”™è¯¯ï¼Œ
è¿˜æœ‰ `panic!` å®ï¼Œåœ¨ç¨‹åºé‡åˆ°ä¸å¯æ¢å¤çš„é”™è¯¯æ—¶åœæ­¢æ‰§è¡Œã€‚

æœ¬ç« é¦–å…ˆä»‹ç» `panic!` è°ƒç”¨ï¼Œæ¥ç€ä¼šè®²åˆ°å¦‚ä½•è¿”å› `Result<T, E>`ã€‚

## 9.1 ç”¨ panic! å¤„ç†ä¸å¯æ¢å¤çš„é”™è¯¯
åœ¨å®è·µä¸­æœ‰ä¸¤ç§æ–¹æ³•é€ æˆ panicï¼š
- æ‰§è¡Œä¼šé€ æˆä»£ç  panic çš„æ“ä½œï¼ˆæ¯”å¦‚è®¿é—®è¶…è¿‡æ•°ç»„ç»“å°¾çš„å†…å®¹ï¼‰
- æ˜¾å¼è°ƒç”¨ panic! å®ã€‚

é€šå¸¸æƒ…å†µä¸‹è¿™äº› panic ä¼šæ‰“å°å‡ºä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œå±•å¼€å¹¶æ¸…ç†æ ˆæ•°æ®ï¼Œç„¶åé€€å‡ºã€‚

#### å¯¹åº” panic æ—¶çš„æ ˆå±•å¼€æˆ–ç»ˆæ­¢
å½“å‡ºç° panic æ—¶ï¼Œç¨‹åºä¼š:
- é»˜è®¤: å±•å¼€ï¼ˆunwindingï¼‰,Rust ä¼šå›æº¯æ ˆå¹¶æ¸…ç†å®ƒé‡åˆ°çš„æ¯ä¸€ä¸ªå‡½æ•°çš„æ•°æ®
- ç›´æ¥ ç»ˆæ­¢ï¼ˆabortï¼‰ï¼Œè¿™ä¼šä¸æ¸…ç†æ•°æ®å°±é€€å‡ºç¨‹åºã€‚ç¨‹åºæ‰€ä½¿ç”¨çš„å†…å­˜éœ€è¦ç”±æ“ä½œç³»ç»Ÿæ¥æ¸…ç†ã€‚

å¦‚æœä½ éœ€è¦é¡¹ç›®çš„æœ€ç»ˆäºŒè¿›åˆ¶æ–‡ä»¶è¶Šå°è¶Šå¥½, å¯ä»¥ç”±`å±•å¼€`åˆ‡æ¢ä¸º`ç»ˆæ­¢`ã€‚
```rust
// åœ¨ release æ¨¡å¼ä¸­ panic æ—¶ç›´æ¥ç»ˆæ­¢
[profile.release]
panic = 'abort'
```

### ä½¿ç”¨ panic! çš„ backtrace

`RUST_BACKTRACE` æ˜¯ä¸€ä¸ªç”¨äº Rust ç¨‹åºçš„ç¯å¢ƒå˜é‡ï¼Œå®ƒç”¨äºæ§åˆ¶ç¨‹åºåœ¨å‘ç”Ÿ panicï¼ˆææ…Œï¼‰æ—¶ç”Ÿæˆå †æ ˆè·Ÿè¸ªä¿¡æ¯ã€‚

å †æ ˆè·Ÿè¸ªä¿¡æ¯æ˜¾ç¤ºäº†ç¨‹åºåœ¨å“ªé‡Œå‘ç”Ÿäº† panicï¼Œå¸®åŠ©å¼€å‘äººå‘˜å®šä½é—®é¢˜å¹¶è¿›è¡Œè°ƒè¯•ã€‚

å…·ä½“æ¥è¯´ï¼ŒRUST_BACKTRACE ç¯å¢ƒå˜é‡æœ‰ä»¥ä¸‹å€¼ï¼š

- `RUST_BACKTRACE=0`ï¼šè¿™æ˜¯`é»˜è®¤å€¼`ã€‚åœ¨å‘ç”Ÿ panic æ—¶ï¼Œç¨‹åºä¸ä¼šç”Ÿæˆå †æ ˆè·Ÿè¸ªä¿¡æ¯ã€‚

- `RUST_BACKTRACE=1`ï¼šå½“å‘ç”Ÿ panic æ—¶ï¼Œç¨‹åºä¼šç”Ÿæˆç®€å•çš„å †æ ˆè·Ÿè¸ªä¿¡æ¯ï¼Œæ˜¾ç¤º panic å‘ç”Ÿçš„ä½ç½®ï¼ˆå‡½æ•°è°ƒç”¨é“¾ï¼‰ï¼Œä½†ä¸ä¼šåŒ…æ‹¬æºä»£ç è¡Œå·ä¿¡æ¯ã€‚

- `RUST_BACKTRACE=full`ï¼šå½“å‘ç”Ÿ panic æ—¶ï¼Œç¨‹åºä¼šç”Ÿæˆè¯¦ç»†çš„å †æ ˆè·Ÿè¸ªä¿¡æ¯ï¼ŒåŒ…æ‹¬æºä»£ç è¡Œå·ä¿¡æ¯ï¼Œå¸®åŠ©ä½ æ›´å®¹æ˜“åœ°è¿½è¸ªé—®é¢˜ã€‚

è®¾ç½® `RUST_BACKTRACE=1` æˆ– `RUST_BACKTRACE=full` å¯ä»¥`åœ¨å¼€å‘å’Œè°ƒè¯•é˜¶æ®µ`å¸®åŠ©ä½ å¿«é€Ÿå®šä½å’Œä¿®å¤ç¨‹åºä¸­çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç† panic æˆ–é”™è¯¯æ—¶ï¼Œè¿™äº›å †æ ˆè·Ÿè¸ªä¿¡æ¯å¯¹äºæ‰¾å‡ºé—®é¢˜çš„åŸå› éå¸¸æœ‰å¸®åŠ©ã€‚

ä½†`åœ¨ç”Ÿäº§ç¯å¢ƒä¸­`ï¼Œé€šå¸¸åº”å°†å…¶è®¾ç½®ä¸ºé»˜è®¤å€¼ `RUST_BACKTRACE=0`ï¼Œä»¥é¿å…æ³„æ¼æ•æ„Ÿä¿¡æ¯ï¼Œå¹¶æé«˜ç¨‹åºçš„æ€§èƒ½ã€‚

#### è®¾ç½® RUST_BACKTRACE ç¯å¢ƒå˜é‡
1. `å‘½ä»¤è¡Œå‚æ•°ï¼š`ä½ å¯ä»¥åœ¨è¿è¡Œ Rust ç¨‹åºçš„å‘½ä»¤è¡Œä¸­ç›´æ¥è®¾ç½® RUST_BACKTRACE ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚ï¼š
   ```bash
   RUST_BACKTRACE=1 ./your_rust_program
   ```
2. `Unix/Linux çš„shellç¯å¢ƒå˜é‡ï¼š`ä½ å¯ä»¥åœ¨ç»ˆç«¯ä¸­è®¾ç½® RUST_BACKTRACE ç¯å¢ƒå˜é‡ï¼Œç„¶åè¿è¡Œç¨‹åºï¼Œä¾‹å¦‚ï¼š
    ```bash
    export RUST_BACKTRACE=1
    ./your_rust_program
    ```
3. `.env æ–‡ä»¶(recommended)ï¼š`ä½ å¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º .env çš„æ–‡ä»¶ï¼Œç„¶ååœ¨å…¶ä¸­è®¾ç½® RUST_BACKTRACE ç¯å¢ƒå˜é‡ã€‚è¿™å¯¹äºé¡¹ç›®ç‰¹å®šçš„é…ç½®éå¸¸æœ‰ç”¨ã€‚
åœ¨ .env æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š
    ```makefile
    RUST_BACKTRACE=1
    ```
    ç„¶ååœ¨è¿è¡Œ Rust ç¨‹åºä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·ï¼ˆå¦‚ dotenvï¼‰åŠ è½½ .env æ–‡ä»¶ä»¥è®¾ç½®ç¯å¢ƒå˜é‡ã€‚
4. ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼šä½ è¿˜å¯ä»¥åœ¨æ“ä½œç³»ç»Ÿçº§åˆ«è®¾ç½® RUST_BACKTRACE ç¯å¢ƒå˜é‡ï¼Œè¿™å°†å½±å“æ•´ä¸ªç³»ç»Ÿä¸Šçš„ Rust ç¨‹åºã€‚
   ä¾‹å¦‚ï¼Œåœ¨Unix/Linuxç³»ç»Ÿä¸­ï¼Œä½ å¯ä»¥ç¼–è¾‘ ~/.bashrc æˆ– ~/.bash_profile æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹è¡Œï¼š
   ```bash
   export RUST_BACKTRACE=1
   ```

## 9.2 ç”¨ Result å¤„ç†å¯æ¢å¤çš„é”™è¯¯

Result æšä¸¾ï¼Œå®ƒå®šä¹‰æœ‰å¦‚ä¸‹ä¸¤ä¸ªæˆå‘˜ï¼ŒOk å’Œ Errï¼š
```rust
enum Result<T, E> {
    Ok(T),
    Err(E),
}
```

`T` å’Œ `E` æ˜¯æ³›å‹ç±»å‹å‚æ•°.  `T` ä»£è¡¨æˆåŠŸæ—¶è¿”å›çš„ Ok æˆå‘˜ä¸­çš„æ•°æ®çš„ç±»å‹ï¼Œè€Œ `E` ä»£è¡¨å¤±è´¥æ—¶è¿”å›çš„ Err æˆå‘˜ä¸­çš„é”™è¯¯çš„ç±»å‹ã€‚


å¦‚ç¤ºä¾‹æ‰€ç¤ºæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶:
```rust
use std::fs::File;

fn main() {
    let greeting_file_result = File::open("hello.txt");

    let greeting_file = match greeting_file_result {
        // æˆåŠŸæ—¶ greeting_file_result å˜é‡å°†ä¼šæ˜¯ä¸€ä¸ªåŒ…å«æ–‡ä»¶å¥æŸ„çš„ Ok å®ä¾‹
        Ok(file) => file,
        // å¤±è´¥æ—¶ï¼Œgreeting_file_result å˜é‡å°†ä¼šæ˜¯ä¸€ä¸ªåŒ…å«äº†æ›´å¤šå…³äºå‘ç”Ÿäº†ä½•ç§é”™è¯¯çš„ä¿¡æ¯çš„ Err å®ä¾‹ã€‚
        Err(error) => panic!("Problem opening the file: {:?}", error),
    };
}
```

> Result æšä¸¾å’Œå…¶æˆå‘˜ä¹Ÿè¢«å¯¼å…¥åˆ°äº† prelude ä¸­ï¼Œæ‰€ä»¥å°±ä¸éœ€è¦åœ¨ match åˆ†æ”¯ä¸­çš„ Ok å’Œ Err ä¹‹å‰æŒ‡å®š Result::ã€‚

### åŒ¹é…ä¸åŒçš„é”™è¯¯
ä¸Šè¿°ä»£ç ä¸ç®¡ File::open æ˜¯å› ä¸ºä»€ä¹ˆåŸå› å¤±è´¥éƒ½ä¼š panic!ã€‚

æˆ‘ä»¬çœŸæ­£å¸Œæœ›çš„æ˜¯å¯¹ä¸åŒçš„é”™è¯¯åŸå› é‡‡å–ä¸åŒçš„è¡Œä¸ºï¼š
- å¦‚æœ File::open å› ä¸ºæ–‡ä»¶ä¸å­˜åœ¨è€Œå¤±è´¥ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ›å»ºè¿™ä¸ªæ–‡ä»¶å¹¶è¿”å›æ–°æ–‡ä»¶çš„å¥æŸ„ã€‚
- å¦‚æœ File::open å› ä¸ºä»»ä½•å…¶ä»–åŸå› å¤±è´¥ï¼Œä¾‹å¦‚æ²¡æœ‰æ‰“å¼€æ–‡ä»¶çš„æƒé™ï¼Œæˆ‘ä»¬ä»ç„¶å¸Œæœ›åƒç¤ºä¾‹ 9-4 é‚£æ · panic!

```rust
use std::fs::File;
use std::io::ErrorKind;

fn main() {
    let greeting_file_result = File::open("hello.txt");

    let greeting_file = match greeting_file_result {
        Ok(file) => file,
        Err(error) => match error.kind() {
            // å°è¯•é€šè¿‡ File::create åˆ›å»ºæ–‡ä»¶ã€‚
            // ç„¶è€Œå› ä¸º File::create ä¹Ÿå¯èƒ½ä¼šå¤±è´¥ï¼Œè¿˜éœ€è¦å¢åŠ ä¸€ä¸ªå†…å±‚ match è¯­å¥ã€‚
            ErrorKind::NotFound => match File::create("hello.txt") {
                Ok(fc) => fc,
                Err(e) => panic!("Problem creating the file: {:?}", e),
            },
            other_error => {
                panic!("Problem opening the file: {:?}", other_error);
            }
        },
    };
}
```

#### ä½¿ç”¨é—­åŒ…ä»£æ›¿matchå’ŒResult<T, E>
ä¸Šè¿°ä»£ç å¯ä»¥è¢«æ”¹å†™ä¸º:

```rust
use std::fs::File;
use std::io::ErrorKind;

fn main() {
    let greeting_file = File::open("hello.txt").unwrap_or_else(|error| {
        if error.kind() == ErrorKind::NotFound {
            File::create("hello.txt").unwrap_or_else(|error| {
                panic!("Problem creating the file: {:?}", error);
            })
        } else {
            panic!("Problem opening the file: {:?}", error);
        }
    });
}
```
`unwrap_or_else` ç”¨äºå¤„ç†å¯èƒ½çš„é”™è¯¯æƒ…å†µæˆ–Optionä¸­çš„Noneå€¼, å…è®¸ä½ ä»Optionæˆ–Resultä¸­è·å–å€¼: 
- å¦‚æœå€¼å­˜åœ¨ï¼Œå°±è¿”å›å®ƒï¼›
- å¦‚æœå€¼ä¸å­˜åœ¨ï¼ˆOptionä¸ºNoneæˆ–Resultä¸ºErrï¼‰ï¼Œåˆ™å¯ä»¥æä¾›ä¸€ä¸ªé—­åŒ…ï¼ˆclosureï¼‰ä½œä¸ºå‚æ•°ï¼Œä»¥ç”Ÿæˆæˆ–è®¡ç®—ä¸€ä¸ªæ›¿ä»£å€¼æ¥ä»£æ›¿é”™è¯¯å€¼æˆ–Noneã€‚

```rust
fn unwrap_or_else<F>(self, op: F) -> T
```
- self è¡¨ç¤ºä¸€ä¸ªOptionæˆ–Resultç±»å‹çš„å®ä¾‹ï¼Œå³è¦æ“ä½œçš„å€¼ã€‚
- op æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œç”¨äºç”Ÿæˆæ›¿ä»£å€¼çš„é€»è¾‘ã€‚è¿™ä¸ªé—­åŒ…ä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œè¿”å›ç±»å‹å¿…é¡»ä¸Optionä¸­çš„å€¼ç±»å‹æˆ–Resultä¸­çš„Okå€¼ç±»å‹åŒ¹é…ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œå®ƒä¼šè¿”å›æ›¿ä»£å€¼ã€‚

ç¤ºä¾‹1 - å¤„ç†Optionï¼š
```rust
let maybe_value: Option<i32> = Some(42);
let default_value = 0;
let result = maybe_value.unwrap_or_else(|| default_value * 2);
// å¦‚æœmaybe_valueåŒ…å«Some(42)ï¼Œåˆ™resultä¸º42ï¼Œå¦åˆ™ä¸º0 * 2 = 0
```

ç¤ºä¾‹2 - å¤„ç†Resultï¼š
```rust
fn potentially_fallible_operation() -> Result<i32, &'static str> {
    // æ¨¡æ‹Ÿå¯èƒ½å¤±è´¥çš„æ“ä½œ
    Err("Something went wrong")
}

let result = potentially_fallible_operation();
let default_result = 100;
let final_result = result.unwrap_or_else(|err| {
    println!("Error: {}", err);
    default_result
});
// å¦‚æœpotentially_fallible_operation()è¿”å›Err("Something went wrong")ï¼Œfinal_resultä¸º100ï¼Œå¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚

```

> ä¸Šè¿°ä»£ç ä¸­çš„||, |err|çš„ ||æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„

`||` ç”¨äºåŒ…è£¹é—­åŒ…çš„å‚æ•°ï¼š
- `||`ï¼šè¿™æ˜¯ä¸€ä¸ªç©ºå‚æ•°åˆ—è¡¨çš„é—­åŒ…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè¡¨ç¤ºä¸æ¥å—ä»»ä½•å‚æ•°ã€‚é—­åŒ…å†…éƒ¨çš„é€»è¾‘ä¸ä¾èµ–äºå¤–éƒ¨çš„å‚æ•°ã€‚
- `|err|`: è¿™æ˜¯ä¸€ä¸ªå¸¦æœ‰å‚æ•°çš„é—­åŒ…ï¼Œå…¶ä¸­err æ˜¯é—­åŒ…çš„å‚æ•°åã€‚å®ƒè¡¨ç¤ºé—­åŒ…æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°ç”¨äºå¤„ç†å‡½æ•°å†…éƒ¨çš„é€»è¾‘ã€‚


### å¤±è´¥æ—¶ panic çš„ç®€å†™ï¼šunwrap å’Œ expect

`unwrap`: 
- å¦‚æœ Result å€¼æ˜¯æˆå‘˜ Okï¼Œunwrap ä¼šè¿”å› Ok ä¸­çš„å€¼ã€‚
- å¦‚æœ Result æ˜¯æˆå‘˜ Errï¼Œunwrap ä¼šä¸ºæˆ‘ä»¬è°ƒç”¨ panic!

```rust
use std::fs::File;

fn main() {
    let greeting_file = File::open("hello.txt").unwrap();
}
```

expect:
- å¦‚æœ Result å€¼æ˜¯æˆå‘˜ Okï¼Œunwrap ä¼šè¿”å› Ok ä¸­çš„å€¼ã€‚
- å¦‚æœå®é™…æ˜¯ Err åˆ†æ”¯ï¼Œå®ƒå°†å¼•å‘ panicã€‚expect æ–¹æ³•å°†åœ¨æ ‡å‡†é”™è¯¯æµä¸­è¾“å‡ºæŒ‡å®šçš„é”™è¯¯æ¶ˆæ¯ï¼Œç„¶åç»ˆæ­¢ç¨‹åºçš„æ‰§è¡Œã€‚
```rust
use std::fs::File;

fn main() {
    let greeting_file = File::open("hello.txt")
        .expect("hello.txt should be included in this project");
}
```

> expect åœ¨è°ƒç”¨ panic! æ—¶ä½¿ç”¨çš„é”™è¯¯ä¿¡æ¯å°†æ˜¯æˆ‘ä»¬ä¼ é€’ç»™ expect çš„å‚æ•°ï¼Œè€Œä¸åƒ unwrap é‚£æ ·ä½¿ç”¨é»˜è®¤çš„ panic! ä¿¡æ¯ã€‚
> åœ¨ç”Ÿäº§çº§åˆ«çš„ä»£ç ä¸­ï¼Œå¤§å¤šæ•°Rustaceansé€‰æ‹©Expectè€Œä¸æ˜¯Unrapï¼Œå¹¶ç»™å‡ºäº†æ›´å¤šå…³äºä¸ºä»€ä¹ˆé¢„æœŸæ“ä½œæ€»æ˜¯æˆåŠŸçš„ä¸Šä¸‹æ–‡ã€‚

### ä¼ æ’­é”™è¯¯
å½“ç¼–å†™ä¸€ä¸ªå…¶å®å…ˆä¼šè°ƒç”¨ä¸€äº›å¯èƒ½ä¼šå¤±è´¥çš„æ“ä½œçš„å‡½æ•°æ—¶ï¼Œé™¤äº†åœ¨è¿™ä¸ªå‡½æ•°ä¸­å¤„ç†é”™è¯¯å¤–ï¼Œè¿˜å¯ä»¥é€‰æ‹©è®©è°ƒç”¨è€…çŸ¥é“è¿™ä¸ªé”™è¯¯å¹¶å†³å®šè¯¥å¦‚ä½•å¤„ç†ã€‚è¿™è¢«ç§°ä¸º ä¼ æ’­ï¼ˆpropagatingï¼‰é”™è¯¯ã€‚
> ç±»ä¼¼äºjavaä¸­çš„æŠ›å‡ºå¼‚å¸¸ï¼Œä½œä¸ºä¸­é—´ç¯èŠ‚çš„ç¨‹åºå‘˜å¹¶ä¸éœ€è¦æ€»æ˜¯åœ¨è‡ªå·±çš„ç¯èŠ‚å¤„ç†æ‰€æœ‰å¯èƒ½çš„é”™è¯¯ã€‚


```rust
use std::fs::File;
use std::io::{self, Read};

// å±•ç¤ºäº†ä¸€ä¸ªä»æ–‡ä»¶ä¸­è¯»å–ç”¨æˆ·åçš„å‡½æ•°ã€‚
// Note: è¿”å›å€¼ç±»å‹ä¸ºResult<String, io::Error>
fn read_username_from_file() -> Result<String, io::Error> {
    let username_file_result = File::open("hello.txt");

    let mut username_file = match username_file_result {
        Ok(file) => file,
        // å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨, å°†é”™è¯¯è¿”å›ç»™è°ƒç”¨å®ƒçš„ä»£ç 
        Err(e) => return Err(e),
    };

    let mut username = String::new();

    match username_file.read_to_string(&mut username) {
        Ok(_) => Ok(username),
        // ä¸èƒ½è¯»å–, å°†é”™è¯¯è¿”å›ç»™è°ƒç”¨å®ƒçš„ä»£ç 
        Err(e) => Err(e),
    }
}
```

> è¿™é‡Œé€‰æ‹© io::Error ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼æ˜¯å› ä¸ºå®ƒæ­£å¥½æ˜¯å‡½æ•°ä½“ä¸­é‚£ä¸¤ä¸ªå¯èƒ½ä¼šå¤±è´¥çš„æ“ä½œçš„é”™è¯¯è¿”å›å€¼ï¼šFile::open å’Œ read_to_string ã€‚

### ä¼ æ’­é”™è¯¯çš„ç®€å†™ï¼š? è¿ç®—ç¬¦

ä½¿ç”¨ `? `è¿ç®—ç¬¦æ”¹å†™ä¸ŠèŠ‚çš„`read_username_from_file`ä»£ç :
```rust
use std::fs::File;
use std::io::{self, Read};

fn read_username_from_file() -> Result<String, io::Error> {
    let mut username_file = File::open("hello.txt")?;
    let mut username = String::new();
    username_file.read_to_string(&mut username)?;
    Ok(username)
}
```
Rust ä¸­çš„ ? è¿ç®—ç¬¦ç”¨äºå¤„ç† Result ç±»å‹ï¼Œç‰¹åˆ«æ˜¯åœ¨å‡½æ•°ä¸­å¤„ç†å¯èƒ½å¼•å‘é”™è¯¯çš„æ“ä½œã€‚

? è¿ç®—ç¬¦çš„ä¸»è¦ä½œç”¨æ˜¯å°† Result ç±»å‹çš„ç»“æœè§£åŒ…ï¼š
- å¦‚æœç»“æœæ˜¯ Ok åˆ™å°† Ok åˆ†æ”¯çš„å€¼è¿”å›
- å¦‚æœç»“æœæ˜¯ Err åˆ™å°† Err åˆ†æ”¯çš„é”™è¯¯å€¼ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ï¼Œå¹¶ç”¨ ? è¿ç®—ç¬¦æ—©æœŸè¿”å›ï¼ˆå³æå‰ä»å‡½æ•°ä¸­è¿”å›é”™è¯¯ï¼‰ã€‚

æˆ‘ä»¬ç”šè‡³å¯ä»¥åœ¨ ? ä¹‹åç›´æ¥ä½¿ç”¨`é“¾å¼æ–¹æ³•`è°ƒç”¨æ¥è¿›ä¸€æ­¥ç¼©çŸ­ä»£ç :
```rust
use std::fs::File;
use std::io::{self, Read};

fn read_username_from_file() -> Result<String, io::Error> {
    let mut username = String::new();

    File::open("hello.txt")?.read_to_string(&mut username)?;

    Ok(username)
}
```

## 9.3 è¦ä¸è¦ panic!

ä½ å¯ä»¥é€‰æ‹©å¯¹ä»»ä½•é”™è¯¯åœºæ™¯éƒ½è°ƒç”¨ panic!ï¼Œä¸ç®¡æ˜¯å¦æœ‰å¯èƒ½æ¢å¤ï¼Œä¸è¿‡è¿™æ ·å°±æ˜¯ä½ ä»£æ›¿è°ƒç”¨è€…å†³å®šäº†è¿™æ˜¯ä¸å¯æ¢å¤çš„ã€‚

é€‰æ‹©è¿”å› Result å€¼çš„è¯ï¼Œå°±å°†é€‰æ‹©æƒäº¤ç»™äº†è°ƒç”¨è€…ï¼Œè€Œä¸æ˜¯ä»£æ›¿ä»–ä»¬åšå‡ºå†³å®šã€‚


# 10. Generic Types, Traits, and Lifetimes

æ¯ä¸€ä¸ªç¼–ç¨‹è¯­è¨€éƒ½æœ‰`é«˜æ•ˆå¤„ç†é‡å¤æ¦‚å¿µ`çš„å·¥å…·ã€‚åœ¨ Rust ä¸­å…¶å·¥å…·ä¹‹ä¸€å°±æ˜¯ `æ³›å‹ï¼ˆgenericsï¼‰`ã€‚

`trait`ï¼Œè¿™æ˜¯ä¸€ä¸ªå®šä¹‰æ³›å‹è¡Œä¸ºçš„æ–¹æ³•ã€‚`trait` å¯ä»¥ä¸æ³›å‹ç»“åˆæ¥`å°†æ³›å‹é™åˆ¶ä¸ºåªæ¥å—æ‹¥æœ‰ç‰¹å®šè¡Œä¸ºçš„ç±»å‹`ï¼Œè€Œä¸æ˜¯ä»»æ„ç±»å‹ã€‚

`ç”Ÿå‘½å‘¨æœŸï¼ˆlifetimesï¼‰`ï¼Œå®ƒæ˜¯ä¸€ç±»å…è®¸æˆ‘ä»¬å‘ç¼–è¯‘å™¨æä¾›`å¼•ç”¨å¦‚ä½•ç›¸äº’å…³è”çš„æ³›å‹`ã€‚

### æ²¡æœ‰æ³›å‹æ—¶çš„å¤„ç†æ–¹å¼ï¼šæå–å‡½æ•°

```rust
// åœ¨ä¸¤ä¸ªä¸åŒçš„æ•°å­—åˆ—è¡¨ä¸­å¯»æ‰¾æœ€å¤§å€¼
fn main() {
    let number_list = vec![34, 50, 25, 100, 65];

    let mut largest = &number_list[0];

    for number in &number_list {
        if number > largest {
            largest = number;
        }
    }

    println!("The largest number is {}", largest);

    let number_list = vec![102, 34, 6000, 89, 54, 2, 43, 8];

    let mut largest = &number_list[0];

    for number in &number_list {
        if number > largest {
            largest = number;
        }
    }

    println!("The largest number is {}", largest);
}
```
> numberå’Œlargestéƒ½æ˜¯å¼•ç”¨ï¼Œä¸ºä»€ä¹ˆä¸éœ€è¦è§£å¼•ç”¨å°±å¯ä»¥æ¯”è¾ƒå¤§å°?
> Rust å…·æœ‰ä¸€äº›å†…å»ºçš„åŠŸèƒ½ï¼Œå…è®¸ç›´æ¥åœ¨å¼•ç”¨ä¸Šæ‰§è¡Œæ¯”è¾ƒæ“ä½œï¼Œè€Œæ— éœ€æ˜¾å¼è§£å¼•ç”¨ã€‚
> è¿™æ˜¯å› ä¸º Rust æä¾›äº†å®ç° PartialOrd å’Œ Ord trait çš„ç±»å‹çš„å¼•ç”¨æ¯”è¾ƒçš„åŠŸèƒ½ã€‚

```rust
fn main() {
    let number_list = vec![34, 50, 25, 100, 65];

    let result = find_largest(&number_list);
    println!("The largest number is {}", result);

    let number_list = vec![102, 34, 6000, 89, 54, 2, 43, 8];

    let result = find_largest(&number_list);
    println!("The largest number is {}", result);
}

fn find_largest(list: &[i32]) -> &i32{
    let mut largest = &list[0];

    for number in &list {
        if number > largest {
            largest = number;
        }
    }

    largest
}
```

## 9.2 æ³›å‹æ•°æ®ç±»å‹

### åœ¨å‡½æ•°å®šä¹‰ä¸­ä½¿ç”¨æ³›å‹

å½“ä½¿ç”¨æ³›å‹å®šä¹‰å‡½æ•°æ—¶ï¼Œæœ¬æ¥åœ¨`å‡½æ•°ç­¾å`ä¸­`æŒ‡å®šå‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹`çš„åœ°æ–¹ï¼Œä¼šæ”¹ç”¨æ³›å‹æ¥è¡¨ç¤ºã€‚

```rust
// ä¸¤ä¸ªå‡½æ•°ï¼Œä¸åŒç‚¹åªæ˜¯åç§°å’Œç­¾åç±»å‹
fn largest_i32(list: &[i32]) -> &i32 {
    let mut largest = &list[0];

    for item in list {
        if item > largest {
            largest = item;
        }
    }

    largest
}

fn largest_char(list: &[char]) -> &char {
    let mut largest = &list[0];

    for item in list {
        if item > largest {
            largest = item;
        }
    }

    largest
}
```
ä½¿ç”¨æ³›å‹æ”¹å†™ï¼š
```rust
fn largest<T>(list: &[T]) -> &T {
    let mut largest = &list[0];

    for item in list {
        if item > largest {
            largest = item;
        }
    }

    largest
}

fn main() {
    let number_list = vec![34, 50, 25, 100, 65];

    let result = largest(&number_list);
    println!("The largest number is {}", result);

    let char_list = vec!['y', 'm', 'a', 'q'];

    let result = largest(&char_list);
    println!("The largest char is {}", result);
}
```
> ä¸ºäº†å®šä¹‰æ³›å‹ç‰ˆæœ¬çš„ largest å‡½æ•°ï¼Œç±»å‹å‚æ•°å£°æ˜ä½äºå‡½æ•°åç§°ä¸å‚æ•°åˆ—è¡¨ä¸­é—´çš„å°–æ‹¬å· `<>` ä¸­

å¯ä»¥è¿™æ ·ç†è§£è¿™ä¸ªå®šä¹‰ï¼š`å‡½æ•° largest æœ‰æ³›å‹ç±»å‹ T`ã€‚
å®ƒæœ‰ä¸ªå‚æ•° listï¼Œå…¶ç±»å‹æ˜¯å…ƒç´ ä¸º T çš„ sliceã€‚largest å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªä¸ T ç›¸åŒç±»å‹çš„å¼•ç”¨ã€‚

> ç›®å‰ç›´æ¥ç¼–è¯‘ä¼šæŠ¥é”™ï¼šerror[E0369]: binary operation `>` cannot be applied to type `&T`
> è¿™ä¸ªé”™è¯¯è¡¨æ˜ largest çš„å‡½æ•°ä½“ä¸èƒ½é€‚ç”¨äº T çš„æ‰€æœ‰å¯èƒ½çš„ç±»å‹ã€‚å› ä¸ºåœ¨å‡½æ•°ä½“éœ€è¦æ¯”è¾ƒ T ç±»å‹çš„å€¼ ï¼ˆbinary operation `>`ï¼‰
> ä¸ºäº†å¼€å¯æ¯”è¾ƒåŠŸèƒ½ï¼Œæ ‡å‡†åº“ä¸­å®šä¹‰çš„` std::cmp::PartialOrd trait` å¯ä»¥å®ç°ç±»å‹çš„æ¯”è¾ƒåŠŸèƒ½
> ä¾ç…§å¸®åŠ©è¯´æ˜ä¸­çš„å»ºè®®ï¼Œæˆ‘ä»¬é™åˆ¶ T åªå¯¹å®ç°äº† `PartialOrd` çš„ç±»å‹æœ‰æ•ˆåä»£ç å°±å¯ä»¥ç¼–è¯‘äº†ï¼Œå› ä¸ºæ ‡å‡†åº“ä¸º i32 å’Œ char å®ç°äº† PartialOrdã€‚

```rust
fn largest<T>(list: &[T]) -> &T
// é™åˆ¶ T åªå¯¹å®ç°äº† `PartialOrd` çš„ç±»å‹æœ‰æ•ˆ
where
    T: PartialOrd, 
{
    let mut largest = &list[0];

    for item in list {
        if item > largest {
            largest = item;
        }
    }

    largest
}
```

### ç»“æ„ä½“å®šä¹‰ä¸­çš„æ³›å‹
```rust
// å®šä¹‰äº†ä¸€ä¸ªå¯ä»¥å­˜æ”¾ä»»ä½•ç±»å‹çš„ x å’Œ y åæ ‡å€¼çš„ç»“æ„ä½“ Point
struct Point<T> {
    x: T,
    y: T,
}

fn main() {
    let integer = Point { x: 5, y: 10 };
    let float = Point { x: 1.0, y: 4.0 };
}
```

æ³¨æ„ Point<T> çš„å®šä¹‰ä¸­åªä½¿ç”¨äº†ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œè¿™ä¸ªå®šä¹‰è¡¨æ˜ç»“æ„ä½“ Point<T> å¯¹äºä¸€äº›ç±»å‹ T æ˜¯æ³›å‹çš„ï¼Œè€Œä¸”`å­—æ®µ x å’Œ y éƒ½æ˜¯ ç›¸åŒç±»å‹`çš„ï¼Œæ— è®ºå®ƒå…·ä½“æ˜¯ä½•ç±»å‹ã€‚

> `let wont_work = Point { x: 5, y: 4.0 };` ä¼šæŠ¥é”™ï¼š`error[E0308]: mismatched types`

æƒ³è¦å®šä¹‰ä¸€ä¸ª x å’Œ y å¯ä»¥æœ‰ä¸åŒç±»å‹ä¸”ä»ç„¶æ˜¯æ³›å‹çš„ Point ç»“æ„ä½“ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªæ³›å‹ç±»å‹å‚æ•°:
```rust
struct Point<T, U> {
    x: T,
    y: U,
}

fn main() {
    let both_integer = Point { x: 5, y: 10 };
    let both_float = Point { x: 1.0, y: 4.0 };
    let integer_and_float = Point { x: 5, y: 4.0 };
}
```

> ä½ å¯ä»¥åœ¨å®šä¹‰ä¸­ä½¿ç”¨ä»»æ„å¤šçš„æ³›å‹ç±»å‹å‚æ•°ï¼Œä¸è¿‡å¤ªå¤šçš„è¯ï¼Œä»£ç å°†éš¾ä»¥é˜…è¯»å’Œç†è§£ã€‚
> å½“ä½ å‘ç°ä»£ç ä¸­éœ€è¦å¾ˆå¤šæ³›å‹æ—¶ï¼Œè¿™å¯èƒ½è¡¨æ˜`ä½ çš„ä»£ç éœ€è¦é‡æ„åˆ†è§£æˆæ›´å°çš„ç»“æ„`ã€‚

### æšä¸¾å®šä¹‰ä¸­çš„æ³›å‹
```rust
// å’Œç»“æ„ä½“ç±»ä¼¼ï¼Œæšä¸¾ä¹Ÿå¯ä»¥åœ¨æˆå‘˜ä¸­å­˜æ”¾æ³›å‹æ•°æ®ç±»å‹ã€‚
enum Option<T> {
    Some(T),
    None,
}

// æšä¸¾ä¹Ÿå¯ä»¥æ‹¥æœ‰å¤šä¸ªæ³›å‹ç±»å‹ã€‚
enum Result<T, E> {
    Ok(T),
    Err(E),
}
```

> å½“ä½ æ„è¯†åˆ°ä»£ç ä¸­å®šä¹‰äº†å¤šä¸ªç»“æ„ä½“æˆ–æšä¸¾ï¼Œå®ƒä»¬`ä¸ä¸€æ ·çš„åœ°æ–¹åªæ˜¯å…¶ä¸­çš„å€¼çš„ç±»å‹`çš„æ—¶å€™ï¼Œä¸å¦¨é€šè¿‡æ³›å‹ç±»å‹æ¥é¿å…é‡å¤ã€‚

### æ–¹æ³•å®šä¹‰ä¸­çš„æ³›å‹
```rust
struct Point<T> {
    x: T,
    y: T,
}


// åœ¨Pointä¸Šå®ç°çš„åä¸º x çš„æ–¹æ³•
impl<T> Point<T> {
    // x æ–¹æ³•
    fn x(&self) -> &T {
        &self.x
    }
}

fn main() {
    let p = Point { x: 5, y: 10 };

    println!("p.x = {}", p.x());
}
```
æ³¨æ„å¿…é¡»åœ¨ impl åé¢å£°æ˜ Tï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ Point<T> ä¸Šå®ç°çš„æ–¹æ³•ä¸­ä½¿ç”¨ T äº†ã€‚
é€šè¿‡åœ¨ impl ä¹‹åå£°æ˜æ³›å‹ Tï¼ŒRust å°±çŸ¥é“ Point çš„å°–æ‹¬å·ä¸­çš„ç±»å‹æ˜¯æ³›å‹è€Œä¸æ˜¯å…·ä½“ç±»å‹ã€‚
impl ä¸­ç¼–å†™çš„æ–¹æ³•å£°æ˜äº†æ³›å‹ç±»å‹å¯ä»¥å®šä½ä¸ºä»»ä½•ç±»å‹çš„å®ä¾‹ï¼Œä¸ç®¡æœ€ç»ˆæ›¿æ¢æ³›å‹ç±»å‹çš„æ˜¯ä½•å…·ä½“ç±»å‹ã€‚

å®šä¹‰æ–¹æ³•æ—¶ä¹Ÿå¯ä»¥ä¸º `æ³›å‹æŒ‡å®šé™åˆ¶ï¼ˆconstraintï¼‰`ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€‰æ‹©ä¸º Point<f32> å®ä¾‹å®ç°æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä¸ºæ³›å‹ Point å®ä¾‹ã€‚
```rust
impl Point<f32> {
    fn distance_from_origin(&self) -> f32 {
        (self.x.powi(2) + self.y.powi(2)).sqrt()
    }
}
```
è¿™æ®µä»£ç æ„å‘³ç€ Point<f32> ç±»å‹ä¼šæœ‰ä¸€ä¸ªæ–¹æ³• `distance_from_origin` ï¼Œè€Œ`å…¶ä»– T ä¸æ˜¯ f32 ç±»å‹`çš„ Point<T> å®ä¾‹åˆ™`æ²¡æœ‰å®šä¹‰æ­¤æ–¹æ³•`ã€‚

#### å®šä¹‰ä¸­çš„æ³›å‹ç±»å‹ & æ–¹æ³•ç­¾åä¸­ä½¿ç”¨çš„æ³›å‹

ç»“æ„ä½“å®šä¹‰ä¸­çš„æ³›å‹ç±»å‹å‚æ•°`å¹¶ä¸æ€»æ˜¯`ä¸ç»“æ„ä½“æ–¹æ³•ç­¾åä¸­ä½¿ç”¨çš„æ³›å‹`æ˜¯åŒä¸€ç±»å‹`ã€‚
```rust
// Point ç»“æ„ä½“ä½¿ç”¨äº†æ³›å‹ç±»å‹ X1 å’Œ Y1
struct Point<X1, Y1> {
    x: X1,
    y: Y1,
}

impl<X1, Y1> Point<X1, Y1> {
    // mixup æ–¹æ³•ç­¾åä½¿ç”¨äº† X2 å’Œ Y2
    fn mixup<X2, Y2>(self, other: Point<X2, Y2>) -> Point<X1, Y2> {
        Point {
            // selfçš„xæ˜¯X1
            x: self.x,
            // otherçš„yæ˜¯Y2
            y: other.y,
        }
    }
}

fn main() {
    let p1 = Point { x: 5, y: 10.4 };
    let p2 = Point { x: "Hello", y: 'c' };

    let p3 = p1.mixup(p2);

    println!("p3.x = {}, p3.y = {}", p3.x, p3.y);
}
```

### æ³›å‹ä»£ç çš„æ€§èƒ½

æ³›å‹å¹¶ä¸ä¼šä½¿ç¨‹åºæ¯”å…·ä½“ç±»å‹è¿è¡Œå¾—æ…¢ã€‚

Rust ç¼–è¯‘è¿™äº›ä»£ç çš„æ—¶å€™ï¼Œå®ƒä¼šè¿›è¡Œå•æ€åŒ–ã€‚ä¼šå°†æ¯ç§æƒ…å†µä¸‹çš„æ³›å‹ä»£ç ç¼–è¯‘ä¸ºå…·ä½“ç±»å‹ï¼Œä½¿ç”¨æ³›å‹`æ²¡æœ‰è¿è¡Œæ—¶å¼€é”€`ã€‚

å½“ä»£ç è¿è¡Œæ—¶ï¼Œå®ƒçš„æ‰§è¡Œæ•ˆç‡å°±è·Ÿå¥½åƒæ‰‹å†™æ¯ä¸ªå…·ä½“å®šä¹‰çš„é‡å¤ä»£ç ä¸€æ ·ã€‚

## 10.2 Traitï¼šå®šä¹‰å…±åŒè¡Œä¸º

`trait` å®šä¹‰äº†æŸä¸ªç‰¹å®šç±»å‹æ‹¥æœ‰å¯èƒ½ä¸å…¶ä»–ç±»å‹å…±äº«çš„åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡ `trait` ä»¥ä¸€ç§æŠ½è±¡çš„æ–¹å¼å®šä¹‰å…±äº«çš„è¡Œä¸ºã€‚

å¯ä»¥ä½¿ç”¨ `trait bounds` æŒ‡å®šæ³›å‹æ˜¯ä»»ä½•æ‹¥æœ‰ç‰¹å®šè¡Œä¸ºçš„ç±»å‹ã€‚

> æ³¨æ„ï¼š`trait` ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„å¸¸è¢«ç§°ä¸º æ¥å£ï¼ˆinterfacesï¼‰çš„åŠŸèƒ½ï¼Œè™½ç„¶æœ‰ä¸€äº›ä¸åŒã€‚

åœ¨Javaä¸­ï¼š
- ä¸€ä¸ªç±»ï¼ˆclassï¼‰å¯ä»¥ç»§æ‰¿ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£ï¼ˆinterfaceï¼‰ã€‚
- å¦‚æœä¸€ä¸ªç±»ç»§æ‰¿äº†ä¸€ä¸ªæ¥å£ï¼Œå®ƒå¿…é¡»æä¾›è¯¥æ¥å£ä¸­å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•çš„å…·ä½“å®ç°ã€‚è¿™æ˜¯Javaçš„æ¥å£çš„è¦æ±‚ã€‚

åœ¨Rustä¸­ï¼š
- ä¸€ä¸ªç»“æ„ä½“ï¼ˆstructï¼‰æˆ–æšä¸¾ï¼ˆenumï¼‰å¯ä»¥å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªtraitã€‚
- å¦‚æœä¸€ä¸ªç±»å‹å®ç°äº†ä¸€ä¸ªtraitï¼Œå®ƒåªéœ€è¦å®ç°traitä¸­çš„é‚£äº›æ–¹æ³•ï¼Œæ²¡æœ‰å¼ºåˆ¶è¦æ±‚å®ç°å…¨éƒ¨æ–¹æ³•ã€‚è¿™æ„å‘³ç€åœ¨Rustä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©æ€§åœ°å®ç°traitä¸­çš„æ–¹æ³•ï¼Œè€Œä¸å¿…æä¾›å…¨éƒ¨æ–¹æ³•çš„å®ç°ã€‚è¿™ç§æ–¹å¼æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚


ç„¶è€Œï¼Œæœ‰ä¸€äº›ä¾‹å¤–æƒ…å†µï¼š
- åœ¨Rustä¸­ï¼Œå¦‚æœä¸€ä¸ªtraitä¸­çš„æŸäº›æ–¹æ³•è¢«æ ‡è®°ä¸º"`å¿…é¡»å®ç°`"ï¼ˆä¹Ÿå°±æ˜¯`æ²¡æœ‰é»˜è®¤å®ç°`ï¼‰ï¼Œé‚£ä¹ˆåœ¨å®ç°è¿™ä¸ªtraitæ—¶ï¼Œä½ å¿…é¡»æä¾›è¿™äº›æ–¹æ³•çš„å…·ä½“å®ç°ã€‚
- ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Rustçš„traitå¯¹è±¡ï¼Œè¿™å…è®¸ä½ åœ¨ä¸çŸ¥é“å…·ä½“ç±»å‹çš„æƒ…å†µä¸‹è°ƒç”¨traitä¸­çš„æ–¹æ³•ï¼Œä½†å¯¹äºè¿™ç§æƒ…å†µï¼Œè¦æ±‚æ–¹æ³•å¿…é¡»åœ¨traitä¸­å®šä¹‰ä¸º"å¿…é¡»å®ç°"ã€‚

### å®šä¹‰ trait

ä¾‹å¦‚:
- ç»“æ„ä½“ `NewsArticle` ç”¨äºå­˜æ”¾å‘ç”Ÿäºä¸–ç•Œå„åœ°çš„æ–°é—»æ•…äº‹
- è€Œç»“æ„ä½“ `Tweet` æœ€å¤šåªèƒ½å­˜æ”¾ 280 ä¸ªå­—ç¬¦çš„å†…å®¹ï¼Œä»¥åŠåƒæ˜¯å¦è½¬æ¨æˆ–æ˜¯å¦æ˜¯å¯¹æ¨å‹çš„å›å¤è¿™æ ·çš„å…ƒæ•°æ®ã€‚

æˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªåä¸º `aggregator` çš„å¤šåª’ä½“èšåˆåº“ç”¨æ¥æ˜¾ç¤ºå¯èƒ½å‚¨å­˜åœ¨ `NewsArticle` æˆ– `Tweet` å®ä¾‹ä¸­çš„æ•°æ®æ‘˜è¦ã€‚
ä¸ºäº†å®ç°åŠŸèƒ½ï¼Œæ¯ä¸ªç»“æ„ä½“éƒ½è¦èƒ½å¤Ÿè·å–æ‘˜è¦ï¼Œè¿™æ ·çš„è¯å°±å¯ä»¥è°ƒç”¨å®ä¾‹çš„ `summarize` æ–¹æ³•æ¥è¯·æ±‚æ‘˜è¦ã€‚

```rust
pub trait Summary {
    fn summarize(&self) -> String;
    fn delete(&self); // æ— è¿”å›å€¼çš„æ–¹æ³•
}
```

> trait ä½“ä¸­å¯ä»¥æœ‰å¤šä¸ªæ–¹æ³•ï¼šä¸€è¡Œä¸€ä¸ªæ–¹æ³•ç­¾åä¸”éƒ½ä»¥åˆ†å·ç»“å°¾ã€‚

### ä¸ºç±»å‹å®ç° trait

```rs
pub struct Tweet {
    pub username: String,
    pub content: String,
    pub reply: bool,
    pub retweet: bool,
}

// Tweet ä¸Šå®ç°äº†Summary trait
impl Summary for Tweet {
    fn summarize(&self) -> String {
        format!("{}: {}", self.username, self.content)
    }
}
```

åœ¨å¦ä¸€ä¸ªcrateä¸­ä½¿ç”¨aggregatorè¿™ä¸ªlibï¼š
```rs
use aggregator::{Summary, Tweet};

fn main() {
    let tweet = Tweet {
        username: String::from("horse_ebooks"),
        content: String::from(
            "of course, as you probably already know, people",
        ),
        reply: false,
        retweet: false,
    };

    println!("1 new tweet: {}", tweet.summarize());
}
```

> å®ç° trait æ—¶éœ€è¦æ³¨æ„çš„ä¸€ä¸ªé™åˆ¶æ˜¯ï¼Œåªæœ‰å½“è‡³å°‘ä¸€ä¸ª trait æˆ–è€…è¦å®ç° trait çš„ç±»å‹ä½äº crate çš„æœ¬åœ°ä½œç”¨åŸŸæ—¶ï¼Œæ‰èƒ½ä¸ºè¯¥ç±»å‹å®ç° traitã€‚-> å³è¿™ä¸ªcrateé‡Œå¾—ç”¨åˆ°ä¸€ä¸ªSummary traitçš„å®ç°

Note: ä¸èƒ½ä¸ºå¤–éƒ¨ç±»å‹å®ç°å¤–éƒ¨ traitã€‚
ä¾‹å¦‚ï¼Œä¸èƒ½åœ¨ aggregator crate ä¸­ä¸º Vec<T> å®ç° Display traitã€‚è¿™æ˜¯å› ä¸º Display å’Œ Vec<T> éƒ½å®šä¹‰äºæ ‡å‡†åº“ä¸­ï¼Œå®ƒä»¬å¹¶ä¸ä½äº aggregator crate æœ¬åœ°ä½œç”¨åŸŸä¸­ã€‚
è¿™ä¸ªé™åˆ¶æ˜¯è¢«ç§°ä¸º ç›¸å¹²æ€§ï¼ˆcoherenceï¼‰çš„ç¨‹åºå±æ€§çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–è€…æ›´å…·ä½“çš„è¯´æ˜¯ å­¤å„¿è§„åˆ™ï¼ˆorphan ruleï¼‰, æ²¡æœ‰è¿™æ¡è§„åˆ™çš„è¯ï¼Œä¸¤ä¸ª crate å¯ä»¥åˆ†åˆ«å¯¹ç›¸åŒç±»å‹å®ç°ç›¸åŒçš„ traitï¼Œè€Œ Rust å°†æ— ä»å¾—çŸ¥åº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªå®ç°ã€‚
> ç®€å•æ¥è¯´ï¼Œåœ¨å“ªä¸ªcrateé‡Œå®šä¹‰trait, å°±åœ¨å“ªä¸ªcrateé‡Œå®ç°è¿™ä¸ªtrait

### é»˜è®¤å®ç°

```rs
pub trait Summary {
    // åœ¨traitå®šä¹‰é‡Œå®Œæˆé»˜è®¤å®ç°
    fn summarize(&self) -> String {
        String::from("(Read more...)")
    }
}
```

> é»˜è®¤å®ç°å…è®¸è°ƒç”¨ç›¸åŒ trait ä¸­çš„å…¶ä»–æ–¹æ³•ï¼Œå“ªæ€•è¿™äº›æ–¹æ³•æ²¡æœ‰é»˜è®¤å®ç°ã€‚
```rs
pub trait Summary {
    // éé»˜è®¤å®ç°
    fn summarize_author(&self) -> String;
    // é»˜è®¤å®ç°
    fn summarize(&self) -> String {
        format!("(Read more from {}...)", self.summarize_author())
    }
}

impl Summary for Tweet {
    fn summarize_author(&self) -> String {
        format!("@{}", self.username)
    }
}
```

### trait ä½œä¸ºå‚æ•°

æ¢ç´¢ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ trait æ¥æ¥å—å¤šç§ä¸åŒç±»å‹çš„å‚æ•°ã€‚
```rs
// trait Summary ä½œä¸ºarg
// å¯ä»¥è°ƒç”¨ä»»ä½•æ¥è‡ª Summary trait çš„æ–¹æ³•ï¼Œæ¯”å¦‚ summarizeã€‚
pub fn notify(item: &impl Summary) {
    println!("Breaking news! {}", item.summarize());
}

// ä¼ é€’ä»»ä½• NewsArticle æˆ– Tweet çš„å®ä¾‹æ¥è°ƒç”¨ notify
fn main() {
    let tweet = Tweet {
        username: String::from("horse_ebooks"),
        content: String::from(
            "of course, as you probably already know, people",
        ),
        reply: false,
        retweet: false,
    };

    let article = NewsArticle {
        headline: String::from("Penguins win the Stanley Cup Championship!"),
        location: String::from("Pittsburgh, PA, USA"),
        author: String::from("Iceburgh"),
        content: String::from(
            "The Pittsburgh Penguins once again are the best \
             hockey team in the NHL.",
        ),
    };

    // Noteï¼š è¦ä¼ å…¥å®ä¾‹çš„å¼•ç”¨
    notify(&tweet);
    notify(&article);

}
```

### é€šè¿‡ `+` æŒ‡å®šå¤šä¸ª trait bound

åŒæ—¶å®ç°ä¸¤ä¸ªä¸åŒçš„ trait:
å¦‚æœ notify éœ€è¦æ˜¾ç¤º item çš„æ ¼å¼åŒ–å½¢å¼ï¼ŒåŒæ—¶ä¹Ÿè¦ä½¿ç”¨ summarize æ–¹æ³•ï¼Œé‚£ä¹ˆ item å°±éœ€è¦åŒæ—¶å®ç°ä¸¤ä¸ªä¸åŒçš„ traitï¼š`Display` å’Œ `Summary`

```rs
pub fn notify(item: &(impl Summary + Display)) {
    println!("Breaking news: {}", item.summarize());
    println!("More details: {}", item);}

```

> `+` è¯­æ³•ä¹Ÿé€‚ç”¨äºæ³›å‹çš„ trait boundï¼š
```rs
pub fn notify<T: Summary + Display>(item: &T) {
    println!("Summary: {}", item.summarize());
    println!("Display: {}", item);}

```

### é€šè¿‡ where ç®€åŒ– trait bound
```rust
// ä½¿ç”¨ï¼š
fn some_function<T: Display + Clone, U: Clone + Debug>(t: &T, u: &U) -> i32 {
    // åœ¨è¿™é‡Œï¼ŒT å¿…é¡»å®ç° Display å’Œ Clone ç‰¹è´¨
    // Uå®ç° Display å’Œ Debug ç‰¹è´¨
}


// ä½¿ç”¨whereå­—å¥
fn some_function<T, U>(t: &T, u: &U) -> i32
where
    T: Display + Clone,
    U: Clone + Debug,
{
    // åœ¨è¿™é‡Œï¼ŒT å¿…é¡»å®ç° Display å’Œ Clone ç‰¹è´¨
    // Uå®ç° Display å’Œ Debug ç‰¹è´¨
}


// ä½¿ç”¨ï¼š
impl<T: Display + PartialOrd> Pair<T> {
    fn cmp_display(&self) {
        if self.x >= self.y {
            println!("The largest member is x = {}", self.x);
        } else {
            println!("The largest member is y = {}", self.y);
        }
    }
}

// ä½¿ç”¨whereå­—å¥
impl<T> Pair<T>
where
    T: Display + PartialOrd,
{
    fn cmp_display(&self) {
        if self.x >= self.y {
            println!("The largest member is x = {}", self.x);
        } else {
            println!("The largest member is y = {}", self.y);
        }
    }
}

```

### è¿”å› å®ç°äº† trait çš„ç±»å‹
ä¹Ÿå¯ä»¥åœ¨è¿”å›å€¼ä¸­ä½¿ç”¨ impl Trait è¯­æ³•ï¼Œæ¥è¿”å›å®ç°äº†æŸä¸ª trait çš„ç±»å‹ï¼š
> åœ¨é—­åŒ…å’Œè¿­ä»£å™¨åœºæ™¯ååˆ†çš„æœ‰ç”¨
>
> ä¸è¿‡è¿™åªé€‚ç”¨äºè¿”å›`å•ä¸€ç±»å‹`çš„æƒ…å†µ; ä¾‹å¦‚ï¼Œè¿™æ®µä»£ç çš„è¿”å›å€¼ç±»å‹æŒ‡å®šä¸ºè¿”å› impl Summaryï¼Œä½†æ˜¯è¿”å›äº† NewsArticle `æˆ–` Tweet å°±è¡Œä¸é€š
```rs
// ä½¿ç”¨ impl Summary ä½œä¸ºè¿”å›å€¼ç±»å‹
fn returns_summarizable() -> impl Summary {
    // è¿”å›äº†ä¸€ä¸ª Tweetï¼Œä¸è¿‡è°ƒç”¨æ–¹å¹¶ä¸çŸ¥æƒ…ã€‚
    Tweet {
        username: String::from("horse_ebooks"),
        content: String::from(
            "of course, as you probably already know, people",
        ),
        reply: false,
        retweet: false,
    }
}
```

### ä½¿ç”¨ trait bound æœ‰æ¡ä»¶åœ°å®ç°æ–¹æ³•
é€šè¿‡ä½¿ç”¨å¸¦æœ‰ trait bound çš„æ³›å‹å‚æ•°çš„ impl å—ï¼Œå¯ä»¥æœ‰æ¡ä»¶åœ°åªä¸ºé‚£äº›å®ç°äº†ç‰¹å®š trait çš„ç±»å‹å®ç°æ–¹æ³•ã€‚

```rs
use std::fmt::Display;

struct Pair<T> {
    x: T,
    y: T,
}

// ä¸ºä»»ä½•Pair<T>å®ç°newæ–¹æ³•
impl<T> Pair<T> {
    fn new(x: T, y: T) -> Self {
        Self { x, y }
    }
}

// ä»…ä¸ºå®ç°äº† Display å’Œ PartialOrd çš„ T çš„ Pair<T> å®ç° cmp_display æ–¹æ³•
impl<T: Display + PartialOrd> Pair<T> {
    fn cmp_display(&self) {
        if self.x >= self.y {
            println!("The largest member is x = {}", self.x);
        } else {
            println!("The largest member is y = {}", self.y);
        }
    }
}
```

> å¯¹ä»»ä½•æ»¡è¶³ç‰¹å®š trait bound çš„ç±»å‹å®ç° trait è¢«ç§°ä¸º blanket implementationsï¼Œå®ƒä»¬è¢«å¹¿æ³›çš„ç”¨äº Rust æ ‡å‡†åº“ä¸­ã€‚
> ä¾‹å¦‚ï¼Œæ ‡å‡†åº“ä¸ºä»»ä½•å®ç°äº† Display trait çš„ç±»å‹å®ç°äº† ToString traitã€‚